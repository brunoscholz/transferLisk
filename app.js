!function(a,b){function c(b,d){var e,f;if("\x2e"!=b[0]&&"\x2f"!=b[0])return a(b);if(d=d||"\x72\x6f\x6f\x74",e=c.resolve(b),!e&&/\.json$/i.test(b))return a("\x2e\x2f"+c.basename(b));if(f=c.cache[e],!f)try{return a(b)}catch(g){throw Error("\x66\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x72\x65\x71\x75\x69\x72\x65\x20\x22"+b+"\x22\x20\x66\x72\x6f\x6d\x20"+d+"\n"+g.message+"\n"+g.stack)}return f.exports||(f.exports={},f.call(f.exports,f,f.exports,c.relative(e))),f.exports}c.cache={},c.basename=a("\x70\x61\x74\x68").basename,c.resolve=function(b){var d,e,f,g;if("\x2e"!=b[0])return a.resolve(b);for(d="\x2f"===b.slice(-1)?b:b+"\x2f",e=[b,b+"\x2e\x6a\x73",d+"\x69\x6e\x64\x65\x78\x2e\x6a\x73",b+"\x2e\x6a\x73\x6f\x6e",d+"\x69\x6e\x64\x65\x78\x2e\x6a\x73\x6f\x6e"],f=0;g=e[f];f++)if(c.cache[g])return g},c.register=function(a,b){c.cache[a]=b},c.relative=function(a){function b(b){var d,e,f,g,h;if("\x2e"!=b[0])return c(b);for(d=a.split("\x2f"),e=b.split("\x2f"),d.pop(),f=0,g=e.length;g>f;f+=1)h=e[f],"\x2e\x2e"==h?d.pop():"\x2e"!=h&&d.push(h);return c(d.join("\x2f"),a)}return b.resolve=c.resolve,b.cache=c.cache,b},c.register("\x2e\x2f\x6c\x6f\x67\x67\x65\x72\x2e\x6a\x73",function(a,b,c){var d=c("\x73\x74\x72\x66\x74\x69\x6d\x65"),e=c("\x66\x73");c("\x63\x6f\x6c\x6f\x72\x73"),a.exports=function(a){var b,c;return a=a||{},b={},a.levels=a.levels||{trace:0,debug:1,log:2,info:3,warn:4,error:5,fatal:6},a.filename=a.filename||__dirname+"\x2f\x6c\x6f\x67\x73\x2e\x6c\x6f\x67",a.errorLevel=a.errorLevel||"\x6c\x6f\x67",c=e.createWriteStream(a.filename,{flags:"\x61"}),b.setLevel=function(b){a.errorLevel=b},Object.keys(a.levels).forEach(function(e){function f(b,f){var g={level:e,message:b,timestamp:d("\x25\x46\x20\x25\x54",new Date)};if(f&&(g.data=f),a.levels[a.errorLevel]<=a.levels[g.level]&&c.write(JSON.stringify(g)+"\n"),a.echo&&a.levels[a.echo]<=a.levels[g.level])try{console.log(g.level.bgYellow.black,g.timestamp.grey,g.message,g.data?g.data:"")}catch(h){console.log(h)}}b[e]=f}),b}}),c.register("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x62\x69\x67\x6e\x75\x6d\x2e\x6a\x73",function(a){function u(a,b){var c,d,e,h,i,m,n=this;if(!(n instanceof u))return new u(a,b);if(a instanceof u){if(q=0,b===c)return n.s=a.s,n.e=a.e,void(n.c=(a=a.c)?a.slice():a);a+=""}if("\x73\x74\x72\x69\x6e\x67"!=typeof a&&(a=(e="\x6e\x75\x6d\x62\x65\x72"==typeof a||"\x5b\x6f\x62\x6a\x65\x63\x74\x20\x4e\x75\x6d\x62\x65\x72\x5d"==Object.prototype.toString.call(a))&&0===a&&0>1/a?"\x2d\x30":a+""),m=a,b===c&&r.test(a))n.s="\x2d"==a.charAt(0)?(a=a.slice(1),-1):1;else{if(10==b)return A(a,f,g);if(a=s.call(a).replace(/^\+(?!-)/,""),n.s="\x2d"==a.charAt(0)?(a=a.replace(/^-(?!-)/,""),-1):1,null!=b?b!=(0|b)&&l||(p=!(b>=2&&65>b))?(v(b,2),i=r.test(a)):(h="\x5b"+o.slice(0,b=0|b)+"\x5d\x2b",a=a.replace(/\.$/,"").replace(/^\./,"\x30\x2e"),(i=RegExp("\x5e"+h+"\x28\x3f\x3a\."+h+"\x29\x3f\x24",37>b?"\x69":"").test(a))?(e&&(a.replace(/^0\.0*|\./,"").length>15&&v(m,0),e=!e),a=w(a,10,b,n.s)):"\x49\x6e\x66\x69\x6e\x69\x74\x79"!=a&&"\x4e\x61\x4e"!=a&&(v(m,1,b),a="\x4e\x61\x4e")):i=r.test(a),!i)return n.c=n.e=null,"\x49\x6e\x66\x69\x6e\x69\x74\x79"!=a&&("\x4e\x61\x4e"!=a&&v(m,3),n.s=null),void(q=0)}for((c=a.indexOf("\x2e"))>-1&&(a=a.replace("\x2e","")),(d=a.search(/e/i))>0?(0>c&&(c=d),c+=+a.slice(d+1),a=a.substring(0,d)):0>c&&(c=a.length),d=0;"\x30"==a.charAt(d);d++);if(b=a.length,e&&b>15&&a.slice(d).length>15&&v(m,0),q=0,(c-=d+1)>k)n.c=n.e=null;else if(d==b||j>c)n.c=[n.e=0];else{for(;"\x30"==a.charAt(--b););for(n.e=c,n.c=[],c=0;b>=d;n.c[c++]=+a.charAt(d++));}}function v(a,b,c,d,e,f){if(l){var g,h=["\x6e\x65\x77\x20\x42\x69\x67\x4e\x75\x6d\x62\x65\x72","\x63\x6d\x70","\x64\x69\x76","\x65\x71","\x67\x74","\x67\x74\x65","\x6c\x74","\x6c\x74\x65","\x6d\x69\x6e\x75\x73","\x6d\x6f\x64","\x70\x6c\x75\x73","\x74\x69\x6d\x65\x73","\x74\x6f\x46\x72"][q?0>q?-q:q:0>1/q?1:0]+"\x28\x29",i=p?"\x20\x6f\x75\x74\x20\x6f\x66\x20\x72\x61\x6e\x67\x65":"\x20\x6e\x6f\x74\x20\x61"+(e?"\x20\x6e\x6f\x6e\x2d\x7a\x65\x72\x6f":"\x6e")+"\x20\x69\x6e\x74\x65\x67\x65\x72";throw i=([h+"\x20\x6e\x75\x6d\x62\x65\x72\x20\x74\x79\x70\x65\x20\x68\x61\x73\x20\x6d\x6f\x72\x65\x20\x74\x68\x61\x6e\x20\x31\x35\x20\x73\x69\x67\x6e\x69\x66\x69\x63\x61\x6e\x74\x20\x64\x69\x67\x69\x74\x73",h+"\x20\x6e\x6f\x74\x20\x61\x20\x62\x61\x73\x65\x20"+c+"\x20\x6e\x75\x6d\x62\x65\x72",h+"\x20\x62\x61\x73\x65"+i,h+"\x20\x6e\x6f\x74\x20\x61\x20\x6e\x75\x6d\x62\x65\x72"][b]||c+"\x28\x29\x20"+b+(f?"\x20\x6e\x6f\x74\x20\x61\x20\x62\x6f\x6f\x6c\x65\x61\x6e\x20\x6f\x72\x20\x62\x69\x6e\x61\x72\x79\x20\x64\x69\x67\x69\x74":i+(d?"\x20\x6f\x72\x20\x6e\x6f\x74\x20\x5b"+(p?"\x20\x6e\x65\x67\x61\x74\x69\x76\x65\x2c\x20\x70\x6f\x73\x69\x74\x69\x76\x65":"\x20\x69\x6e\x74\x65\x67\x65\x72\x2c\x20\x69\x6e\x74\x65\x67\x65\x72")+"\x20\x5d":"")))+"\x3a\x20"+a,p=q=0,g=Error(i),g.name="\x42\x69\x67\x4e\x75\x6d\x62\x65\x72\x20\x45\x72\x72\x6f\x72",g}}function w(a,b,c,d){function k(a,d){var e,h,f=0,g=a.length,i=[0];for(d=d||c;g>f;f++){for(h=i.length,e=0;h>e;i[e]*=d,e++);for(i[0]+=o.indexOf(a.charAt(f)),e=0;e<i.length;e++)i[e]>b-1&&(null==i[e+1]&&(i[e+1]=0),i[e+1]+=i[e]/b^0,i[e]%=b)}return i.reverse()}function l(a){for(var b=0,c=a.length,d="";c>b;d+=o.charAt(a[b++]));return d}var e,f,g,h,i,j;if(37>c&&(a=a.toLowerCase()),(e=a.indexOf("\x2e"))>-1)if(e=a.length-e-1,f=k(new u(c).pow(e).toF(),10),h=a.split("\x2e"),g=k(h[1]),h=k(h[0]),j=x(g,f,g.length-f.length,d,b,1&h[h.length-1]),i=j.c,e=j.e){for(;++e;i.unshift(0));a=l(h)+"\x2e"+l(i)}else i[0]?h[e=h.length-1]<b-1?(++h[e],a=l(h)):a=new u(l(h),b).plus(t).toS(b):a=l(h);else a=l(k(a));return a}function x(a,b,c,d,e,g){var h,i,l,m,n,o=b.slice(),p=h=b.length,q=a.length,r=a.slice(0,h),s=r.length,v=new u(t),w=v.c=[],x=0,y=f+(v.e=c)+1;for(v.s=d,d=0>y?0:y;s++<h;r.push(0));o.unshift(0);do{for(l=0;e>l;l++){if(h!=(s=r.length))m=h>s?1:-1;else for(n=-1,m=0;++n<h;)if(b[n]!=r[n]){m=b[n]>r[n]?1:-1;break}if(!(0>m))break;for(i=s==h?b:o;s;){if(r[--s]<i[s]){for(n=s;n&&!r[--n];r[n]=e-1);--r[n],r[s]+=e}r[s]-=i[s]}for(;!r[0];r.shift());}w[x++]=m?l:++l,r[0]&&m?r[s]=a[p]||0:r=[a[p]]}while((p++<q||null!=r[0])&&d--);return w[0]||1==x||(--v.e,w.shift()),x>y&&z(v,f,e,g,null!=r[0]),v.e>k?v.c=v.e=null:v.e<j&&(v.c=[v.e=0]),v}function y(a,b,c){var d=b-(a=new u(a)).e,e=a.c;if(!e)return a.toS();for(e.length>++b&&z(a,d,10),d=0==e[0]?d+1:c?b:a.e+d+1;e.length<d;e.push(0));return d=a.e,1==c||2==c&&(--b<d||h>=d)?(a.s<0&&e[0]?"\x2d":"")+(e.length>1?(e.splice(1,0,"\x2e"),e.join("")):e[0])+(0>d?"\x65":"\x65\x2b")+d:a.toS()}function z(a,b,c,d,e){var f=a.c,h=a.s<0,i=c/2,j=a.e+b+1,k=f[j],l=e||0>j||null!=f[j+1];if(e=4>g?(null!=k||l)&&(0==g||2==g&&!h||3==g&&h):k>i||k==i&&(4==g||l||6==g&&(1&f[j-1]||!b&&d)||7==g&&!h||8==g&&h),1>j||!f[0])return f.length=0,f.push(0),e?(f[0]=1,a.e=-b):a.e=0,a;if(f.length=j--,e)for(--c;++f[j]>c;)f[j]=0,j--||(++a.e,f.unshift(1));for(j=f.length;!f[--j];f.pop());return a}function A(a,b,c){var d=g;return g=c,a=new u(a),a.c&&z(a,b,10),g=d,a}var p,d=1e9,e=1e6,f=20,g=4,h=-7,i=21,j=-d,k=d,l=!0,m=parseInt,n=u.prototype,o="\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x24\x5f",q=0,r=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,s=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},t=u(1);u.ROUND_UP=0,u.ROUND_DOWN=1,u.ROUND_CEIL=2,u.ROUND_FLOOR=3,u.ROUND_HALF_UP=4,u.ROUND_HALF_DOWN=5,u.ROUND_HALF_EVEN=6,u.ROUND_HALF_CEIL=7,u.ROUND_HALF_FLOOR=8,u.fromBuffer=function(a,b){var c,d,e,f,g,h;if(b||(b={}),c={1:"\x62\x69\x67","-1":"\x6c\x69\x74\x74\x6c\x65"}[b.endian]||b.endian||"\x62\x69\x67",d="\x61\x75\x74\x6f"===b.size?Math.ceil(a.length):b.size||1,a.length%d!==0)throw new RangeError("\x42\x75\x66\x66\x65\x72\x20\x6c\x65\x6e\x67\x74\x68\x20\x28"+a.length+"\x29\x20\x6d\x75\x73\x74\x20\x62\x65\x20\x61\x20\x6d\x75\x6c\x74\x69\x70\x6c\x65\x20\x6f\x66\x20\x73\x69\x7a\x65\x20\x28"+d+"\x29");for(e=[],f=0;f<a.length;f+=d){for(g=[],h=0;d>h;h++)g.push(a[f+("\x62\x69\x67"===c?h:d-h-1)]);e.push(g.map(function(a){return(16>a?"\x30":"")+a.toString(16)}).join(""))}return u(e.join(""),16)},u.config=function(){var a,b,c=0,e={},n=arguments,o=n[0],r="\x63\x6f\x6e\x66\x69\x67",s=function(a,b,c){return!((p=b>a||a>c)||m(a)!=a&&0!==a)},t=o&&"\x6f\x62\x6a\x65\x63\x74"==typeof o?function(){return o.hasOwnProperty(b)?null!=(a=o[b]):void 0}:function(){return n.length>c?null!=(a=n[c++]):void 0};return t(b="\x44\x45\x43\x49\x4d\x41\x4c\x5f\x50\x4c\x41\x43\x45\x53")&&(s(a,0,d)?f=0|a:v(a,b,r)),e[b]=f,t(b="\x52\x4f\x55\x4e\x44\x49\x4e\x47\x5f\x4d\x4f\x44\x45")&&(s(a,0,8)?g=0|a:v(a,b,r)),e[b]=g,t(b="\x45\x58\x50\x4f\x4e\x45\x4e\x54\x49\x41\x4c\x5f\x41\x54")&&(s(a,-d,d)?h=-(i=~~(0>a?-a:+a)):!p&&a&&s(a[0],-d,0)&&s(a[1],0,d)?(h=~~a[0],i=~~a[1]):v(a,b,r,1)),e[b]=[h,i],t(b="\x52\x41\x4e\x47\x45")&&(s(a,-d,d)&&~~a?j=-(k=~~(0>a?-a:+a)):!p&&a&&s(a[0],-d,-1)&&s(a[1],1,d)?(j=~~a[0],k=~~a[1]):v(a,b,r,1,1)),e[b]=[j,k],t(b="\x45\x52\x52\x4f\x52\x53")&&(a===!!a||1===a||0===a?(p=q=0,m=(l=!!a)?parseInt:parseFloat):v(a,b,r,0,0,1)),e[b]=l,e},n.abs=n.absoluteValue=function(){var a=new u(this);return a.s<0&&(a.s=1),a},n.bitLength=function(){return this.toString(2).length},n.ceil=function(){return A(this,0,2)},n.comparedTo=n.cmp=function(a,b){var c,d=this,e=d.c,f=(q=-q,a=new u(a,b)).c,g=d.s,h=a.s,i=d.e,j=a.e;if(!g||!h)return null;if(c=e&&!e[0],b=f&&!f[0],c||b)return c?b?0:-h:g;if(g!=h)return g;if(c=0>g,b=i==j,!e||!f)return b?0:!e^c?1:-1;if(!b)return i>j^c?1:-1;for(g=-1,h=(i=e.length)<(j=f.length)?i:j;++g<h;)if(e[g]!=f[g])return e[g]>f[g]^c?1:-1;return i==j?0:i>j^c?1:-1},n.dividedBy=n.div=function(a,b){var c=this.c,d=this.e,e=this.s,f=(q=2,a=new u(a,b)).c,g=a.e,h=a.s,i=e==h?1:-1;return(d||c&&c[0])&&(g||f&&f[0])?x(c,f,d-g,i,10):new u(e&&h&&(c?!f||c[0]!=f[0]:f)?c&&0==c[0]||!f?0*i:i/0:NaN)},n.equals=n.eq=function(a,b){return q=3,0===this.cmp(a,b)},n.floor=function(){return A(this,0,3)},n.greaterThan=n.gt=function(a,b){return q=4,this.cmp(a,b)>0},n.greaterThanOrEqualTo=n.gte=function(a,b){return q=5,1==(b=this.cmp(a,b))||0===b},n.isFinite=n.isF=function(){return!!this.c},n.isNaN=function(){return!this.s},n.isNegative=n.isNeg=function(){return this.s<0},n.isZero=n.isZ=function(){return!!this.c&&0==this.c[0]},n.lessThan=n.lt=function(a,b){return q=6,this.cmp(a,b)<0},n.lessThanOrEqualTo=n.lte=n.le=function(a,b){return q=7,-1==(b=this.cmp(a,b))||0===b},n.minus=n.sub=function(a,b){var c,d,e,f,k,l,m,n,h=this,i=h.s;if(b=(q=8,a=new u(a,b)).s,!i||!b)return new u(NaN);if(i!=b)return a.s=-b,h.plus(a);if(k=h.c,l=h.e,m=a.c,n=a.e,!l||!n){if(!k||!m)return k?(a.s=-b,a):new u(m?h:NaN);if(!k[0]||!m[0])return m[0]?(a.s=-b,a):new u(k[0]?h:3==g?-0:0)}if(k=k.slice(),i=l-n){for(c=(f=0>i)?(i=-i,k):(n=l,m),c.reverse(),b=i;b--;c.push(0));c.reverse()}else for(e=((f=k.length<m.length)?k:m).length,i=b=0;e>b;b++)if(k[b]!=m[b]){f=k[b]<m[b];break}if(f&&(c=k,k=m,m=c,a.s=-a.s),(b=-((e=k.length)-m.length))>0)for(;b--;k[e++]=0);for(b=m.length;b>i;){if(k[--b]<m[b]){for(d=b;d&&!k[--d];k[d]=9);--k[d],k[b]+=10}k[b]-=m[b]}for(;0==k[--e];k.pop());for(;0==k[0];k.shift(),--n);return(j>n||!k[0])&&(k[0]||(a.s=3==g?-1:1),k=[n=0]),a.c=k,a.e=n,a},n.modulo=n.mod=function(a,b){var c=this,d=c.c,e=(q=9,a=new u(a,b)).c,h=c.s,i=a.s;return b=!h||!i||e&&!e[0],b||d&&!d[0]?new u(b?NaN:c):(c.s=a.s=1,b=1==a.cmp(c),c.s=h,a.s=i,b?new u(c):(h=f,i=g,f=0,g=1,c=c.div(a),f=h,g=i,this.minus(c.times(a))))},n.negated=n.neg=function(){var a=new u(this);return a.s=-a.s||null,a},n.plus=n.add=function(a,b){var c,f,g,h,i,d=this,e=d.s;if(b=(q=10,a=new u(a,b)).s,!e||!b)return new u(NaN);if(e!=b)return a.s=-b,d.minus(a);if(f=d.e,g=d.c,h=a.e,i=a.c,!f||!h){if(!g||!i)return new u(e/0);if(!g[0]||!i[0])return i[0]?a:new u(g[0]?d:0*e)}if(g=g.slice(),e=f-h){for(c=e>0?(h=f,i):(e=-e,g),c.reverse();e--;c.push(0));c.reverse()}for(g.length-i.length<0&&(c=i,i=g,g=c),e=i.length,b=0;e;b=(g[--e]=g[e]+i[e]+b)/10^0,g[e]%=10);for(b&&(g.unshift(b),++h>k&&(g=h=null)),e=g.length;0==g[--e];g.pop());return a.c=g,a.e=h,a},n.toPower=n.pow=function(a){var b=0*a==0?0|a:a,c=new u(this),d=new u(t);if(((p=-e>a||a>e)&&(b=1*a/0)||m(a)!=a&&0!==a&&!(b=NaN))&&!v(a,"\x65\x78\x70\x6f\x6e\x65\x6e\x74","\x70\x6f\x77")||!b)return new u(Math.pow(c.toS(),b));for(b=0>b?-b:b;1&b&&(d=d.times(c)),b>>=1,b;)c=c.times(c);return 0>a?t.div(d):d},n.powm=function(a,b){return this.pow(a).mod(b)},n.round=function(a,b){return a=null==a||((p=0>a||a>d)||m(a)!=a)&&!v(a,"\x64\x65\x63\x69\x6d\x61\x6c\x20\x70\x6c\x61\x63\x65\x73","\x72\x6f\x75\x6e\x64")?0:0|a,b=null==b||((p=0>b||b>8)||m(b)!=b&&0!==b)&&!v(b,"\x6d\x6f\x64\x65","\x72\x6f\x75\x6e\x64")?g:0|b,A(this,a,b)},n.squareRoot=n.sqrt=function(){var a,b,c,d,e=this,h=e.c,i=e.s,j=e.e,k=f,l=g,m=new u("\x30\x2e\x35");if(1!==i||!h||!h[0])return new u(!i||0>i&&(!h||h[0])?NaN:h?e:1/0);for(i=Math.sqrt(e.toS()),g=1,0==i||i==1/0?(a=h.join(""),a.length+j&1||(a+="\x30"),b=new u(Math.sqrt(a)+""),b.c||(b.c=[1]),b.e=((j+1)/2|0)-(0>j||1&j)):b=new u(a=""+i),c=b.e,i=c+(f+=4),3>i&&(i=0),j=i;;)if(d=b,b=m.times(d.plus(e.div(d))),d.c.slice(0,i).join("")===b.c.slice(0,i).join("")){if(h=b.c,i-=a&&b.e<c,9!=h[i]||9!=h[i-1]||9!=h[i-2]||!(9==h[i-3]||a&&4==h[i-3])){if(!(h[j]||h[j-1]||h[j-2]||h[j-3]&&5!=h[j-3]||(h.length>j-2&&(h.length=j-2),b.times(b).eq(e)))){for(;h.length<j-3;)h.push(0);h[j-3]++}return g=l,z(b,f=k,10),b}if(a&&9==h[i-3]&&(d=b.round(k,0),d.times(d).eq(e)))return g=l,f=k,d;f+=4,i+=4,a=""}},n.times=n.mul=function(a,b){var c,d=this,e=d.c,f=(q=11,a=new u(a,b)).c,g=d.e,h=a.e,i=d.s;if(a.s=i==(b=a.s)?1:-1,!((g||e&&e[0])&&(h||f&&f[0])))return new u(!i||!b||e&&!e[0]&&!f||f&&!f[0]&&!e?NaN:e&&f?0*a.s:a.s/0);for(a.e=g+h,(i=e.length)<(b=f.length)&&(c=e,e=f,f=c,h=i,i=b,b=h),h=i+b,c=[];h--;c.push(0));for(g=b-1;g>-1;g--){for(b=0,h=i+g;h>g;b=c[h]+f[g]*e[h-g-1]+b,c[h--]=b%10|0,b=b/10|0);b&&(c[h]=(c[h]+b)%10)}for(b&&++a.e,!c[0]&&c.shift(),h=c.length;!c[--h];c.pop());return a.c=a.e>k?a.e=null:a.e<j?[a.e=0]:c,a},n.toBuffer=function(a){var b,c,d,e,f,g,h,i,j,k;if("\x73\x74\x72\x69\x6e\x67"==typeof a){if("\x6d\x70\x69\x6e\x74"!==a)return"\x55\x6e\x73\x75\x70\x70\x6f\x72\x74\x65\x64\x20\x42\x75\x66\x66\x65\x72\x20\x72\x65\x70\x72\x65\x73\x65\x6e\x74\x61\x74\x69\x6f\x6e";if(b=this.abs(),c=b.toBuffer({size:1,endian:"\x62\x69\x67"}),d=1===c.length&&0===c[0]?0:c.length,128&c[0]&&d++,e=new Buffer(4+d),d>0&&c.copy(e,4+(128&c[0]?1:0)),128&c[0]&&(e[4]=0),e[0]=d&255<<24,e[1]=d&255<<16,e[2]=65280&d,e[3]=255&d,f=this.lt(0))for(g=4;g<e.length;g++)e[g]=255-e[g];return e[4]=127&e[4]|(f?128:0),f&&e[e.length-1]++,e}if(a||(a={}),h={1:"\x62\x69\x67","-1":"\x6c\x69\x74\x74\x6c\x65"}[a.endian]||a.endian||"\x62\x69\x67",i=this.toString(16),"\x2d"===i.charAt(0))throw Error("\x63\x6f\x6e\x76\x65\x72\x74\x69\x6e\x67\x20\x6e\x65\x67\x61\x74\x69\x76\x65\x20\x6e\x75\x6d\x62\x65\x72\x73\x20\x74\x6f\x20\x42\x75\x66\x66\x65\x72\x73\x20\x6e\x6f\x74\x20\x73\x75\x70\x70\x6f\x72\x74\x65\x64\x20\x79\x65\x74");for(j="\x61\x75\x74\x6f"===a.size?Math.ceil(i.length/2):a.size||1,d=Math.ceil(i.length/(2*j))*j,c=new Buffer(d);i.length<2*d;)i="\x30"+i;return k=i.split(RegExp("\x28\x2e\x7b"+2*j+"\x7d\x29")).filter(function(a){return a.length>0}),k.forEach(function(a,b){var d,e;for(d=0;j>d;d++)e=b*j+("\x62\x69\x67"===h?d:j-d-1),c[e]=parseInt(a.slice(2*d,2*d+2),16)}),c},n.toExponential=n.toE=function(a){return y(this,(null==a||((p=0>a||a>d)||m(a)!=a&&0!==a)&&!v(a,"\x64\x65\x63\x69\x6d\x61\x6c\x20\x70\x6c\x61\x63\x65\x73","\x74\x6f\x45"))&&this.c?this.c.length-1:0|a,1)},n.toFixed=n.toF=function(a){var b,c,e,f=this;return null==a||((p=0>a||a>d)||m(a)!=a&&0!==a)&&!v(a,"\x64\x65\x63\x69\x6d\x61\x6c\x20\x70\x6c\x61\x63\x65\x73","\x74\x6f\x46")||(e=f.e+(0|a)),b=h,a=i,h=-(i=1/0),e==c?c=f.toS():(c=y(f,e),f.s<0&&f.c&&(f.c[0]?c.indexOf("\x2d")<0&&(c="\x2d"+c):c=c.replace(/^-/,""))),h=b,i=a,c},n.toFraction=n.toFr=function(a){var b,c,d,e,h,i,j,m=e=new u(t),n=d=new u("\x30"),o=this,r=o.c,s=k,w=f,x=g,y=new u(t);if(!r)return o.toS();for(j=y.e=r.length-o.e-1,(null==a||(!(q=12,i=new u(a)).s||(p=i.cmp(m)<0||!i.c)||l&&i.e<i.c.length-1)&&!v(a,"\x6d\x61\x78\x20\x64\x65\x6e\x6f\x6d\x69\x6e\x61\x74\x6f\x72","\x74\x6f\x46\x72")||(a=i).cmp(y)>0)&&(a=j>0?y:m),k=1/0,i=new u(r.join("")),f=0,g=1;b=i.div(y),h=e.plus(b.times(n)),1!=h.cmp(a);)e=n,n=h,m=d.plus(b.times(h=m)),d=h,y=i.minus(b.times(h=y)),i=h;return h=a.minus(e).div(n),d=d.plus(h.times(m)),e=e.plus(h.times(n)),d.s=m.s=o.s,f=2*j,g=x,c=m.div(n).minus(o).abs().cmp(d.div(e).minus(o).abs())<1?[m.toS(),n.toS()]:[d.toS(),e.toS()],k=s,f=w,c},n.toPrecision=n.toP=function(a){return null==a||((p=1>a||a>d)||m(a)!=a)&&!v(a,"\x70\x72\x65\x63\x69\x73\x69\x6f\x6e","\x74\x6f\x50")?this.toS():y(this,0|--a,2)},n.toString=n.toS=function(a){var b,c,d,e=this,f=e.e;if(null===f)c=e.s?"\x49\x6e\x66\x69\x6e\x69\x74\x79":"\x4e\x61\x4e";else{if(a===b&&(h>=f||f>=i))return y(e,e.c.length-1,1);if(c=e.c.join(""),0>f){for(;++f;c="\x30"+c);c="\x30\x2e"+c}else if(d=c.length,f>0)if(++f>d)for(f-=d;f--;c+="\x30");else d>f&&(c=c.slice(0,f)+"\x2e"+c.slice(f));else if(b=c.charAt(0),d>1)c=b+"\x2e"+c.slice(1);else if("\x30"==b)return b;if(null!=a)if((p=!(a>=2&&65>a))||a!=(0|a)&&l)v(a,"\x62\x61\x73\x65","\x74\x6f\x53");else if(c=w(c,0|a,10,e.s),"\x30"==c)return c}return e.s<0?"\x2d"+c:c},n.toNumber=function(){return parseInt(""+this,10)},n.valueOf=function(){return this.toS()},a.exports=u}),c.register("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x62\x6c\x6f\x63\x6b\x53\x74\x61\x74\x75\x73\x2e\x6a\x73",function(a,b,c){function e(){var a=[5e8,4e8,3e8,2e8,1e8],b=3e6,c=60480,e=function(a){if(a=parseInt(a),isNaN(a))throw Error("\x49\x6e\x76\x61\x6c\x69\x64\x20\x62\x6c\x6f\x63\x6b\x20\x68\x65\x69\x67\x68\x74");return Math.abs(a)};this.calcMilestone=function(d){var f=parseInt(e(d-c)/b),g=a[a.length-1];return f>a.length-1?a.lastIndexOf(g):f},this.calcReward=function(b){var b=e(b);return c>b?0:a[this.calcMilestone(b)]},this.calcSupply=function(f){var g,h,i,j,k,l,m,n;for(f=e(f),g=this.calcMilestone(f),h=d.totalAmount/Math.pow(10,8),i=[],j=0,k=0,l=0;l<a.length&&g>=l&&(k=a[l]/Math.pow(10,8),!(c>f));l++)b>f?j=f%b:(j=b,f-=b,f>0&&l==a.length-1&&(m=c-1,j+=f>=m?f-m:m-f)),i.push([j,k]);for(l=0;l<i.length;l++)n=i[l],h+=n[0]*n[1];return h*Math.pow(10,8)}}var d=c("\x2e\x2f\x63\x6f\x6e\x73\x74\x61\x6e\x74\x73\x2e\x6a\x73");a.exports=e}),c.register("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x63\x6f\x6e\x73\x74\x61\x6e\x74\x73\x2e\x6a\x73",function(a){a.exports={maxAmount:1e8,maxPayloadLength:1048576,blockHeaderLength:248,addressLength:208,maxAddressesLength:26624,maxClientConnections:100,numberLength:1e8,feeStartVolume:1e12,feeStart:1,maxRequests:12e4,requestLength:104,signatureLength:196,maxSignaturesLength:50176,maxConfirmations:7700,confirmationLength:77,fixedPoint:Math.pow(10,8),totalAmount:1e16}}),c.register("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x64\x61\x70\x70\x43\x61\x74\x65\x67\x6f\x72\x79\x2e\x6a\x73",function(a){a.exports={Common:0,Business:1,Catalogs:2,Education:3,Entertainment:4,Multimedia:5,Networking:6,Utilities:7,Games:8}}),c.register("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x64\x61\x70\x70\x54\x79\x70\x65\x73\x2e\x6a\x73",function(a){a.exports={DAPP:0,FILE:1}}),c.register("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x64\x62\x4c\x69\x74\x65\x2e\x6a\x73",function(a,b,c){var d=c("\x64\x62\x6c\x69\x74\x65"),e=c("\x61\x73\x79\x6e\x63");c("\x70\x61\x74\x68"),/^win/.test(process.platform),/^darwin/.test(process.platform);a.exports.connect=function(a,b){var c=d(a),f=["\x43\x52\x45\x41\x54\x45\x20\x54\x41\x42\x4c\x45\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x62\x6c\x6f\x63\x6b\x73\x20\x28\x69\x64\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x20\x50\x52\x49\x4d\x41\x52\x59\x20\x4b\x45\x59\x2c\x20\x76\x65\x72\x73\x69\x6f\x6e\x20\x49\x4e\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x20\x49\x4e\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x68\x65\x69\x67\x68\x74\x20\x49\x4e\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x2c\x20\x6e\x75\x6d\x62\x65\x72\x4f\x66\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73\x20\x49\x4e\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x74\x6f\x74\x61\x6c\x41\x6d\x6f\x75\x6e\x74\x20\x42\x49\x47\x49\x4e\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x74\x6f\x74\x61\x6c\x46\x65\x65\x20\x42\x49\x47\x49\x4e\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x72\x65\x77\x61\x72\x64\x20\x42\x49\x47\x49\x4e\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x70\x61\x79\x6c\x6f\x61\x64\x4c\x65\x6e\x67\x74\x68\x20\x49\x4e\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x70\x61\x79\x6c\x6f\x61\x64\x48\x61\x73\x68\x20\x42\x49\x4e\x41\x52\x59\x28\x33\x32\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x67\x65\x6e\x65\x72\x61\x74\x6f\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x20\x42\x49\x4e\x41\x52\x59\x28\x33\x32\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x62\x6c\x6f\x63\x6b\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x42\x49\x4e\x41\x52\x59\x28\x36\x34\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x46\x4f\x52\x45\x49\x47\x4e\x20\x4b\x45\x59\x20\x28\x20\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b\x20\x29\x20\x52\x45\x46\x45\x52\x45\x4e\x43\x45\x53\x20\x62\x6c\x6f\x63\x6b\x73\x20\x28\x20\x69\x64\x20\x29\x20\x4f\x4e\x20\x44\x45\x4c\x45\x54\x45\x20\x53\x45\x54\x20\x4e\x55\x4c\x4c\x29","\x43\x52\x45\x41\x54\x45\x20\x54\x41\x42\x4c\x45\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x74\x72\x73\x20\x28\x69\x64\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x20\x50\x52\x49\x4d\x41\x52\x59\x20\x4b\x45\x59\x2c\x20\x62\x6c\x6f\x63\x6b\x49\x64\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x74\x79\x70\x65\x20\x54\x49\x4e\x59\x49\x4e\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x20\x49\x4e\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x73\x65\x6e\x64\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x20\x42\x49\x4e\x41\x52\x59\x28\x33\x32\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x73\x65\x6e\x64\x65\x72\x49\x64\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x31\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x49\x64\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x31\x29\x2c\x20\x73\x65\x6e\x64\x65\x72\x55\x73\x65\x72\x6e\x61\x6d\x65\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x2c\x20\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x55\x73\x65\x72\x6e\x61\x6d\x65\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x2c\x20\x61\x6d\x6f\x75\x6e\x74\x20\x42\x49\x47\x49\x4e\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x66\x65\x65\x20\x42\x49\x47\x49\x4e\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x42\x49\x4e\x41\x52\x59\x28\x36\x34\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x73\x69\x67\x6e\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x42\x49\x4e\x41\x52\x59\x28\x36\x34\x29\x2c\x20\x72\x65\x71\x75\x65\x73\x74\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x20\x42\x49\x4e\x41\x52\x59\x28\x33\x32\x29\x2c\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x54\x45\x58\x54\x2c\x20\x46\x4f\x52\x45\x49\x47\x4e\x20\x4b\x45\x59\x28\x62\x6c\x6f\x63\x6b\x49\x64\x29\x20\x52\x45\x46\x45\x52\x45\x4e\x43\x45\x53\x20\x62\x6c\x6f\x63\x6b\x73\x28\x69\x64\x29\x20\x4f\x4e\x20\x44\x45\x4c\x45\x54\x45\x20\x43\x41\x53\x43\x41\x44\x45\x29","\x43\x52\x45\x41\x54\x45\x20\x54\x41\x42\x4c\x45\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x28\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x20\x50\x52\x49\x4d\x41\x52\x59\x20\x4b\x45\x59\x2c\x20\x70\x75\x62\x6c\x69\x63\x4b\x65\x79\x20\x42\x49\x4e\x41\x52\x59\x28\x33\x32\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x46\x4f\x52\x45\x49\x47\x4e\x20\x4b\x45\x59\x28\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29\x20\x52\x45\x46\x45\x52\x45\x4e\x43\x45\x53\x20\x74\x72\x73\x28\x69\x64\x29\x20\x4f\x4e\x20\x44\x45\x4c\x45\x54\x45\x20\x43\x41\x53\x43\x41\x44\x45\x29","\x43\x52\x45\x41\x54\x45\x20\x54\x41\x42\x4c\x45\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x64\x65\x6c\x65\x67\x61\x74\x65\x73\x28\x75\x73\x65\x72\x6e\x61\x6d\x65\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x46\x4f\x52\x45\x49\x47\x4e\x20\x4b\x45\x59\x28\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29\x20\x52\x45\x46\x45\x52\x45\x4e\x43\x45\x53\x20\x74\x72\x73\x28\x69\x64\x29\x20\x4f\x4e\x20\x44\x45\x4c\x45\x54\x45\x20\x43\x41\x53\x43\x41\x44\x45\x29","\x43\x52\x45\x41\x54\x45\x20\x54\x41\x42\x4c\x45\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x76\x6f\x74\x65\x73\x28\x76\x6f\x74\x65\x73\x20\x54\x45\x58\x54\x2c\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x46\x4f\x52\x45\x49\x47\x4e\x20\x4b\x45\x59\x28\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29\x20\x52\x45\x46\x45\x52\x45\x4e\x43\x45\x53\x20\x74\x72\x73\x28\x69\x64\x29\x20\x4f\x4e\x20\x44\x45\x4c\x45\x54\x45\x20\x43\x41\x53\x43\x41\x44\x45\x29","\x43\x52\x45\x41\x54\x45\x20\x54\x41\x42\x4c\x45\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x75\x73\x65\x72\x6e\x61\x6d\x65\x73\x28\x75\x73\x65\x72\x6e\x61\x6d\x65\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x46\x4f\x52\x45\x49\x47\x4e\x20\x4b\x45\x59\x28\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29\x20\x52\x45\x46\x45\x52\x45\x4e\x43\x45\x53\x20\x74\x72\x73\x28\x69\x64\x29\x20\x4f\x4e\x20\x44\x45\x4c\x45\x54\x45\x20\x43\x41\x53\x43\x41\x44\x45\x29","\x43\x52\x45\x41\x54\x45\x20\x54\x41\x42\x4c\x45\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x63\x6f\x6e\x74\x61\x63\x74\x73\x28\x61\x64\x64\x72\x65\x73\x73\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x31\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x46\x4f\x52\x45\x49\x47\x4e\x20\x4b\x45\x59\x28\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29\x20\x52\x45\x46\x45\x52\x45\x4e\x43\x45\x53\x20\x74\x72\x73\x28\x69\x64\x29\x20\x4f\x4e\x20\x44\x45\x4c\x45\x54\x45\x20\x43\x41\x53\x43\x41\x44\x45\x29","\x43\x52\x45\x41\x54\x45\x20\x54\x41\x42\x4c\x45\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x66\x6f\x72\x6b\x73\x5f\x73\x74\x61\x74\x28\x64\x65\x6c\x65\x67\x61\x74\x65\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x20\x42\x49\x4e\x41\x52\x59\x28\x33\x32\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x62\x6c\x6f\x63\x6b\x54\x69\x6d\x65\x73\x74\x61\x6d\x70\x20\x49\x4e\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x62\x6c\x6f\x63\x6b\x49\x64\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x62\x6c\x6f\x63\x6b\x48\x65\x69\x67\x68\x74\x20\x49\x4e\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x63\x61\x75\x73\x65\x20\x49\x4e\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x29","\x43\x52\x45\x41\x54\x45\x20\x54\x41\x42\x4c\x45\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x28\x6d\x69\x6e\x20\x49\x4e\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x6c\x69\x66\x65\x74\x69\x6d\x65\x20\x49\x4e\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x6b\x65\x79\x73\x67\x72\x6f\x75\x70\x20\x54\x45\x58\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x20\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x46\x4f\x52\x45\x49\x47\x4e\x20\x4b\x45\x59\x28\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29\x20\x52\x45\x46\x45\x52\x45\x4e\x43\x45\x53\x20\x74\x72\x73\x28\x69\x64\x29\x20\x4f\x4e\x20\x44\x45\x4c\x45\x54\x45\x20\x43\x41\x53\x43\x41\x44\x45\x29","\x43\x52\x45\x41\x54\x65\x20\x54\x41\x42\x4c\x45\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x64\x61\x70\x70\x73\x28\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x6e\x61\x6d\x65\x20\x56\x41\x52\x43\x48\x41\x52\x28\x33\x32\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x64\x65\x73\x63\x72\x69\x70\x74\x69\x6f\x6e\x20\x56\x41\x52\x43\x48\x41\x52\x48\x28\x31\x36\x30\x29\x2c\x20\x74\x61\x67\x73\x20\x56\x41\x52\x43\x48\x41\x52\x48\x28\x31\x36\x30\x29\x2c\x20\x73\x69\x61\x41\x73\x63\x69\x69\x20\x54\x45\x58\x54\x2c\x20\x73\x69\x61\x49\x63\x6f\x6e\x20\x54\x45\x58\x54\x2c\x20\x67\x69\x74\x20\x54\x45\x58\x54\x2c\x20\x74\x79\x70\x65\x20\x49\x4e\x54\x45\x47\x45\x52\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x63\x61\x74\x65\x67\x6f\x72\x79\x20\x49\x4e\x54\x45\x47\x45\x52\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x69\x63\x6f\x6e\x20\x54\x45\x58\x54\x2c\x20\x46\x4f\x52\x45\x49\x47\x4e\x20\x4b\x45\x59\x28\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29\x20\x52\x45\x46\x45\x52\x45\x4e\x43\x45\x53\x20\x74\x72\x73\x28\x69\x64\x29\x20\x4f\x4e\x20\x44\x45\x4c\x45\x54\x45\x20\x43\x41\x53\x43\x41\x44\x45\x29","\x43\x52\x45\x41\x54\x45\x20\x54\x41\x42\x4c\x45\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x69\x6e\x74\x72\x61\x6e\x73\x66\x65\x72\x28\x64\x61\x70\x70\x49\x64\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x46\x4f\x52\x45\x49\x47\x4e\x20\x4b\x45\x59\x28\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29\x20\x52\x45\x46\x45\x52\x45\x4e\x43\x45\x53\x20\x74\x72\x73\x28\x69\x64\x29\x20\x4f\x4e\x20\x44\x45\x4c\x45\x54\x45\x20\x43\x41\x53\x43\x41\x44\x45\x29","\x43\x52\x45\x41\x54\x45\x20\x54\x41\x42\x4c\x45\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x73\x69\x61\x5f\x70\x65\x65\x72\x73\x28\x69\x70\x20\x49\x4e\x54\x45\x47\x45\x52\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x20\x50\x52\x49\x4d\x41\x52\x59\x20\x4b\x45\x59\x2c\x20\x70\x6f\x72\x74\x20\x54\x49\x4e\x59\x49\x4e\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x29","\x43\x52\x45\x41\x54\x65\x20\x54\x41\x42\x4c\x45\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x6f\x75\x74\x74\x72\x61\x6e\x73\x66\x65\x72\x28\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x64\x61\x70\x70\x49\x64\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x6f\x75\x74\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x20\x55\x4e\x49\x51\x55\x45\x2c\x20\x46\x4f\x52\x45\x49\x47\x4e\x20\x4b\x45\x59\x28\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29\x20\x52\x45\x46\x45\x52\x45\x4e\x43\x45\x53\x20\x74\x72\x73\x28\x69\x64\x29\x20\x4f\x4e\x20\x44\x45\x4c\x45\x54\x45\x20\x43\x41\x53\x43\x41\x44\x45\x29","\x43\x52\x45\x41\x54\x45\x20\x54\x41\x42\x4c\x45\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x70\x65\x65\x72\x73\x20\x28\x69\x64\x20\x49\x4e\x54\x45\x47\x45\x52\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x20\x50\x52\x49\x4d\x41\x52\x59\x20\x4b\x45\x59\x2c\x20\x69\x70\x20\x49\x4e\x54\x45\x47\x45\x52\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x70\x6f\x72\x74\x20\x54\x49\x4e\x59\x49\x4e\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x73\x74\x61\x74\x65\x20\x54\x49\x4e\x59\x49\x4e\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x6f\x73\x20\x56\x41\x52\x43\x48\x41\x52\x28\x36\x34\x29\x2c\x20\x73\x68\x61\x72\x65\x50\x6f\x72\x74\x20\x54\x49\x4e\x59\x49\x4e\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x76\x65\x72\x73\x69\x6f\x6e\x20\x56\x41\x52\x43\x48\x41\x52\x28\x31\x31\x29\x2c\x20\x63\x6c\x6f\x63\x6b\x20\x49\x4e\x54\x29","\x43\x52\x45\x41\x54\x45\x20\x54\x41\x42\x4c\x45\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x70\x65\x65\x72\x73\x5f\x64\x61\x70\x70\x20\x28\x70\x65\x65\x72\x49\x64\x20\x49\x4e\x54\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x64\x61\x70\x70\x69\x64\x20\x56\x41\x52\x43\x48\x41\x52\x28\x32\x30\x29\x20\x4e\x4f\x54\x20\x4e\x55\x4c\x4c\x2c\x20\x46\x4f\x52\x45\x49\x47\x4e\x20\x4b\x45\x59\x28\x70\x65\x65\x72\x49\x64\x29\x20\x52\x45\x46\x45\x52\x45\x4e\x43\x45\x53\x20\x70\x65\x65\x72\x73\x28\x69\x64\x29\x20\x4f\x4e\x20\x44\x45\x4c\x45\x54\x45\x20\x43\x41\x53\x43\x41\x44\x45\x29","\x43\x52\x45\x41\x54\x45\x20\x55\x4e\x49\x51\x55\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x62\x6c\x6f\x63\x6b\x73\x5f\x68\x65\x69\x67\x68\x74\x20\x4f\x4e\x20\x62\x6c\x6f\x63\x6b\x73\x28\x68\x65\x69\x67\x68\x74\x29","\x43\x52\x45\x41\x54\x45\x20\x55\x4e\x49\x51\x55\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x62\x6c\x6f\x63\x6b\x73\x5f\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b\x20\x4f\x4e\x20\x62\x6c\x6f\x63\x6b\x73\x28\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b\x29","\x43\x52\x45\x41\x54\x45\x20\x55\x4e\x49\x51\x55\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x6f\x74\x20\x45\x58\x49\x53\x54\x53\x20\x6f\x75\x74\x5f\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x5f\x69\x64\x20\x4f\x4e\x20\x6f\x75\x74\x74\x72\x61\x6e\x73\x66\x65\x72\x28\x6f\x75\x74\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29","\x43\x52\x45\x41\x54\x45\x20\x55\x4e\x49\x51\x55\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x70\x65\x65\x72\x73\x5f\x75\x6e\x69\x71\x75\x65\x20\x4f\x4e\x20\x70\x65\x65\x72\x73\x28\x69\x70\x2c\x20\x70\x6f\x72\x74\x29","\x43\x52\x45\x41\x54\x45\x20\x55\x4e\x49\x51\x55\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x70\x65\x65\x72\x73\x5f\x64\x61\x70\x70\x5f\x75\x6e\x69\x71\x75\x65\x20\x4f\x4e\x20\x70\x65\x65\x72\x73\x5f\x64\x61\x70\x70\x28\x70\x65\x65\x72\x49\x64\x2c\x20\x64\x61\x70\x70\x69\x64\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x62\x6c\x6f\x63\x6b\x73\x5f\x67\x65\x6e\x65\x72\x61\x74\x6f\x72\x5f\x70\x75\x62\x6c\x69\x63\x5f\x6b\x65\x79\x20\x4f\x4e\x20\x62\x6c\x6f\x63\x6b\x73\x28\x67\x65\x6e\x65\x72\x61\x74\x6f\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x62\x6c\x6f\x63\x6b\x73\x5f\x72\x65\x77\x61\x72\x64\x20\x4f\x4e\x20\x62\x6c\x6f\x63\x6b\x73\x28\x72\x65\x77\x61\x72\x64\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x62\x6c\x6f\x63\x6b\x73\x5f\x74\x6f\x74\x61\x6c\x46\x65\x65\x20\x4f\x4e\x20\x62\x6c\x6f\x63\x6b\x73\x28\x74\x6f\x74\x61\x6c\x46\x65\x65\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x62\x6c\x6f\x63\x6b\x73\x5f\x74\x6f\x74\x61\x6c\x41\x6d\x6f\x75\x6e\x74\x20\x4f\x4e\x20\x62\x6c\x6f\x63\x6b\x73\x28\x74\x6f\x74\x61\x6c\x41\x6d\x6f\x75\x6e\x74\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x62\x6c\x6f\x63\x6b\x73\x5f\x6e\x75\x6d\x62\x65\x72\x4f\x66\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73\x20\x4f\x4e\x20\x62\x6c\x6f\x63\x6b\x73\x28\x6e\x75\x6d\x62\x65\x72\x4f\x66\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x62\x6c\x6f\x63\x6b\x73\x5f\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x20\x4f\x4e\x20\x62\x6c\x6f\x63\x6b\x73\x28\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x74\x72\x73\x5f\x62\x6c\x6f\x63\x6b\x5f\x69\x64\x20\x4f\x4e\x20\x74\x72\x73\x28\x62\x6c\x6f\x63\x6b\x49\x64\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x74\x72\x73\x5f\x73\x65\x6e\x64\x65\x72\x5f\x69\x64\x20\x4f\x4e\x20\x74\x72\x73\x28\x73\x65\x6e\x64\x65\x72\x49\x64\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x74\x72\x73\x5f\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x5f\x69\x64\x20\x4f\x4e\x20\x74\x72\x73\x28\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x49\x64\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x74\x72\x73\x5f\x73\x65\x6e\x64\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x20\x6f\x6e\x20\x74\x72\x73\x28\x73\x65\x6e\x64\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x74\x72\x73\x5f\x73\x65\x6e\x64\x65\x72\x55\x73\x65\x72\x6e\x61\x6d\x65\x20\x6f\x6e\x20\x74\x72\x73\x28\x73\x65\x6e\x64\x65\x72\x55\x73\x65\x72\x6e\x61\x6d\x65\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x74\x72\x73\x5f\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x55\x73\x65\x72\x6e\x61\x6d\x65\x20\x6f\x6e\x20\x74\x72\x73\x28\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x55\x73\x65\x72\x6e\x61\x6d\x65\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x74\x72\x73\x5f\x74\x79\x70\x65\x20\x6f\x6e\x20\x74\x72\x73\x28\x74\x79\x70\x65\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x74\x72\x73\x5f\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x20\x6f\x6e\x20\x74\x72\x73\x28\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x5f\x74\x72\x73\x5f\x69\x64\x20\x4f\x4e\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x28\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x75\x73\x65\x72\x6e\x61\x6d\x65\x73\x5f\x74\x72\x73\x5f\x69\x64\x20\x4f\x4e\x20\x75\x73\x65\x72\x6e\x61\x6d\x65\x73\x28\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x76\x6f\x74\x65\x73\x5f\x74\x72\x73\x5f\x69\x64\x20\x4f\x4e\x20\x76\x6f\x74\x65\x73\x28\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x64\x65\x6c\x65\x67\x61\x74\x65\x73\x5f\x74\x72\x73\x5f\x69\x64\x20\x4f\x4e\x20\x64\x65\x6c\x65\x67\x61\x74\x65\x73\x28\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x63\x6f\x6e\x74\x61\x63\x74\x73\x5f\x74\x72\x73\x5f\x69\x64\x20\x4f\x4e\x20\x63\x6f\x6e\x74\x61\x63\x74\x73\x28\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x5f\x74\x72\x73\x5f\x69\x64\x20\x4f\x4e\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x28\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x64\x61\x70\x70\x73\x5f\x74\x72\x73\x5f\x69\x64\x20\x4f\x4e\x20\x64\x61\x70\x70\x73\x28\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x64\x61\x70\x70\x73\x5f\x6e\x61\x6d\x65\x20\x4f\x4e\x20\x64\x61\x70\x70\x73\x28\x6e\x61\x6d\x65\x29","\x43\x52\x45\x41\x54\x45\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x73\x69\x61\x5f\x70\x65\x65\x72\x73\x5f\x75\x6e\x69\x71\x75\x65\x20\x4f\x4e\x20\x73\x69\x61\x5f\x70\x65\x65\x72\x73\x28\x69\x70\x2c\x20\x70\x6f\x72\x74\x29","\x50\x52\x41\x47\x4d\x41\x20\x66\x6f\x72\x65\x69\x67\x6e\x5f\x6b\x65\x79\x73\x20\x3d\x20\x4f\x4e","\x50\x52\x41\x47\x4d\x41\x20\x73\x79\x6e\x63\x68\x72\x6f\x6e\x6f\x75\x73\x3d\x4f\x46\x46","\x50\x52\x41\x47\x4d\x41\x20\x6a\x6f\x75\x72\x6e\x61\x6c\x5f\x6d\x6f\x64\x65\x3d\x4d\x45\x4d\x4f\x52\x59","\x50\x52\x41\x47\x4d\x41\x20\x64\x65\x66\x61\x75\x6c\x74\x5f\x63\x61\x63\x68\x65\x5f\x73\x69\x7a\x65\x3d\x31\x30\x30\x30\x30","\x50\x52\x41\x47\x4d\x41\x20\x6c\x6f\x63\x6b\x69\x6e\x67\x5f\x6d\x6f\x64\x65\x3d\x45\x58\x43\x4c\x55\x53\x49\x56\x45"],g=["\x55\x50\x44\x41\x54\x45\x20\x70\x65\x65\x72\x73\x20\x53\x45\x54\x20\x73\x74\x61\x74\x65\x20\x3d\x20\x31\x2c\x20\x63\x6c\x6f\x63\x6b\x20\x3d\x20\x6e\x75\x6c\x6c\x20\x77\x68\x65\x72\x65\x20\x73\x74\x61\x74\x65\x20\x21\x3d\x20\x30"];
e.eachSeries(f,function(a,b){c.query(a,function(a,c){b(a,c)})},function(a){if(a)return b(a);var d={};c.query("\x50\x52\x41\x47\x4d\x41\x20\x75\x73\x65\x72\x5f\x76\x65\x72\x73\x69\x6f\x6e",function(a,f){var h,i;return a?b(a):(h=f[0]||0,i=Object.keys(d).sort().filter(function(a){return a>h}),void e.eachSeries(i,function(a,b){e.eachSeries(d[a],function(a,b){c.query(a,function(a,c){b(a,c)})},function(d){return d?b(d):void c.query("\x50\x52\x41\x47\x4d\x41\x20\x75\x73\x65\x72\x5f\x76\x65\x72\x73\x69\x6f\x6e\x20\x3d\x20"+a,function(a,c){b(a,c)})})},function(a){return a?b(a):void e.eachSeries(g,function(a,b){c.query(a,function(a,c){b(a,c)})},function(a){b(a,c)})}))})})}}),c.register("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x64\x69\x66\x66\x2e\x6a\x73",function(a){a.exports={reverse:function(a){var c,d,b=a.slice();for(c=0;c<b.length;c++)d="\x2d"==b[c][0]?"\x2b":"\x2d",b[c]=d+b[c].slice(1);return b},merge:function(a,b){var d,e,f,g,c=a?a.slice():[];for(d=0;d<b.length;d++){if(e=b[d][0],f=b[d].slice(1),"\x2b"==e){if(c=c||[],g=-1,c&&(g=c.indexOf(f)),-1!=g)return!1;c.push(f)}if("\x2d"==e){if(g=-1,c&&(g=c.indexOf(f)),-1==g)return!1;c.splice(g,1),c.length||(c=null)}}return c}}}),c.register("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x65\x6e\x63\x72\x79\x70\x74\x2e\x6a\x73",function(a,b,c){function f(a){return d.convertPublicKey(a)}function g(a){return d.convertSecretKey(a)}function h(a,b,c,d){return nacl.crypto_box(a,b,f(d),g(c))}function i(a,b,c,d){return nacl.crypto_box_open(a,b,f(c),g(d))}function j(){return nacl.crypto_box_random_nonce()}function k(a,b,c){return nacl.crypto_secretbox(nacl.encode_utf8(a),b,g(c))}function l(a,b,c){return nacl.crypto_secretbox_open(a,b,g(c))}var d=c("\x65\x64\x32\x63\x75\x72\x76\x65");c("\x6a\x73\x2d\x6e\x61\x63\x6c");a.exports={convertPublicKey:f,convertPrivateKey:g,getNonce:j,encrypt:h,decrypt:i,cryptobox:k,decrypt_cryptobox:l}}),c.register("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x6a\x73\x6f\x6e\x2d\x73\x63\x68\x65\x6d\x61\x2f\x66\x69\x65\x6c\x64\x2e\x6a\x73",function(a,b,c){function f(a,b,c,d,f){e.call(this,a,b,c,d,f)}var e,d=c("\x75\x74\x69\x6c");a.exports=f,e=c("\x2e\x2e\x2f\x76\x61\x6c\x69\x64\x61\x74\x6f\x72").prototype.Field,d.inherits(f,e)}),c.register("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x6a\x73\x6f\x6e\x2d\x73\x63\x68\x65\x6d\x61\x2f\x76\x61\x6c\x69\x64\x61\x74\x6f\x72\x2e\x6a\x73",function(a,b,c){function g(a){e.call(this,a)}var e,f,d=c("\x2e\x2e\x2f\x76\x61\x6c\x69\x64\x61\x74\x6f\x72\x2f\x75\x74\x69\x6c\x73");a.exports=g,e=c("\x2e\x2e\x2f\x76\x61\x6c\x69\x64\x61\x74\x6f\x72"),f=c("\x2e\x2f\x66\x69\x65\x6c\x64"),d.inherits(g,e),g.prototype.Field=g.Field=f,g.prototype.rules=g.rules={},g.addRule=e.addRule,g.fieldProperty=e.fieldProperty,g.options=d.extend({},e.options),g.validate=e.validate,g.addRule("\x74\x79\x70\x65",{validate:function(a,b){switch(a){case"\x61\x72\x72\x61\x79":return Array.isArray(b);case"\x6f\x62\x6a\x65\x63\x74":return"\x6f\x62\x6a\x65\x63\x74"==typeof b&&null!==b;case"\x6e\x75\x6c\x6c":return null===b;case"\x69\x6e\x74\x65\x67\x65\x72":a=number;default:return typeof b===a}}}),g.addRule("\x64\x65\x66\x61\x75\x6c\x74",{filter:function(a,b){return void 0===b?a:b}}),g.addRule("\x65\x6e\x75\x6d",{validate:function(a,b){return a.indexOf(b)>-1}}),g.addRule("\x6d\x69\x6e\x4c\x65\x6e\x67\x74\x68",{validate:function(a,b){return(b+"").length>=a}}),g.addRule("\x6d\x61\x78\x4c\x65\x6e\x67\x74\x68",{validate:function(a,b){return(b+"").length<=a}}),g.addRule("\x70\x61\x74\x74\x65\x72\x6e",{validate:function(a,b){return a instanceof RegExp==!1&&(a=RegExp(a)),a.test(b)}}),g.addRule("\x6d\x69\x6e\x69\x6d\x75\x6d",{validate:function(a,b,c){return c.rules.exclusiveMinimum?b>a:b>=a}}),g.addRule("\x65\x78\x63\x6c\x75\x73\x69\x76\x65\x4d\x69\x6e\x69\x6d\x75\x6d",{}),g.addRule("\x6d\x61\x78\x69\x6d\x75\x6d",{validate:function(a,b,c){return c.rules.exclusiveMaximum?a>b:a>=b}}),g.addRule("\x65\x78\x63\x6c\x75\x73\x69\x76\x65\x4d\x61\x78\x69\x6d\x75\x6d",{}),g.addRule("\x64\x69\x76\x69\x73\x69\x62\x6c\x65\x42\x79",{validate:function(a,b){return b%a===0}}),g.addRule("\x70\x72\x6f\x70\x65\x72\x74\x69\x65\x73",{validate:function(a,b,c){c.isObject()&&c.async(function(d){function i(a){null!==g&&(--g,a&&(g=null),g||d(a))}var g,h,e={},f=Object.getOwnPropertyNames(a);Object.keys(b).forEach(function(a){f.indexOf(a)<0&&f.push(a)}),g=f.length,h=c.rules.additionalProperties||!1,f.forEach(function(d){var f,g;if(a.hasOwnProperty(d)){if(!b.hasOwnProperty(d))return f=a[d],f.hasOwnProperty("\x64\x65\x66\x61\x75\x6c\x74")&&(e[d]=f["\x64\x65\x66\x61\x75\x6c\x74"]),i();f=a[d]}else{if(h===!0)return e[d]=b[d],i();if(!h)return i();f=h}g=c.child(d,b[d],f,b),g.validate(function(a,b,c){e[d]=c,i(a)})})})}}),g.addRule("\x61\x64\x64\x69\x74\x69\x6f\x6e\x61\x6c\x50\x72\x6f\x70\x65\x72\x74\x69\x65\x73",{}),g.addRule("\x6d\x69\x6e\x50\x72\x6f\x70\x65\x72\x74\x69\x65\x73",{validate:function(a,b){return Object.keys(b).length>=a}}),g.addRule("\x6d\x61\x78\x50\x72\x6f\x70\x65\x72\x74\x69\x65\x73",{validate:function(a,b){return Object.keys(b).length<=a}}),g.addRule("\x72\x65\x71\x75\x69\x72\x65\x64",{validate:function(a,b,c){a.forEach(function(a){b.hasOwnProperty(a)||c.issue({path:a,rule:"\x72\x65\x71\x75\x69\x72\x65\x64"})})}}),g.addRule("\x69\x74\x65\x6d\x73",{validate:function(a,b,c){Array.isArray(b)&&c.async(function(d){function g(a){null!==f&&(--f,a&&(f=null),f||d(a))}var e=[],f=b.length;b.forEach(function(d,f){var h=c.child(f,d,a,b);h.validate(function(a,b,c){return a?g(a):(e[f]=c,void g())})})})}}),g.addRule("\x6d\x69\x6e\x49\x74\x65\x6d\x73",{validate:function(a,b){return Array.isArray(b)&&b.length>=a}}),g.addRule("\x6d\x61\x78\x49\x74\x65\x6d\x73",{validate:function(a,b){return Array.isArray(b)&&b.length<=a}}),g.addRule("\x75\x6e\x69\x71\x75\x65\x49\x74\x65\x6d\x73",{validate:function(a,b,c){var d,e,f,g;if(a&&Array.isArray(b)){for(d=-1,e=b.length,f=[];++d<e;)g=b[d],f.indexOf(g)>-1?c.issue({path:d,rule:"\x75\x6e\x69\x71\x75\x65\x49\x74\x65\x6d\x73",accept:!0}):f.push(g);return Array.isArray(b)&&b.length>=a}}})}),c.register("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x6d\x69\x6c\x65\x73\x74\x6f\x6e\x65\x42\x6c\x6f\x63\x6b\x73\x2e\x6a\x73",function(a){a.exports={}}),c.register("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x72\x65\x71\x75\x65\x73\x74\x2d\x73\x61\x6e\x69\x74\x69\x7a\x65\x72\x2e\x6a\x73",function(a,b,c){function g(a){d.call(this,a)}function i(a){this.validator=a}function j(a,b){var c,d,e;for(b=b.slice(),d=-1,e=b.length-1;++d<e;){if(c=b[d],"\x6f\x62\x6a\x65\x63\x74"!=typeof a[c])return null;a=a[c]}return a[b[e]]}function k(a){var b={};return"\x21"===a.charAt(a.length-1)?(b.required=!0,a=a.slice(0,-1)):"\x3f"===a.charAt(a.length-1)&&(b.empty=!0,a=a.slice(0,-1)),b[a]=!0,b}var h,d=c("\x2e\x2f\x76\x61\x6c\x69\x64\x61\x74\x6f\x72\x2f\x76\x61\x6c\x69\x64\x61\x74\x6f\x72\x2e\x6a\x73"),e=c("\x65\x78\x74\x65\x6e\x64"),f=c("\x75\x74\x69\x6c").inherits;a.exports=g,f(g,d),g.prototype.rules={},e(g,d),g.options=e({reporter:i},d.options),g.addRule("\x65\x6d\x70\x74\x79",{validate:function(a,b,c){return a===!1?!c.isEmpty():void 0}}),g.addRule("\x73\x74\x72\x69\x6e\x67",{filter:function(a,b,c){return c.isEmpty()&&c.rules.empty?null:(b||"")+""}}),g.addRule("\x72\x65\x67\x65\x78\x70",{message:"\x76\x61\x6c\x75\x65\x20\x73\x68\x6f\x75\x6c\x64\x20\x6d\x61\x74\x63\x68\x20\x74\x65\x6d\x70\x6c\x61\x74\x65",validate:function(a,b){return"\x73\x74\x72\x69\x6e\x67"!=typeof b?!1:a.test(b)}}),g.addRule("\x62\x6f\x6f\x6c\x65\x61\x6e",{filter:function(a,b,c){if(c.isEmpty()&&c.rules.empty)return null;switch((b+"").toLowerCase()){case"\x66\x61\x6c\x73\x65":case"\x66":return!1;default:return!!b}}}),g.addRule("\x69\x6e\x74",{filter:function(a,b,c){return c.isEmpty()&&c.rules.empty?null:isNaN(b)||parseInt(b)!=b||isNaN(parseInt(b,10))?0:parseInt(b)}}),g.addRule("\x66\x6c\x6f\x61\x74",{filter:function(a,b,c){return c.isEmpty()&&c.rules.empty?null:(b=parseFloat(b),isNaN(b)?0:b)}}),g.addRule("\x6f\x62\x6a\x65\x63\x74",{filter:function(a,b,c){return c.isEmpty()&&c.rules.empty?null:"\x5b\x6f\x62\x6a\x65\x63\x74\x20\x4f\x62\x6a\x65\x63\x74\x5d"==Object.prototype.toString.call(b)?b:{}}}),g.addRule("\x61\x72\x72\x61\x79",{filter:function(a,b,c){return c.isEmpty()&&c.rules.empty?null:"\x73\x74\x72\x69\x6e\x67"==typeof b&&("\x73\x74\x72\x69\x6e\x67"==typeof a||a instanceof RegExp)?b.length?b.split(a):[]:Array.isArray(b)?b:[]}}),g.addRule("\x61\x72\x72\x61\x79\x4f\x66",{validate:function(a,b,c){var d,e;if(c.isEmpty()&&c.rules.empty)return null;if(!Array.isArray(b))return!1;for(d=b.length,e=-1;++e<d;)c.child(e,b[e],a,b).validate()}}),g.addRule("\x68\x65\x78",{filter:function(a,b,c){return c.isEmpty()&&c.rules.empty?null:b},validate:function(a,b,c){return c.isEmpty()&&c.rules.empty?void 0:/^([A-Fa-f0-9]{2})*$/.test((b||"")+"")}}),g.addRule("\x62\x75\x66\x66\x65\x72",{filter:function(a,b){"\x73\x74\x72\x69\x6e\x67"!=typeof a&&(a="\x75\x74\x66\x38");try{return new Buffer(b||"",a)}catch(c){return new Buffer}}}),g.addRule("\x76\x61\x72\x69\x61\x6e\x74",{filter:function(a,b,c){return c.isEmpty()&&c.rules.empty?null:void 0===b?"":b}}),g.addRule("\x72\x65\x71\x75\x69\x72\x65\x64",{message:"\x76\x61\x6c\x75\x65\x20\x69\x73\x20\x72\x65\x71\x75\x69\x72\x65\x64",validate:function(a,b){return void 0!==b==a}}),g.addRule("\x64\x65\x66\x61\x75\x6c\x74",{filter:function(a,b){return void 0===b?a:b}}),g.addRule("\x70\x72\x6f\x70\x65\x72\x74\x69\x65\x73",{validate:function(a,b,c){return c.isObject()?void Object.getOwnPropertyNames(a).forEach(function(d){var f,e=a[d];"\x73\x74\x72\x69\x6e\x67"==typeof e&&(e=k(e)),f=c.child(d,b[d],e,b),f.validate(function(a,c,e){if(a)throw a;b[d]=e})}):!1}}),g.addRule("\x6d\x69\x6e\x4c\x65\x6e\x67\x74\x68",{message:"\x6d\x69\x6e\x69\x6d\x75\x6d\x20\x6c\x65\x6e\x67\x74\x68\x20\x69\x73\x20\x24\x7b\x61\x63\x63\x65\x70\x74\x7d\x2e",validate:function(a,b){return b.length>=a}}),g.addRule("\x6d\x61\x78\x4c\x65\x6e\x67\x74\x68",{message:"\x6d\x61\x78\x69\x6d\x75\x6d\x20\x6c\x65\x6e\x67\x74\x68\x20\x69\x73\x20\x24\x7b\x61\x63\x63\x65\x70\x74\x7d\x2e",validate:function(a,b){return b.length<=a}}),g.addRule("\x6d\x61\x78\x42\x79\x74\x65\x4c\x65\x6e\x67\x74\x68",{message:"\x6d\x61\x78\x69\x6d\x75\x6d\x20\x73\x69\x7a\x65\x20\x69\x73\x20\x24\x7b\x61\x63\x63\x65\x70\x74\x2e\x6c\x65\x6e\x67\x74\x68\x7d\x20\x62\x79\x74\x65\x73",accept:function(a){return"\x6f\x62\x6a\x65\x63\x74"!=typeof a&&(a={encoding:"\x75\x74\x66\x38",length:a}),a},validate:function(a,b,c){return c.isEmpty()&&c.rules.empty?void 0:("\x6f\x62\x6a\x65\x63\x74"==typeof b&&null!==b&&(b=JSON.stringify(b)),Buffer.byteLength(b,"\x75\x74\x66\x38")<=a.length)}}),g.addRule("\x6d\x69\x6e\x42\x79\x74\x65\x4c\x65\x6e\x67\x74\x68",{message:"\x6d\x69\x6e\x69\x6d\x75\x6d\x20\x73\x69\x7a\x65\x20\x69\x73\x20\x24\x7b\x61\x63\x63\x65\x70\x74\x2e\x6c\x65\x6e\x67\x74\x68\x7d\x20\x62\x79\x74\x65\x73",accept:function(a){return"\x6f\x62\x6a\x65\x63\x74"!=typeof a&&(a={encoding:"\x75\x74\x66\x38",length:a}),a},validate:function(a,b,c){return c.isEmpty()&&c.rules.empty?void 0:("\x6f\x62\x6a\x65\x63\x74"==typeof b&&null!==b&&(b=JSON.stringify(b)),Buffer.byteLength(b,"\x75\x74\x66\x38")>=a.length)}}),g.express=function(a){return a=e({},g.options,a),function(b,c,d){function e(c,d,e){var f={};return"\x73\x74\x72\x69\x6e\x67"==typeof c&&(c=b[c]||{}),Object.getOwnPropertyNames(d).forEach(function(a){f[a]=c.hasOwnProperty(a)?c[a]:void 0,"\x73\x74\x72\x69\x6e\x67"==typeof d[a]&&(d[a]=k(d[a]))}),new g(a).validate(f,{properties:d},e)}b.sanitize=e,d()}},h=g.prototype.rules,["\x73\x74\x72\x69\x6e\x67","\x62\x6f\x6f\x6c\x65\x61\x6e","\x69\x6e\x74","\x66\x6c\x6f\x61\x74","\x76\x61\x72\x69\x61\x6e\x74","\x61\x72\x72\x61\x79","\x6f\x62\x6a\x65\x63\x74","\x68\x65\x78","\x62\x75\x66\x66\x65\x72"].forEach(function(a){var b=h[a];"\x66\x75\x6e\x63\x74\x69\x6f\x6e"==typeof b.filter&&(a in g||(g[a]=function(b,d){var h,i,f={};if("\x6f\x62\x6a\x65\x63\x74"==typeof d?e(f,d):void 0!==d&&(f.empty=d),f[a]=!0,h=new g(g.options).validate(b,f),!h.isValid)throw i=Error(h.issues),i.name="\x56\x61\x6c\x69\x64\x61\x74\x69\x6f\x6e\x45\x72\x72\x6f\x72",i.issues=h.issues,i;return h.value}))}),g.options.reporter=i,i.prototype.format=function(a,b){return(a+"").replace(/\$\{([^}]+)}/g,function(a,c){return j(b,c.split("\x2e"))||""})},i.prototype.convert=function(a){var b=this,c=a.reduce(function(a,b){var c=b.path.join("\x2e");return c in a==!1&&(a[c]=[]),a[c].push(b),a},{}),d="";return Object.getOwnPropertyNames(c).forEach(function(a){d+="\x50\x72\x6f\x70\x65\x72\x74\x79\x20\x22"+a+"\x22\x3a\n",c[a].forEach(function(a){var c=b.validator.getRule(a.rule);d+="\t\x2d\x20",d+=c.hasOwnProperty("\x6d\x65\x73\x73\x61\x67\x65")?b.format(c.message,a)+"\n":"\x62\x72\x65\x61\x6b\x20\x72\x75\x6c\x65\x20\x22"+a.rule+"\x22\n"})}),d}}),c.register("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x72\x6f\x75\x74\x65\x72\x2e\x6a\x73",function(a,b,c){function e(a,b){var c=this;Object.keys(b).forEach(function(e){var f=e.split("\x20");if(2!=f.length||-1==["\x70\x6f\x73\x74","\x67\x65\x74","\x70\x75\x74"].indexOf(f[0]))throw Error("\x77\x72\x6f\x6e\x67\x20\x6d\x61\x70\x20\x63\x6f\x6e\x66\x69\x67");c[f[0]](f[1],function(c,g){a[b[e]]({body:"\x67\x65\x74"==f[0]?c.query:c.body},function(a,b){return a?void g.json({success:!1,error:a}):g.json(d({},{success:!0},b))})})})}var d=c("\x65\x78\x74\x65\x6e\x64"),f=function(){var a=c("\x65\x78\x70\x72\x65\x73\x73").Router();return a.use(function(a,b,c){b.header("\x41\x63\x63\x65\x73\x73\x2d\x43\x6f\x6e\x74\x72\x6f\x6c\x2d\x41\x6c\x6c\x6f\x77\x2d\x4f\x72\x69\x67\x69\x6e","\x2a"),b.header("\x41\x63\x63\x65\x73\x73\x2d\x43\x6f\x6e\x74\x72\x6f\x6c\x2d\x41\x6c\x6c\x6f\x77\x2d\x48\x65\x61\x64\x65\x72\x73","\x4f\x72\x69\x67\x69\x6e\x2c\x20\x58\x2d\x52\x65\x71\x75\x65\x73\x74\x65\x64\x2d\x57\x69\x74\x68\x2c\x20\x43\x6f\x6e\x74\x65\x6e\x74\x2d\x54\x79\x70\x65\x2c\x20\x41\x63\x63\x65\x70\x74"),c()}),a.map=e,a};a.exports=f}),c.register("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x61\x6e\x64\x62\x6f\x78\x2e\x6a\x73",function(a){function d(a,b,c,d){if("\x66\x75\x6e\x63\x74\x69\x6f\x6e"!=typeof a[b])return d("\x46\x75\x6e\x63\x74\x69\x6f\x6e\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64\x20\x69\x6e\x20\x6d\x6f\x64\x75\x6c\x65\x3a\x20"+b);var e=[c,d];a[b].apply(null,e)}a.exports={callMethod:d}}),c.register("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x65\x71\x75\x65\x6e\x63\x65\x2e\x6a\x73",function(a,b,c){function f(a){var c,b={onWarning:null,warningLimit:50};b=e(b,a),c=this,this.sequence=[],setImmediate(function d(){b.onWarning&&c.sequence.length>=b.warningLimit&&b.onWarning(c.sequence.length,b.warningLimit),c.__tick(function(){setTimeout(d,3)})})}var d=c("\x75\x74\x69\x6c"),e=c("\x65\x78\x74\x65\x6e\x64");f.prototype.__tick=function(a){var c,b=this.sequence.shift();return b?(c=[function(c,d){b.done&&setImmediate(b.done,c,d),setImmediate(a)}],b.args&&(c=c.concat(b.args)),void b.worker.apply(b.worker,c)):setImmediate(a)},f.prototype.add=function(a,b,c){if(!c&&b&&"\x66\x75\x6e\x63\x74\x69\x6f\x6e"==typeof b&&(c=b,b=void 0),a&&"\x66\x75\x6e\x63\x74\x69\x6f\x6e"==typeof a){var e={worker:a,done:c};d.isArray(b)&&(e.args=b),this.sequence.push(e)}},f.prototype.count=function(){return this.sequence.length},a.exports=f}),c.register("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x6c\x6f\x74\x73\x2e\x6a\x73",function(a){function d(){var a=new Date(Date.UTC(2015,3,9,0,0,0,0));return a}function e(a){var b,c;return void 0===a&&(a=(new Date).getTime()),b=d(),c=b.getTime(),Math.floor((a-c)/1e3)}a.exports={interval:10,delegates:101,getTime:function(a){return e(a)},getRealTime:function(a){var b,c;return void 0===a&&(a=this.getTime()),b=d(),c=1e3*Math.floor(b.getTime()/1e3),c+1e3*a},getSlotNumber:function(a){return void 0===a&&(a=this.getTime()),Math.floor(a/this.interval)},getSlotTime:function(a){return a*this.interval},getNextSlot:function(){var a=this.getSlotNumber();return a+1},getLastSlot:function(a){return a+this.delegates},roundTime:function(a){1e3*Math.floor(a.getTime()/1e3)}}}),c.register("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x2d\x74\x79\x70\x65\x73\x2e\x6a\x73",function(a){a.exports={SEND:0,SIGNATURE:1,DELEGATE:2,VOTE:3,USERNAME:4,FOLLOW:5,MESSAGE:6,AVATAR:7,MULTI:8,DAPP:9,IN_TRANSFER:10,OUT_TRANSFER:11}}),c.register("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x76\x61\x6c\x69\x64\x61\x74\x6f\x72\x2f\x66\x69\x65\x6c\x64\x2e\x6a\x73",function(a){function d(a,b,c,d,e){this.isAsync=!1,this.hasError=!1,this.rules=d,this.value=c,this.report=[],this.path=b||[],this.thisArg=e||null,this._stack=Object.keys(d),this.validator=a,this.inProgress=!1}a.exports=d,d.prototype.child=function(a,b,c,d){var e=this.validator.createField(this.path.concat(a),b,c,d);return e.report=this.report,e},d.prototype.validate=function(a){var e,f,g,h,i,b=this._stack,c=this.report,d=this.thisArg;for(this.inProgress=!0,"\x66\x75\x6e\x63\x74\x69\x6f\x6e"==typeof a?(this.callback=a,this.hasCallback=!0):(this.callback=null,this.hasCallback=!1);b.length;){i=b.shift(),h=this.value,g=this.rules[i];try{if(!this.validator.hasRule(i)&&!this.validator.skipMissed)throw Error("\x52\x75\x6c\x65\x20\x22"+i+"\x22\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64\x20\x66\x6f\x72\x20\x22"+this.path.join("\x2e")+"\x22\x2e");if(e=this.validator.getRule(i),this.validator.execRules&&"\x66\x75\x6e\x63\x74\x69\x6f\x6e"==typeof g&&(g=g.call(d,h)),e.accept&&(g=e.accept.call(d,g,h,this)),e.filter&&(h=this.value=e.filter.call(d,g,h,this)),e.validate&&(f=e.validate.call(d,g,h,this)),this.isAsync)return;f===!1&&(c.push({path:this.path,rule:i,accept:g}),this.hasError=!0,b.length=0)}catch(j){return j.field||Object.defineProperty(j,"\x66\x69\x65\x6c\x64",{enumerable:!1,value:this}),this.validator.onError(this,j),void this.end(j,c,h)}}this.inProgress=!1,b.length||this.end(null,c,h)},d.prototype.end=function(a){this._stack=[],this.hasError?this.validator.onInvalid(this):this.validator.onValid(this),this.hasCallback&&(this.callback(a,this.report,this.value),this.callback=null)},d.prototype.async=function(a){this.isAsync=!0;var b=this;a(function(a){arguments.length>1&&(b.value=arguments[1]),b.isAsync=!1,a?(a.hasOwnProperty("\x66\x69\x65\x6c\x64")||(Object.defineProperty(a,"\x66\x69\x65\x6c\x64",{enumerable:!1,value:b}),b.validator.onError(b,a)),b.end(a)):b.inProgress||b.validate(b.callback)})},d.prototype.issue=function(a){this.hasError=!0,a.path=this.path.concat(a.path),this.report.push(a)}}),c.register("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x76\x61\x6c\x69\x64\x61\x74\x6f\x72\x2f\x75\x74\x69\x6c\x73\x2e\x6a\x73",function(a,b,c){function e(a){return a&&"\x6f\x62\x6a\x65\x63\x74"==typeof a?(Array.prototype.slice.call(arguments).forEach(function(b){b&&"\x6f\x62\x6a\x65\x63\x74"==typeof b&&d._extend(a,b)}),a):a}function f(a){if(!a||"\x6f\x62\x6a\x65\x63\x74"!=typeof a)return a;if(Array.isArray(a))return a.map(f);if(a.constructor===Object){var b={};return Object.getOwnPropertyNames(a).forEach(function(c){b[c]=f(a[c])}),b}return a}var d=c("\x75\x74\x69\x6c");b.extend=e,b.copy=f,b.inherits=d.inherits}),c.register("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x76\x61\x6c\x69\x64\x61\x74\x6f\x72\x2f\x76\x61\x6c\x69\x64\x61\x74\x6f\x72\x2e\x6a\x73",function(a,b,c){function g(a){a=a||{},this.hasError=!1,this.forceAsync=this.forceAsync||a.forceAsync,this.skipMissed=this.skipMissed||a.skipMissed,this.execRules=this.execRules||a.execRules,this.rules=e(Object.create(this.rules),a.rules);var b=this.reporter||a.reporter;"\x66\x75\x6e\x63\x74\x69\x6f\x6e"==typeof b&&(b=new b(this)),this.reporter=b,this.onInit()}var d=c("\x2e\x2f\x75\x74\x69\x6c\x73\x2e\x6a\x73"),e=d.extend,f=c("\x2e\x2f\x66\x69\x65\x6c\x64\x2e\x6a\x73");a.exports=g,b.Field=f,g.prototype.forceAsync=!1,g.prototype.skipMissed=!1,g.prototype.execRules=!0,g.prototype.reporter=null,g.prototype.hasRule=function(a){return a in this.rules},g.prototype.getRule=function(a){if(a in this.rules==!1)throw Error("\x52\x75\x6c\x65\x20\x22"+a+"\x22\x20\x64\x6f\x65\x73\x6e\x27\x74\x20\x64\x65\x66\x69\x6e\x65\x64");return this.rules[a]},g.prototype.validate=function(a,b,c){function i(a,e,i){if(g=!0,h.isValid=!e.length,d.reporter&&(e=d.reporter.convert(e,b)),h.isAsync=f,h.issues=e,h.rules=b,h.value=i,c)!f&&c&&d.forceAsync?setTimeout(function(){d.onEnd(),c.call(d,a,h,i)},1):(d.onEnd(),c.call(d,a,h,i));else{if(a)throw a;if(f)throw Error("\x41\x73\x79\x6e\x63\x20\x76\x61\x6c\x69\x64\x61\x74\x69\x6f\x6e\x20\x77\x69\x74\x68\x6f\x75\x74\x20\x63\x61\x6c\x6c\x62\x61\x63\x6b")}}var g,d=this,e=this.createField(null,a,b),h={},f=!1;if(e.validate(i),f=!0,!c&&!g)throw Error("\x56\x61\x6c\x69\x64\x61\x74\x69\x6f\x6e\x20\x6e\x6f\x74\x20\x66\x69\x6e\x69\x73\x68\x65\x64");return h},g.prototype.Field=f,g.prototype.createField=function(a,b,c,d){return new this.Field(this,a,b,c,d)},g.prototype.rules={},g.prototype.onInit=function(){},g.prototype.onError=function(){},g.prototype.onValid=function(){},g.prototype.onInvalid=function(){},g.prototype.onEnd=function(){},g.addRule=function(a,b){if("\x6f\x62\x6a\x65\x63\x74"!=typeof b)throw Error("\x52\x75\x6c\x65\x20\x64\x65\x73\x63\x72\x69\x70\x74\x6f\x72\x20\x73\x68\x6f\x75\x6c\x64\x20\x62\x65\x20\x61\x6e\x20\x6f\x62\x6a\x65\x63\x74");var c=this;this.prototype.rules[a]=b,b.hasOwnProperty("\x61\x6c\x69\x61\x73\x65\x73")&&b.aliases.forEach(function(b){c.addAlias(b,a)})},g.addAlias=function(a,b){Object.defineProperty(this.prototype.rules,a,{get:function(){return this[b]}})},g.fieldProperty=function(a,b){this.prototype.Field.prototype[a]=b},g.options={forceAsync:!1,skipMissed:!1,execRules:!0,reporter:null},g.validate=function(a,b,c,d){"\x66\x75\x6e\x63\x74\x69\x6f\x6e"==typeof c&&(d=c,c={});var f=new this(e({},this.options,{rules:c}));return f.validate(a,b,d)},g.addRule("\x64\x65\x66\x61\x75\x6c\x74\x73",{description:"\x53\x65\x74\x20\x64\x65\x66\x61\x75\x6c\x74\x20\x76\x61\x6c\x75\x65\x20\x69\x66\x20\x70\x61\x73\x73\x65\x64\x20\x76\x61\x6c\x75\x65\x20\x69\x73\x20\x75\x6e\x64\x65\x66\x69\x6e\x65\x64",filter:function(a,b){return void 0===b?a:b}}),g.addRule("\x74\x79\x70\x65",{description:"\x43\x68\x65\x63\x6b\x20\x76\x61\x6c\x75\x65\x20\x74\x79\x70\x65",validate:function(a,b){return typeof b===a}}),g.addRule("\x65\x71\x75\x61\x6c",{description:"\x43\x68\x65\x63\x6b\x20\x69\x66\x20\x76\x61\x6c\x75\x65\x20\x65\x71\x75\x61\x6c\x73\x20\x61\x63\x63\x65\x70\x74\x61\x62\x6c\x65\x20\x76\x61\x6c\x75\x65",validate:function(a,b){return b===a}}),g.addRule("\x6e\x6f\x74\x45\x71\x75\x61\x6c",{description:"\x43\x68\x65\x63\x6b\x20\x69\x66\x20\x76\x61\x6c\x75\x65\x20\x6e\x6f\x74\x20\x65\x71\x75\x61\x6c\x73\x20\x61\x63\x63\x65\x70\x74\x61\x62\x6c\x65\x20\x76\x61\x6c\x75\x65",validate:function(a,b){return typeof b!==a}}),g.addRule("\x67\x72\x65\x61\x74\x65\x72",{description:"\x43\x68\x65\x63\x6b\x20\x69\x66\x20\x76\x61\x6c\x75\x65\x20\x69\x73\x20\x67\x72\x65\x61\x74\x65\x72\x20\x74\x68\x65\x6e\x20\x61\x63\x63\x65\x70\x74\x61\x62\x6c\x65\x20\x76\x61\x6c\x75\x65",aliases:["\x3e","\x67\x74"],validate:function(a,b){return typeof b>a}}),g.addRule("\x67\x72\x65\x61\x74\x65\x72\x4f\x72\x45\x71\x75\x61\x6c",{description:"\x43\x68\x65\x63\x6b\x20\x69\x66\x20\x76\x61\x6c\x75\x65\x20\x69\x73\x20\x67\x72\x65\x61\x74\x65\x72\x20\x74\x68\x65\x6e\x20\x6f\x72\x20\x65\x71\x75\x61\x6c\x20\x61\x63\x63\x65\x70\x74\x61\x62\x6c\x65\x20\x76\x61\x6c\x75\x65",aliases:["\x3e\x3d","\x67\x74\x65"],validate:function(a,b){return typeof b>=a}}),g.addRule("\x6c\x65\x73\x73",{description:"\x43\x68\x65\x63\x6b\x20\x69\x66\x20\x76\x61\x6c\x75\x65\x20\x69\x73\x20\x6c\x65\x73\x73\x20\x74\x68\x65\x6e\x20\x61\x63\x63\x65\x70\x74\x61\x62\x6c\x65\x20\x76\x61\x6c\x75\x65",aliases:["\x3c","\x6c\x74"],validate:function(a,b){return a>typeof b}}),g.addRule("\x6c\x65\x73\x73\x4f\x72\x45\x71\x75\x61\x6c",{description:"\x43\x68\x65\x63\x6b\x20\x69\x66\x20\x76\x61\x6c\x75\x65\x20\x69\x73\x20\x6c\x65\x73\x73\x20\x74\x68\x65\x6e\x20\x6f\x72\x20\x65\x71\x75\x61\x6c\x20\x61\x63\x63\x65\x70\x74\x61\x62\x6c\x65\x20\x76\x61\x6c\x75\x65",aliases:["\x3c\x3d","\x6c\x74\x65"],validate:function(a,b){return a>=typeof b}}),g.fieldProperty("\x69\x73\x4f\x62\x6a\x65\x63\x74",function(){return null!==this.value&&"\x6f\x62\x6a\x65\x63\x74"==typeof this.value}),g.fieldProperty("\x69\x73\x4f\x62\x6a\x65\x63\x74\x49\x6e\x73\x74\x61\x6e\x63\x65",function(){return this.value&&"\x6f\x62\x6a\x65\x63\x74"==typeof this.value&&this.value.constructor===Object}),g.fieldProperty("\x69\x73\x44\x65\x66\x61\x75\x6c\x74",function(){return this.value===this.rules.defaults}),g.fieldProperty("\x69\x73\x55\x6e\x64\x65\x66\x69\x6e\x65\x64",function(){return void 0===this.value}),g.fieldProperty("\x69\x73\x45\x6d\x70\x74\x79",function(){return void 0===this.value||null===this.value||""===this.value})}),c.register("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x7a\x73\x63\x68\x65\x6d\x65\x2d\x65\x78\x70\x72\x65\x73\x73\x2e\x6a\x73",function(a){a.exports=function(a){return function(b,c,d){function e(b,c,d){return a.validate(b,c,function(a,c){return d(null,{isValid:c,issues:a?a[0].message+"\x3a\x20"+a[0].path:null},b)})}b.sanitize=e,d()}}}),c.register("\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x61\x63\x63\x6f\x75\x6e\x74\x73\x2e\x6a\x73",function(a,b,c){function t(){this.create=function(a,b){return b.recipientId=a.sender.address,b.recipientUsername=a.sender.username,b.asset.votes=a.votes,b},this.calculateFee=function(){return 1*j.fixedPoint},this.verify=function(a,b,c){return a.recipientId!=a.senderId?setImmediate(c,"\x52\x65\x63\x69\x70\x69\x65\x6e\x74\x20\x69\x73\x20\x69\x64\x65\x6e\x74\x69\x63\x61\x6c\x20\x74\x6f\x20\x73\x65\x6e\x64\x65\x72"):a.asset.votes&&a.asset.votes.length?a.asset.votes&&a.asset.votes.length>33?setImmediate(c,"\x56\x6f\x74\x69\x6e\x67\x20\x6c\x69\x6d\x69\x74\x65\x64\x20\x65\x78\x63\x65\x65\x64\x65\x64\x2e\x20\x4d\x61\x78\x6d\x69\x75\x6d\x20\x69\x73\x20\x33\x33\x20\x70\x65\x72\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e"):void o.delegates.checkDelegates(a.senderPublicKey,a.asset.votes,function(b){setImmediate(c,b,a)}):setImmediate(c,"\x4e\x6f\x74\x20\x65\x6e\x6f\x75\x67\x68\x20\x73\x70\x61\x72\x65\x20\x76\x6f\x74\x65\x73\x20\x61\x76\x61\x69\x6c\x61\x62\x6c\x65")},this.process=function(a,b,c){setImmediate(c,null,a)},this.getBytes=function(a){try{var b=a.asset.votes?new Buffer(a.asset.votes.join(""),"\x75\x74\x66\x38"):null}catch(c){throw Error(""+c)}return b},this.apply=function(a,b,c,d){this.scope.account.merge(c.address,{delegates:a.asset.votes,blockId:b.id,round:o.round.calc(b.height)},function(a){d(a)})},this.undo=function(a,b,c,d){if(null===a.asset.votes)return d();var e=l.reverse(a.asset.votes);this.scope.account.merge(c.address,{delegates:e,blockId:b.id,round:o.round.calc(b.height)},function(a){d(a)})},this.applyUnconfirmed=function(a,b,c){o.delegates.checkUnconfirmedDelegates(a.senderPublicKey,a.asset.votes,function(d){return d?setImmediate(c,d):void this.scope.account.merge(b.address,{u_delegates:a.asset.votes},function(a){c(a)})}.bind(this))},this.undoUnconfirmed=function(a,b,c){if(null===a.asset.votes)return c();var d=l.reverse(a.asset.votes);this.scope.account.merge(b.address,{u_delegates:d},function(a){c(a)})},this.objectNormalize=function(a){var b=p.scheme.validate(a.asset,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{votes:{type:"\x61\x72\x72\x61\x79",minLength:1,maxLength:105,uniqueItems:!0}},required:["\x76\x6f\x74\x65\x73"]});if(!b)throw Error("\x49\x6e\x63\x6f\x72\x72\x65\x63\x74\x20\x76\x6f\x74\x65\x73\x20\x69\x6e\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73\x3a\x20"+p.scheme.getLastError());return a},this.dbRead=function(a){if(a.v_votes){var b=a.v_votes.split("\x2c");return{votes:b}}return null},this.dbSave=function(a,b){p.dbLite.query("\x49\x4e\x53\x45\x52\x54\x20\x49\x4e\x54\x4f\x20\x76\x6f\x74\x65\x73\x28\x76\x6f\x74\x65\x73\x2c\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29\x20\x56\x41\x4c\x55\x45\x53\x28\x24\x76\x6f\x74\x65\x73\x2c\x20\x24\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29",{votes:i.isArray(a.asset.votes)?a.asset.votes.join("\x2c"):null,transactionId:a.id},b)},this.ready=function(a,b){return b.multisignatures.length?a.signatures?a.signatures.length>=b.multimin-1:!1:!0}}function u(){this.create=function(a,b){return b.recipientId=null,b.amount=0,b.asset.username={alias:a.username,publicKey:a.sender.publicKey},b},this.calculateFee=function(){return 100*j.fixedPoint},this.verify=function(a,b,c){var d,e;return a.recipientId?setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x72\x65\x63\x69\x70\x69\x65\x6e\x74"):0!=a.amount?setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x61\x6d\x6f\x75\x6e\x74"):a.asset.username.alias?(d=/^[a-z0-9!@$&_.]+$/g,d.test(a.asset.username.alias.toLowerCase())?(e=/^[0-9]+[L|l]$/g,e.test(a.asset.username.alias.toLowerCase())?setImmediate(c,"\x55\x73\x65\x72\x6e\x61\x6d\x65\x20\x63\x61\x6e\x6e\x6f\x74\x20\x62\x65\x20\x61\x20\x70\x6f\x74\x65\x6e\x74\x69\x61\x6c\x20\x61\x64\x64\x72\x65\x73\x73"):0==a.asset.username.alias.length||a.asset.username.alias.length>20?setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x75\x73\x65\x72\x6e\x61\x6d\x65\x20\x6c\x65\x6e\x67\x74\x68\x2e\x20\x4d\x75\x73\x74\x20\x62\x65\x20\x62\x65\x74\x77\x65\x65\x6e\x20\x31\x20\x74\x6f\x20\x32\x30\x20\x63\x68\x61\x72\x61\x63\x74\x65\x72\x73"):void q.getAccount({$or:{username:a.asset.username.alias,u_username:a.asset.username.alias}},function(d,e){return d?c(d):e&&e.username==a.asset.username.alias?c("\x55\x73\x65\x72\x6e\x61\x6d\x65\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x65\x78\x69\x73\x74\x73"):b.username&&b.username!=a.asset.username.alias?c("\x49\x6e\x76\x61\x6c\x69\x64\x20\x75\x73\x65\x72\x6e\x61\x6d\x65\x2e\x20\x44\x6f\x65\x73\x20\x6e\x6f\x74\x20\x6d\x61\x74\x63\x68\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x61\x73\x73\x65\x74"):b.u_username&&b.u_username!=a.asset.username.alias?c("\x41\x63\x63\x6f\x75\x6e\x74\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x68\x61\x73\x20\x61\x20\x75\x73\x65\x72\x6e\x61\x6d\x65"):void c(null,a)})):setImmediate(c,"\x55\x73\x65\x72\x6e\x61\x6d\x65\x20\x6d\x75\x73\x74\x20\x6f\x6e\x6c\x79\x20\x63\x6f\x6e\x74\x61\x69\x6e\x20\x61\x6c\x70\x68\x61\x6e\x75\x6d\x65\x72\x69\x63\x20\x63\x68\x61\x72\x61\x63\x74\x65\x72\x73\x20\x28\x77\x69\x74\x68\x20\x74\x68\x65\x20\x65\x78\x63\x65\x70\x74\x69\x6f\x6e\x20\x6f\x66\x20\x21\x40\x24\x26\x5f\x29")):setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x61\x73\x73\x65\x74")},this.process=function(a,b,c){setImmediate(c,null,a)},this.getBytes=function(a){try{var b=new Buffer(a.asset.username.alias,"\x75\x74\x66\x38")}catch(c){throw Error(""+c)}return b},this.apply=function(a,b,c,d){q.setAccountAndGet({address:c.address,u_username:null,username:a.asset.username.alias,nameexist:1,u_nameexist:0},d)},this.undo=function(a,b,c,d){q.setAccountAndGet({address:c.address,username:null,u_username:a.asset.username.alias,nameexist:0,u_nameexist:1},d)},this.applyUnconfirmed=function(a,b,c){if(b.username||b.u_username)return setImmediate(c,"\x41\x63\x63\x6f\x75\x6e\x74\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x68\x61\x73\x20\x61\x20\x75\x73\x65\x72\x6e\x61\x6d\x65");var d=o.accounts.generateAddressByPublicKey(a.senderPublicKey);q.getAccount({$or:{u_username:a.asset.username.alias,address:d}},function(d,e){return d?c(d):e&&e.u_username?c("\x55\x73\x65\x72\x6e\x61\x6d\x65\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x65\x78\x69\x73\x74\x73"):void q.setAccountAndGet({address:b.address,u_username:a.asset.username.alias,u_nameexist:1},c)})},this.undoUnconfirmed=function(a,b,c){q.setAccountAndGet({address:b.address,u_username:null,u_nameexist:0},c)},this.objectNormalize=function(a){var b=p.scheme.validate(a.asset.username,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{alias:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:20},publicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"}},required:["\x61\x6c\x69\x61\x73","\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"]});if(!b)throw Error(p.scheme.getLastError());return a},this.dbRead=function(a){if(a.u_alias){var b={alias:a.u_alias,publicKey:a.t_senderPublicKey};return{username:b}}
return null},this.dbSave=function(a,b){p.dbLite.query("\x49\x4e\x53\x45\x52\x54\x20\x49\x4e\x54\x4f\x20\x75\x73\x65\x72\x6e\x61\x6d\x65\x73\x28\x75\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29\x20\x56\x41\x4c\x55\x45\x53\x28\x24\x75\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x24\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29",{username:a.asset.username.alias,transactionId:a.id},b)},this.ready=function(a,b){return b.multisignatures.length?a.signatures?a.signatures.length>=b.multimin-1:!1:!0}}function v(a,b){p=b,q=this,q.__private=r,r.attachApi(),p.logic.transaction.attachAssetType(k.VOTE,new t),p.logic.transaction.attachAssetType(k.USERNAME,new u),setImmediate(a,null,q)}var m,n,o,p,q,r,s,d=c("\x63\x72\x79\x70\x74\x6f"),e=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x62\x69\x67\x6e\x75\x6d\x2e\x6a\x73"),f=c("\x65\x64\x32\x35\x35\x31\x39"),g=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x6c\x6f\x74\x73\x2e\x6a\x73"),h=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x72\x6f\x75\x74\x65\x72\x2e\x6a\x73"),i=c("\x75\x74\x69\x6c"),j=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x63\x6f\x6e\x73\x74\x61\x6e\x74\x73\x2e\x6a\x73"),k=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x2d\x74\x79\x70\x65\x73\x2e\x6a\x73"),l=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x64\x69\x66\x66\x2e\x6a\x73");i=c("\x75\x74\x69\x6c"),m=c("\x65\x78\x74\x65\x6e\x64"),n=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x61\x6e\x64\x62\x6f\x78\x2e\x6a\x73"),r={},s={},r.attachApi=function(){var a=new h;a.use(function(a,b,c){return o?c():void b.status(500).send({success:!1,error:"\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x69\x73\x20\x6c\x6f\x61\x64\x69\x6e\x67"})}),a.map(s,{"post /open":"\x6f\x70\x65\x6e","get /getBalance":"\x67\x65\x74\x42\x61\x6c\x61\x6e\x63\x65","get /getPublicKey":"\x67\x65\x74\x50\x75\x62\x6c\x69\x63\x6b\x65\x79","post /generatePublicKey":"\x67\x65\x6e\x65\x72\x61\x74\x65\x50\x75\x62\x6c\x69\x63\x6b\x65\x79","get /delegates":"\x67\x65\x74\x44\x65\x6c\x65\x67\x61\x74\x65\x73","get /delegates/fee":"\x67\x65\x74\x44\x65\x6c\x65\x67\x61\x74\x65\x73\x46\x65\x65","put /delegates":"\x61\x64\x64\x44\x65\x6c\x65\x67\x61\x74\x65\x73","get /username/get":"\x67\x65\x74\x55\x73\x65\x72\x6e\x61\x6d\x65","get /username/fee":"\x67\x65\x74\x55\x73\x65\x72\x6e\x61\x6d\x65\x46\x65\x65","put /username":"\x61\x64\x64\x55\x73\x65\x72\x6e\x61\x6d\x65","get /":"\x67\x65\x74\x41\x63\x63\x6f\x75\x6e\x74"}),process.env.DEBUG&&"\x54\x52\x55\x45"==process.env.DEBUG.toUpperCase()&&a.get("\x2f\x67\x65\x74\x41\x6c\x6c\x41\x63\x63\x6f\x75\x6e\x74\x73",function(a,b){return b.json({success:!0,accounts:r.accounts})}),process.env.TOP&&"\x54\x52\x55\x45"==process.env.TOP.toUpperCase()&&a.get("\x2f\x74\x6f\x70",function(a,b,c){a.sanitize(a.query,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{limit:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:100},offset:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0}}},function(a,d,e){return a?c(a):d.isValid?void q.getAccounts({sort:{balance:-1},offset:e.offset,limit:e.limit},function(a,c){if(a)return b.json({success:!1,error:""+a});var d=c.map(function(a){return{address:a.address,username:a.username,balance:a.balance,publicKey:a.publicKey}});b.json({success:!0,accounts:d})}):b.json({success:!1,error:d.issues})})}),a.get("\x2f\x63\x6f\x75\x6e\x74",function(a,b){return b.json({success:!0,count:Object.keys(r.accounts).length})}),a.use(function(a,b){b.status(500).send({success:!1,error:"\x41\x50\x49\x20\x65\x6e\x64\x70\x6f\x69\x6e\x74\x20\x77\x61\x73\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64"})}),p.network.app.use("\x2f\x61\x70\x69\x2f\x61\x63\x63\x6f\x75\x6e\x74\x73",a),p.network.app.use(function(a,b,c,d){return a?(p.logger.error(b.url,""+a),void c.status(500).send({success:!1,error:""+a})):d()})},r.openAccount=function(a,b){var c=d.createHash("\x73\x68\x61\x32\x35\x36").update(a,"\x75\x74\x66\x38").digest(),e=f.MakeKeypair(c);q.setAccountAndGet({publicKey:e.publicKey.toString("\x68\x65\x78")},b)},v.prototype.generateAddressByPublicKey=function(a){var f,g,b=d.createHash("\x73\x68\x61\x32\x35\x36").update(a,"\x68\x65\x78").digest(),c=new Buffer(8);for(f=0;8>f;f++)c[f]=b[7-f];if(g=""+e.fromBuffer(c)+"\x4c",!g)throw Error("\x77\x72\x6f\x6e\x67\x20\x70\x75\x62\x6c\x69\x63\x4b\x65\x79\x20"+a);return g},v.prototype.getAccount=function(a,b,c){a.publicKey&&(a.address=q.generateAddressByPublicKey(a.publicKey),delete a.publicKey),p.logic.account.get(a,b,c)},v.prototype.getAccounts=function(a,b,c){p.logic.account.getAll(a,b,c)},v.prototype.setAccountAndGet=function(a,b){var c=a.address||null;if(null===c){if(!a.publicKey)return b("\x4d\x69\x73\x73\x69\x6e\x67\x20\x61\x64\x64\x72\x65\x73\x73\x20\x6f\x72\x20\x70\x75\x62\x6c\x69\x63\x20\x6b\x65\x79");c=q.generateAddressByPublicKey(a.publicKey)}if(!c)throw b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x75\x62\x6c\x69\x63\x20\x6b\x65\x79");p.logic.account.set(c,a,function(a){return a?b(a):void p.logic.account.get({address:c},b)})},v.prototype.mergeAccountAndGet=function(a,b){var c=a.address||null;if(null===c){if(!a.publicKey)return b("\x4d\x69\x73\x73\x69\x6e\x67\x20\x61\x64\x64\x72\x65\x73\x73\x20\x6f\x72\x20\x70\x75\x62\x6c\x69\x63\x20\x6b\x65\x79");c=q.generateAddressByPublicKey(a.publicKey)}if(!c)throw b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x75\x62\x6c\x69\x63\x20\x6b\x65\x79");p.logic.account.merge(c,a,b)},v.prototype.sandboxApi=function(a,b,c){n.callMethod(s,a,b,c)},v.prototype.onBind=function(a){o=a},s.open=function(a,b){var c=a.body;p.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{secret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:100}},required:["\x73\x65\x63\x72\x65\x74"]},function(a){return a?b(a[0].message):void r.openAccount(c.secret,function(a,c){var d=null;return a?b(a):(d={address:c.address,unconfirmedBalance:c.u_balance,balance:c.balance,publicKey:c.publicKey,unconfirmedSignature:c.u_secondSignature,secondSignature:c.secondSignature,secondPublicKey:c.secondPublicKey,multisignatures:c.multisignatures,u_multisignatures:c.u_multisignatures},b(null,{account:d}))})})},s.getBalance=function(a,b){var c=a.body;p.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{address:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1}},required:["\x61\x64\x64\x72\x65\x73\x73"]},function(a){if(a)return b(a[0].message);var d=/^[0-9]+[L|l]$/g;return d.test(c.address)?void q.getAccount({address:c.address},function(a,c){var d,e;return a?b(""+a):(d=c?c.balance:0,e=c?c.u_balance:0,void b(null,{balance:d,unconfirmedBalance:e}))}):b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x61\x64\x64\x72\x65\x73\x73")})},s.getPublickey=function(a,b){var c=a.body;p.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{address:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1}},required:["\x61\x64\x64\x72\x65\x73\x73"]},function(a){return a?b(a[0].message):void q.getAccount({address:c.address},function(a,c){return a?b(""+a):c&&c.publicKey?void b(null,{publicKey:c.publicKey}):b("\x41\x63\x63\x6f\x75\x6e\x74\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x68\x61\x76\x65\x20\x61\x20\x70\x75\x62\x6c\x69\x63\x20\x6b\x65\x79")})})},s.generatePublickey=function(a,b){var c=a.body;p.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{secret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1}},required:["\x73\x65\x63\x72\x65\x74"]},function(a){return a?b(a[0].message):void r.openAccount(c.secret,function(a,c){var d=null;!a&&c&&(d=c.publicKey),b(a,{publicKey:d})})})},s.getDelegates=function(a,b){var c=a.body;p.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{address:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1}},required:["\x61\x64\x64\x72\x65\x73\x73"]},function(a){return a?b(a[0].message):void q.getAccount({address:c.address},function(a,d){return a?b(""+a):d?void(d.delegates?q.getAccounts({isDelegate:1,sort:{vote:-1,publicKey:1}},["\x75\x73\x65\x72\x6e\x61\x6d\x65","\x61\x64\x64\x72\x65\x73\x73","\x70\x75\x62\x6c\x69\x63\x4b\x65\x79","\x76\x6f\x74\x65","\x6d\x69\x73\x73\x65\x64\x62\x6c\x6f\x63\x6b\x73","\x70\x72\x6f\x64\x75\x63\x65\x64\x62\x6c\x6f\x63\x6b\x73","\x76\x69\x72\x67\x69\x6e"],function(a,e){var f,h,i,j,k,l,m,n,o,p,q,r,s;if(a)return b(""+a);for(f=c.limit||101,h=c.offset||0,i=c.orderBy,j=c.active,i=i?i.split("\x3a"):null,f=f>101?101:f,k=i?i[0]:null,l=i&&2==i.length?i[1]:"\x61\x73\x63",m=e.length,n=Math.min(f,m),o=Math.min(h+f,m),p=0;p<e.length;p++)e[p].rate=p+1,q=100-e[p].missedblocks/((e[p].producedblocks+e[p].missedblocks)/100),q=q||0,r=p+1>g.delegates&&e[p].virgin,e[p].productivity=r?null:e[p].virgin?0:parseFloat(Math.floor(100*q)/100).toFixed(2);s=e.filter(function(a){return-1!=d.delegates.indexOf(a.publicKey)}),b(null,{delegates:s})}):b(null,{delegates:[]})):b("\x41\x63\x63\x6f\x75\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")})})},s.getDelegatesFee=function(a,b){a.body;b(null,{fee:1*j.fixedPoint})},s.addDelegates=function(a,b){var c=a.body;p.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{secret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1},publicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"},secondSecret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1}}},function(a){var e,g;return a?b(a[0].message):(e=d.createHash("\x73\x68\x61\x32\x35\x36").update(c.secret,"\x75\x74\x66\x38").digest(),g=f.MakeKeypair(e),c.publicKey&&g.publicKey.toString("\x68\x65\x78")!=c.publicKey?b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65"):void p.balancesSequence.add(function(a){c.multisigAccountPublicKey&&c.multisigAccountPublicKey!=g.publicKey.toString("\x68\x65\x78")?o.accounts.getAccount({publicKey:c.multisigAccountPublicKey},function(b,e){return b?a(""+b):e&&e.publicKey?e.multisignatures&&e.multisignatures?e.multisignatures.indexOf(g.publicKey.toString("\x68\x65\x78"))<0?a("\x41\x63\x63\x6f\x75\x6e\x74\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x62\x65\x6c\x6f\x6e\x67\x20\x74\x6f\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x67\x72\x6f\x75\x70"):void o.accounts.getAccount({publicKey:g.publicKey},function(b,h){var i,j,l;if(b)return a(""+b);if(!h||!h.publicKey)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x72\x65\x71\x75\x65\x73\x74\x65\x72");if(h.secondSignature&&!c.secondSecret)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x63\x6f\x6e\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65");if(h.publicKey==e.publicKey)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x72\x65\x71\x75\x65\x73\x74\x65\x72");i=null,h.secondSignature&&(j=d.createHash("\x73\x68\x61\x32\x35\x36").update(c.secondSecret,"\x75\x74\x66\x38").digest(),i=f.MakeKeypair(j));try{l=p.logic.transaction.create({type:k.VOTE,votes:c.delegates,sender:e,keypair:g,secondKeypair:i,requester:g})}catch(m){return a(""+m)}o.transactions.receiveTransactions([l],a)}):a("\x41\x63\x63\x6f\x75\x6e\x74\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x68\x61\x76\x65\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x65\x6e\x61\x62\x6c\x65\x64"):a("\x4d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x61\x63\x63\x6f\x75\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")}):q.getAccount({publicKey:g.publicKey.toString("\x68\x65\x78")},function(b,e){var h,i,j;if(b)return a(""+b);if(!e||!e.publicKey)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x61\x63\x63\x6f\x75\x6e\x74");if(e.secondSignature&&!c.secondSecret)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x63\x6f\x6e\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65");h=null,e.secondSignature&&(i=d.createHash("\x73\x68\x61\x32\x35\x36").update(c.secondSecret,"\x75\x74\x66\x38").digest(),h=f.MakeKeypair(i));try{j=p.logic.transaction.create({type:k.VOTE,votes:c.delegates,sender:e,keypair:g,secondKeypair:h})}catch(l){return a(""+l)}o.transactions.receiveTransactions([j],a)})},function(a,c){return a?b(""+a):void b(null,{transaction:c[0]})}))})},s.getUsernameFee=function(a,b){a.body;b(null,{fee:1*j.fixedPoint})},s.addUsername=function(a,b){var c=a.body;p.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{secret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1},publicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"},secondSecret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1},username:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1}},required:["\x73\x65\x63\x72\x65\x74","\x75\x73\x65\x72\x6e\x61\x6d\x65"]},function(a){var e,g;return a?b(a[0].message):(e=d.createHash("\x73\x68\x61\x32\x35\x36").update(c.secret,"\x75\x74\x66\x38").digest(),g=f.MakeKeypair(e),c.publicKey&&g.publicKey.toString("\x68\x65\x78")!=c.publicKey?b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65"):void p.balancesSequence.add(function(a){c.multisigAccountPublicKey&&c.multisigAccountPublicKey!=g.publicKey.toString("\x68\x65\x78")?o.accounts.getAccount({publicKey:c.multisigAccountPublicKey},function(b,e){return b?a(""+b):e&&e.publicKey?e.multisignatures&&e.multisignatures?e.multisignatures.indexOf(g.publicKey.toString("\x68\x65\x78"))<0?a("\x41\x63\x63\x6f\x75\x6e\x74\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x62\x65\x6c\x6f\x6e\x67\x20\x74\x6f\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x67\x72\x6f\x75\x70"):void o.accounts.getAccount({publicKey:g.publicKey},function(b,h){var i,j,l;if(b)return a(""+b);if(!h||!h.publicKey)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x72\x65\x71\x75\x65\x73\x74\x65\x72");if(h.secondSignature&&!c.secondSecret)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x63\x6f\x6e\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65");if(h.publicKey==e.publicKey)return a("\x49\x6e\x63\x6f\x72\x72\x65\x63\x74\x20\x72\x65\x71\x75\x65\x73\x74\x65\x72");i=null,h.secondSignature&&(j=d.createHash("\x73\x68\x61\x32\x35\x36").update(c.secondSecret,"\x75\x74\x66\x38").digest(),i=f.MakeKeypair(j));try{l=p.logic.transaction.create({type:k.USERNAME,username:c.username,sender:e,keypair:g,secondKeypair:i,requester:g})}catch(m){return a(""+m)}o.transactions.receiveTransactions([l],a)}):a("\x41\x63\x63\x6f\x75\x6e\x74\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x68\x61\x76\x65\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x65\x6e\x61\x62\x6c\x65\x64"):a("\x4d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x61\x63\x63\x6f\x75\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")}):q.getAccount({publicKey:g.publicKey.toString("\x68\x65\x78")},function(b,e){var h,i,j;if(b)return a(""+b);if(!e||!e.publicKey)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x61\x63\x63\x6f\x75\x6e\x74");if(e.secondSignature&&!c.secondSecret)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x63\x6f\x6e\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65");h=null,e.secondSignature&&(i=d.createHash("\x73\x68\x61\x32\x35\x36").update(c.secondSecret,"\x75\x74\x66\x38").digest(),h=f.MakeKeypair(i));try{j=p.logic.transaction.create({type:k.USERNAME,username:c.username,sender:e,keypair:g,secondKeypair:h})}catch(l){return a(""+l)}o.transactions.receiveTransactions([j],a)})},function(a,c){return a?b(""+a):void b(null,{transaction:c[0]})}))})},s.getAccount=function(a,b){var c=a.body;p.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{address:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1}},required:["\x61\x64\x64\x72\x65\x73\x73"]},function(a){return a?b(a[0].message):void q.getAccount({address:c.address},function(a,c){return a?b(""+a):c?void b(null,{account:{address:c.address,username:c.username,unconfirmedBalance:c.u_balance,balance:c.balance,publicKey:c.publicKey,unconfirmedSignature:c.u_secondSignature,secondSignature:c.secondSignature,secondPublicKey:c.secondPublicKey,multisignatures:c.multisignatures,u_multisignatures:c.u_multisignatures}}):b("\x41\x63\x63\x6f\x75\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")})})},s.getUsername=function(a,b){var c=a.body;p.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{username:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1}}},function(a){return a?b(a[0].message):void q.getAccount({username:{$like:c.username.toLowerCase()}},function(a,c){return a||!c?b("\x41\x63\x63\x6f\x75\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64"):void b(null,{account:{address:c.address,username:c.username,unconfirmedBalance:c.u_balance,balance:c.balance,publicKey:c.publicKey,unconfirmedSignature:c.u_secondSignature,secondSignature:c.secondSignature,secondPublicKey:c.secondPublicKey}})})})},a.exports=v}),c.register("\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x62\x6c\x6f\x63\x6b\x73\x2e\x6a\x73",function(a,b,c){function v(a,b){r=b,i=r.genesisblock,s=this,s.__private=t,t.attachApi(),t.saveGenesisBlock(function(b){setImmediate(a,b,s)})}var k,l,m,n,o,p,q,r,s,t,u,d=c("\x63\x72\x79\x70\x74\x6f"),f=(c("\x65\x64\x32\x35\x35\x31\x39"),c("\x69\x70")),h=(c("\x62\x79\x74\x65\x62\x75\x66\x66\x65\x72"),c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x63\x6f\x6e\x73\x74\x61\x6e\x74\x73\x2e\x6a\x73")),i=null,j=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x62\x6c\x6f\x63\x6b\x53\x74\x61\x74\x75\x73\x2e\x6a\x73");h=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x63\x6f\x6e\x73\x74\x61\x6e\x74\x73\x2e\x6a\x73"),k=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x72\x6f\x75\x74\x65\x72\x2e\x6a\x73"),l=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x6c\x6f\x74\x73\x2e\x6a\x73"),m=c("\x75\x74\x69\x6c"),n=c("\x61\x73\x79\x6e\x63"),o=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x2d\x74\x79\x70\x65\x73\x2e\x6a\x73"),p=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x61\x6e\x64\x62\x6f\x78\x2e\x6a\x73"),c("\x61\x72\x72\x61\x79\x2e\x70\x72\x6f\x74\x6f\x74\x79\x70\x65\x2e\x66\x69\x6e\x64\x69\x6e\x64\x65\x78"),t={},u={},t.lastBlock={},t.blockStatus=new j,t.blocksDataFields={b_id:String,b_version:String,b_timestamp:Number,b_height:Number,b_previousBlock:String,b_numberOfTransactions:String,b_totalAmount:String,b_totalFee:String,b_reward:String,b_payloadLength:String,b_payloadHash:String,b_generatorPublicKey:String,b_blockSignature:String,t_id:String,t_type:Number,t_timestamp:Number,t_senderPublicKey:String,t_senderId:String,t_recipientId:String,t_senderUsername:String,t_recipientUsername:String,t_amount:String,t_fee:String,t_signature:String,t_signSignature:String,s_publicKey:String,d_username:String,v_votes:String,c_address:String,u_alias:String,m_min:Number,m_lifetime:Number,m_keysgroup:String,dapp_name:String,dapp_description:String,dapp_tags:String,dapp_type:Number,dapp_siaAscii:String,dapp_siaIcon:String,dapp_git:String,dapp_category:Number,dapp_icon:String,in_dappId:String,ot_dappId:String,ot_outTransactionId:String,t_requesterPublicKey:String,t_signatures:String},t.loaded=!1,t.isActive=!1,t.attachApi=function(){var a=new k;a.use(function(a,b,c){return q?c():void b.status(500).send({success:!1,error:"\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x69\x73\x20\x6c\x6f\x61\x64\x69\x6e\x67"})}),a.map(u,{"get /get":"\x67\x65\x74\x42\x6c\x6f\x63\x6b","get /":"\x67\x65\x74\x42\x6c\x6f\x63\x6b\x73","get /getHeight":"\x67\x65\x74\x48\x65\x69\x67\x68\x74","get /getFee":"\x67\x65\x74\x46\x65\x65","get /getMilestone":"\x67\x65\x74\x4d\x69\x6c\x65\x73\x74\x6f\x6e\x65","get /getReward":"\x67\x65\x74\x52\x65\x77\x61\x72\x64","get /getSupply":"\x67\x65\x74\x53\x75\x70\x70\x6c\x79","get /getStatus":"\x67\x65\x74\x53\x74\x61\x74\x75\x73"}),a.use(function(a,b){b.status(500).send({success:!1,error:"\x41\x50\x49\x20\x65\x6e\x64\x70\x6f\x69\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64"})}),r.network.app.use("\x2f\x61\x70\x69\x2f\x62\x6c\x6f\x63\x6b\x73",a),r.network.app.use(function(a,b,c,d){return a?(r.logger.error(b.url,""+a),void c.status(500).send({success:!1,error:""+a})):d()})},t.saveGenesisBlock=function(a){r.dbLite.query("\x53\x45\x4c\x45\x43\x54\x20\x69\x64\x20\x46\x52\x4f\x4d\x20\x62\x6c\x6f\x63\x6b\x73\x20\x57\x48\x45\x52\x45\x20\x69\x64\x3d\x24\x69\x64",{id:i.block.id},["\x69\x64"],function(b,c){if(b)return a(b);var d=c.length&&c[0].id;d?a():t.saveBlock(i.block,function(b){b&&r.logger.error("\x73\x61\x76\x65\x42\x6c\x6f\x63\x6b",b),a(b)})})},t.deleteBlock=function(a,b){r.dbLite.query("\x44\x45\x4c\x45\x54\x45\x20\x46\x52\x4f\x4d\x20\x62\x6c\x6f\x63\x6b\x73\x20\x57\x48\x45\x52\x45\x20\x69\x64\x20\x3d\x20\x24\x69\x64",{id:a},function(a,c){b(a,c)})},t.list=function(a,b){var h,c=["\x62\x2e\x69\x64","\x62\x2e\x74\x69\x6d\x65\x73\x74\x61\x6d\x70","\x62\x2e\x68\x65\x69\x67\x68\x74","\x62\x2e\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b","\x62\x2e\x74\x6f\x74\x61\x6c\x41\x6d\x6f\x75\x6e\x74","\x62\x2e\x74\x6f\x74\x61\x6c\x46\x65\x65","\x62\x2e\x72\x65\x77\x61\x72\x64","\x62\x2e\x6e\x75\x6d\x62\x65\x72\x4f\x66\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73","\x62\x2e\x67\x65\x6e\x65\x72\x61\x74\x6f\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79"],d={},e=[],f="",g="";return a.generatorPublicKey&&(e.push("\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x67\x65\x6e\x65\x72\x61\x74\x6f\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x29\x20\x3d\x20\x24\x67\x65\x6e\x65\x72\x61\x74\x6f\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79"),d.generatorPublicKey=a.generatorPublicKey),a.numberOfTransactions&&(e.push("\x6e\x75\x6d\x62\x65\x72\x4f\x66\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73\x20\x3d\x20\x24\x6e\x75\x6d\x62\x65\x72\x4f\x66\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73"),d.numberOfTransactions=a.numberOfTransactions),a.previousBlock&&(e.push("\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b\x20\x3d\x20\x24\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b"),d.previousBlock=a.previousBlock),(0===a.height||a.height>0)&&(e.push("\x68\x65\x69\x67\x68\x74\x20\x3d\x20\x24\x68\x65\x69\x67\x68\x74"),d.height=a.height),a.totalAmount>=0&&(e.push("\x74\x6f\x74\x61\x6c\x41\x6d\x6f\x75\x6e\x74\x20\x3d\x20\x24\x74\x6f\x74\x61\x6c\x41\x6d\x6f\x75\x6e\x74"),d.totalAmount=a.totalAmount),a.totalFee>=0&&(e.push("\x74\x6f\x74\x61\x6c\x46\x65\x65\x20\x3d\x20\x24\x74\x6f\x74\x61\x6c\x46\x65\x65"),d.totalFee=a.totalFee),a.reward>=0&&(e.push("\x72\x65\x77\x61\x72\x64\x20\x3d\x20\x24\x72\x65\x77\x61\x72\x64"),d.reward=a.reward),a.orderBy&&(h=a.orderBy.split("\x3a"),g=h[0].replace(/[^\w\s]/gi,""),g="\x62\x2e"+g,f=2==h.length?"\x64\x65\x73\x63"==h[1]?"\x64\x65\x73\x63":"\x61\x73\x63":"\x64\x65\x73\x63"),g&&c.indexOf(g)<0?b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x6f\x72\x74\x20\x66\x69\x65\x6c\x64"):(a.limit||(a.limit=100),a.offset||(a.offset=0),d.limit=a.limit,d.offset=a.offset,a.limit>100?b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x6c\x69\x6d\x69\x74\x2e\x20\x4d\x61\x78\x69\x6d\x75\x6d\x20\x69\x73\x20\x31\x30\x30"):void r.dbLite.query("\x73\x65\x6c\x65\x63\x74\x20\x63\x6f\x75\x6e\x74\x28\x62\x2e\x69\x64\x29\x20\x66\x72\x6f\x6d\x20\x62\x6c\x6f\x63\x6b\x73\x20\x62\x20"+(e.length?"\x77\x68\x65\x72\x65\x20"+e.join("\x20\x61\x6e\x64\x20"):""),d,{count:Number},function(c,h){if(c)return b(c);var i=h[0].count;r.dbLite.query("\x73\x65\x6c\x65\x63\x74\x20\x62\x2e\x69\x64\x2c\x20\x62\x2e\x76\x65\x72\x73\x69\x6f\x6e\x2c\x20\x62\x2e\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x2c\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x2c\x20\x62\x2e\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b\x2c\x20\x62\x2e\x6e\x75\x6d\x62\x65\x72\x4f\x66\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73\x2c\x20\x62\x2e\x74\x6f\x74\x61\x6c\x41\x6d\x6f\x75\x6e\x74\x2c\x20\x62\x2e\x74\x6f\x74\x61\x6c\x46\x65\x65\x2c\x20\x62\x2e\x72\x65\x77\x61\x72\x64\x2c\x20\x62\x2e\x70\x61\x79\x6c\x6f\x61\x64\x4c\x65\x6e\x67\x74\x68\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x62\x2e\x70\x61\x79\x6c\x6f\x61\x64\x48\x61\x73\x68\x29\x29\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x62\x2e\x67\x65\x6e\x65\x72\x61\x74\x6f\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x29\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x62\x2e\x62\x6c\x6f\x63\x6b\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x29\x29\x2c\x20\x28\x73\x65\x6c\x65\x63\x74\x20\x6d\x61\x78\x28\x68\x65\x69\x67\x68\x74\x29\x20\x2b\x20\x31\x20\x66\x72\x6f\x6d\x20\x62\x6c\x6f\x63\x6b\x73\x29\x20\x2d\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x20\x66\x72\x6f\x6d\x20\x62\x6c\x6f\x63\x6b\x73\x20\x62\x20"+(e.length?"\x77\x68\x65\x72\x65\x20"+e.join("\x20\x61\x6e\x64\x20"):"")+"\x20"+(a.orderBy?"\x6f\x72\x64\x65\x72\x20\x62\x79\x20"+g+"\x20"+f:"")+"\x20\x6c\x69\x6d\x69\x74\x20\x24\x6c\x69\x6d\x69\x74\x20\x6f\x66\x66\x73\x65\x74\x20\x24\x6f\x66\x66\x73\x65\x74\x20",d,["\x62\x5f\x69\x64","\x62\x5f\x76\x65\x72\x73\x69\x6f\x6e","\x62\x5f\x74\x69\x6d\x65\x73\x74\x61\x6d\x70","\x62\x5f\x68\x65\x69\x67\x68\x74","\x62\x5f\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b","\x62\x5f\x6e\x75\x6d\x62\x65\x72\x4f\x66\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73","\x62\x5f\x74\x6f\x74\x61\x6c\x41\x6d\x6f\x75\x6e\x74","\x62\x5f\x74\x6f\x74\x61\x6c\x46\x65\x65","\x62\x5f\x72\x65\x77\x61\x72\x64","\x62\x5f\x70\x61\x79\x6c\x6f\x61\x64\x4c\x65\x6e\x67\x74\x68","\x62\x5f\x70\x61\x79\x6c\x6f\x61\x64\x48\x61\x73\x68","\x62\x5f\x67\x65\x6e\x65\x72\x61\x74\x6f\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79","\x62\x5f\x62\x6c\x6f\x63\x6b\x53\x69\x67\x6e\x61\x74\x75\x72\x65","\x62\x5f\x63\x6f\x6e\x66\x69\x72\x6d\x61\x74\x69\x6f\x6e\x73"],function(a,c){var d,e,f;if(a)return r.logger.error(a),b(a);for(d=[],e=0;e<c.length;e++)d.push(r.logic.block.dbRead(c[e]));f={blocks:d,count:i},b(null,f)})}))},t.getById=function(a,b){r.dbLite.query("\x73\x65\x6c\x65\x63\x74\x20\x62\x2e\x69\x64\x2c\x20\x62\x2e\x76\x65\x72\x73\x69\x6f\x6e\x2c\x20\x62\x2e\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x2c\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x2c\x20\x62\x2e\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b\x2c\x20\x62\x2e\x6e\x75\x6d\x62\x65\x72\x4f\x66\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73\x2c\x20\x62\x2e\x74\x6f\x74\x61\x6c\x41\x6d\x6f\x75\x6e\x74\x2c\x20\x62\x2e\x74\x6f\x74\x61\x6c\x46\x65\x65\x2c\x20\x62\x2e\x72\x65\x77\x61\x72\x64\x2c\x20\x62\x2e\x70\x61\x79\x6c\x6f\x61\x64\x4c\x65\x6e\x67\x74\x68\x2c\x20\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x62\x2e\x70\x61\x79\x6c\x6f\x61\x64\x48\x61\x73\x68\x29\x29\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x62\x2e\x67\x65\x6e\x65\x72\x61\x74\x6f\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x29\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x62\x2e\x62\x6c\x6f\x63\x6b\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x29\x29\x2c\x20\x28\x73\x65\x6c\x65\x63\x74\x20\x6d\x61\x78\x28\x68\x65\x69\x67\x68\x74\x29\x20\x2b\x20\x31\x20\x66\x72\x6f\x6d\x20\x62\x6c\x6f\x63\x6b\x73\x29\x20\x2d\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x20\x66\x72\x6f\x6d\x20\x62\x6c\x6f\x63\x6b\x73\x20\x62\x20\x77\x68\x65\x72\x65\x20\x62\x2e\x69\x64\x20\x3d\x20\x24\x69\x64",{id:a},["\x62\x5f\x69\x64","\x62\x5f\x76\x65\x72\x73\x69\x6f\x6e","\x62\x5f\x74\x69\x6d\x65\x73\x74\x61\x6d\x70","\x62\x5f\x68\x65\x69\x67\x68\x74","\x62\x5f\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b","\x62\x5f\x6e\x75\x6d\x62\x65\x72\x4f\x66\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73","\x62\x5f\x74\x6f\x74\x61\x6c\x41\x6d\x6f\x75\x6e\x74","\x62\x5f\x74\x6f\x74\x61\x6c\x46\x65\x65","\x62\x5f\x72\x65\x77\x61\x72\x64","\x62\x5f\x70\x61\x79\x6c\x6f\x61\x64\x4c\x65\x6e\x67\x74\x68","\x62\x5f\x70\x61\x79\x6c\x6f\x61\x64\x48\x61\x73\x68","\x62\x5f\x67\x65\x6e\x65\x72\x61\x74\x6f\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79","\x62\x5f\x62\x6c\x6f\x63\x6b\x53\x69\x67\x6e\x61\x74\x75\x72\x65","\x62\x5f\x63\x6f\x6e\x66\x69\x72\x6d\x61\x74\x69\x6f\x6e\x73"],function(a,c){if(a||!c.length)return b(a||"\x42\x6c\x6f\x63\x6b\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64");var d=r.logic.block.dbRead(c[0]);b(null,d)})},t.saveBlock=function(a,b){r.dbLite.query("\x42\x45\x47\x49\x4e\x20\x54\x52\x41\x4e\x53\x41\x43\x54\x49\x4f\x4e\x3b"),r.logic.block.dbSave(a,function(c){return c?void r.dbLite.query("\x52\x4f\x4c\x4c\x42\x41\x43\x4b\x3b",function(a){b(a||c)}):void n.eachSeries(a.transactions,function(b,c){b.blockId=a.id,r.logic.transaction.dbSave(b,c)},function(a){return a?void r.dbLite.query("\x52\x4f\x4c\x4c\x42\x41\x43\x4b\x3b",function(c){b(c||a)}):void r.dbLite.query("\x43\x4f\x4d\x4d\x49\x54\x3b",b)})})},t.popLastBlock=function(a,b){r.balancesSequence.add(function(b){s.loadBlocksPart({id:a.previousBlock},function(c,d){return c||!d.length?b(c||"\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b\x20\x69\x73\x20\x6e\x75\x6c\x6c"):(d=d[0],void n.eachSeries(a.transactions.reverse(),function(b,c){n.series([function(c){q.accounts.getAccount({publicKey:b.senderPublicKey},function(d,e){return d?c(d):void q.transactions.undo(b,a,e,c)})},function(a){q.transactions.undoUnconfirmed(b,a)},function(a){q.transactions.pushHiddenTransaction(b),setImmediate(a)}],c)},function(){q.round.backwardTick(a,d,function(){t.deleteBlock(a.id,function(a){return a?b(a):void b(null,d)})})}))})},b)},t.getIdSequence=function(a,b){r.dbLite.query("\x53\x45\x4c\x45\x43\x54\x20\x73\x2e\x68\x65\x69\x67\x68\x74\x2c\x20\x67\x72\x6f\x75\x70\x5f\x63\x6f\x6e\x63\x61\x74\x28\x73\x2e\x69\x64\x29\x20\x66\x72\x6f\x6d\x20\x28\x20\x53\x45\x4c\x45\x43\x54\x20\x69\x64\x2c\x20\x6d\x61\x78\x28\x68\x65\x69\x67\x68\x74\x29\x20\x61\x73\x20\x68\x65\x69\x67\x68\x74\x20\x46\x52\x4f\x4d\x20\x62\x6c\x6f\x63\x6b\x73\x20\x67\x72\x6f\x75\x70\x20\x62\x79\x20\x28\x63\x61\x73\x74\x28\x68\x65\x69\x67\x68\x74\x20\x2f\x20\x24\x64\x65\x6c\x65\x67\x61\x74\x65\x73\x20\x61\x73\x20\x69\x6e\x74\x65\x67\x65\x72\x29\x20\x2b\x20\x28\x63\x61\x73\x65\x20\x77\x68\x65\x6e\x20\x68\x65\x69\x67\x68\x74\x20\x25\x20\x24\x64\x65\x6c\x65\x67\x61\x74\x65\x73\x20\x3e\x20\x30\x20\x74\x68\x65\x6e\x20\x31\x20\x65\x6c\x73\x65\x20\x30\x20\x65\x6e\x64\x29\x29\x20\x68\x61\x76\x69\x6e\x67\x20\x68\x65\x69\x67\x68\x74\x20\x3c\x3d\x20\x24\x68\x65\x69\x67\x68\x74\x20\x75\x6e\x69\x6f\x6e\x20\x73\x65\x6c\x65\x63\x74\x20\x69\x64\x2c\x20\x31\x20\x61\x73\x20\x68\x65\x69\x67\x68\x74\x20\x66\x72\x6f\x6d\x20\x62\x6c\x6f\x63\x6b\x73\x20\x77\x68\x65\x72\x65\x20\x68\x65\x69\x67\x68\x74\x20\x3d\x20\x31\x20\x6f\x72\x64\x65\x72\x20\x62\x79\x20\x68\x65\x69\x67\x68\x74\x20\x64\x65\x73\x63\x20\x6c\x69\x6d\x69\x74\x20\x24\x6c\x69\x6d\x69\x74\x20\x29\x20\x73",{height:a,limit:1e3,delegates:l.delegates},["\x66\x69\x72\x73\x74\x48\x65\x69\x67\x68\x74","\x69\x64\x73"],function(c,d){return c||!d.length?void b(c?""+c:"\x43\x61\x6e\x27\x74\x20\x67\x65\x74\x20\x73\x65\x71\x75\x65\x6e\x63\x65\x20\x62\x65\x66\x6f\x72\x65\x3a\x20"+a):void b(null,d[0])})},t.readDbRows=function(a){var d,e,f,g,b={},c=[];for(d=0,e=a.length;e>d;d++)f=r.logic.block.dbRead(a[d]),f&&(b[f.id]||(f.id==i.block.id&&(f.generationSignature=Array(65).join("\x30")),c.push(f.id),b[f.id]=f),g=r.logic.transaction.dbRead(a[d]),b[f.id].transactions=b[f.id].transactions||{},g&&(b[f.id].transactions[g.id]||(b[f.id].transactions[g.id]=g)));return b=c.map(function(a){return b[a].transactions=Object.keys(b[a].transactions).map(function(c){return b[a].transactions[c]}),b[a]})},t.applyTransaction=function(a,b,c,d){q.transactions.applyUnconfirmed(b,c,function(e){return e?setImmediate(d,{message:e,transaction:b,block:a}):void q.transactions.apply(b,a,c,function(c){return c?setImmediate(d,{message:"\x43\x61\x6e\x27\x74\x20\x61\x70\x70\x6c\x79\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x3a\x20"+b.id,transaction:b,block:a}):void setImmediate(d)})})},v.prototype.getCommonBlock=function(a,b,c){var d=null,e=b,f=0;n.whilst(function(){return!d&&30>f&&e>1},function(b){f++,t.getIdSequence(e,function(c,f){if(c)return b(c);var g=e;e=f.firstHeight,q.transport.getFromPeer(a,{api:"\x2f\x62\x6c\x6f\x63\x6b\x73\x2f\x63\x6f\x6d\x6d\x6f\x6e\x3f\x69\x64\x73\x3d"+f.ids+"\x26\x6d\x61\x78\x3d"+g+"\x26\x6d\x69\x6e\x3d"+e,method:"\x47\x45\x54"},function(a,c){return a||c.body.error?b(a||""+c.body.error):c.body.common?void r.dbLite.query("\x73\x65\x6c\x65\x63\x74\x20\x63\x6f\x75\x6e\x74\x28\x2a\x29\x20\x66\x72\x6f\x6d\x20\x62\x6c\x6f\x63\x6b\x73\x20\x77\x68\x65\x72\x65\x20\x69\x64\x20\x3d\x20\x24\x69\x64\x20"+(c.body.common.previousBlock?"\x61\x6e\x64\x20\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b\x20\x3d\x20\x24\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b":"")+"\x20\x61\x6e\x64\x20\x68\x65\x69\x67\x68\x74\x20\x3d\x20\x24\x68\x65\x69\x67\x68\x74",{id:c.body.common.id,previousBlock:c.body.common.previousBlock,height:c.body.common.height
},{cnt:Number},function(a,e){return a||!e.length?b(a||"\x43\x61\x6e\x27\x74\x20\x63\x6f\x6d\x70\x61\x72\x65\x20\x62\x6c\x6f\x63\x6b\x73"):(e[0].cnt&&(d=c.body.common),void b())}):b()})})},function(a){setImmediate(c,a,d)})},v.prototype.count=function(a){r.dbLite.query("\x73\x65\x6c\x65\x63\x74\x20\x63\x6f\x75\x6e\x74\x28\x72\x6f\x77\x69\x64\x29\x20\x66\x72\x6f\x6d\x20\x62\x6c\x6f\x63\x6b\x73",{count:Number},function(b,c){if(b)return a(b);var d=c.length?c[0].count:0;a(null,d)})},v.prototype.loadBlocksData=function(a,b,c){var d,e,f;return arguments.length<3&&(c=b,b={}),b=b||{},a.lastId&&a.id?c("\x49\x6e\x76\x61\x6c\x69\x64\x20\x66\x69\x6c\x74\x65\x72"):(d={limit:a.limit||1},a.lastId&&(d.lastId=a.lastId),a.id&&!a.lastId&&(d.id=a.id),e=t.blocksDataFields,b.plain?(f="\x70\x6c\x61\x69\x6e",e=!1):f="\x71\x75\x65\x72\x79",void r.dbSequence.add(function(b){r.dbLite.query("\x53\x45\x4c\x45\x43\x54\x20\x68\x65\x69\x67\x68\x74\x20\x46\x52\x4f\x4d\x20\x62\x6c\x6f\x63\x6b\x73\x20\x77\x68\x65\x72\x65\x20\x69\x64\x20\x3d\x20\x24\x6c\x61\x73\x74\x49\x64",{lastId:a.lastId||null},{height:Number},function(c,g){var h,i,j;return c?b(c):(h=g.length?g[0].height:0,i=h+(parseInt(a.limit)||1),d.limit=i,d.height=h,j="",a.id||a.lastId||(j="\x77\x68\x65\x72\x65\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x20\x3c\x20\x24\x6c\x69\x6d\x69\x74\x20"),void r.dbLite[f]("\x53\x45\x4c\x45\x43\x54\x20\x62\x2e\x69\x64\x2c\x20\x62\x2e\x76\x65\x72\x73\x69\x6f\x6e\x2c\x20\x62\x2e\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x2c\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x2c\x20\x62\x2e\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b\x2c\x20\x62\x2e\x6e\x75\x6d\x62\x65\x72\x4f\x66\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73\x2c\x20\x62\x2e\x74\x6f\x74\x61\x6c\x41\x6d\x6f\x75\x6e\x74\x2c\x20\x62\x2e\x74\x6f\x74\x61\x6c\x46\x65\x65\x2c\x20\x62\x2e\x72\x65\x77\x61\x72\x64\x2c\x20\x62\x2e\x70\x61\x79\x6c\x6f\x61\x64\x4c\x65\x6e\x67\x74\x68\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x62\x2e\x70\x61\x79\x6c\x6f\x61\x64\x48\x61\x73\x68\x29\x29\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x62\x2e\x67\x65\x6e\x65\x72\x61\x74\x6f\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x29\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x62\x2e\x62\x6c\x6f\x63\x6b\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x29\x29\x2c\x20\x74\x2e\x69\x64\x2c\x20\x74\x2e\x74\x79\x70\x65\x2c\x20\x74\x2e\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x74\x2e\x73\x65\x6e\x64\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x29\x2c\x20\x74\x2e\x73\x65\x6e\x64\x65\x72\x49\x64\x2c\x20\x74\x2e\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x49\x64\x2c\x20\x74\x2e\x73\x65\x6e\x64\x65\x72\x55\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x74\x2e\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x55\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x74\x2e\x61\x6d\x6f\x75\x6e\x74\x2c\x20\x74\x2e\x66\x65\x65\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x74\x2e\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x29\x29\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x74\x2e\x73\x69\x67\x6e\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x29\x29\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x73\x2e\x70\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x29\x2c\x20\x64\x2e\x75\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x76\x2e\x76\x6f\x74\x65\x73\x2c\x20\x63\x2e\x61\x64\x64\x72\x65\x73\x73\x2c\x20\x75\x2e\x75\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x6d\x2e\x6d\x69\x6e\x2c\x20\x6d\x2e\x6c\x69\x66\x65\x74\x69\x6d\x65\x2c\x20\x6d\x2e\x6b\x65\x79\x73\x67\x72\x6f\x75\x70\x2c\x20\x64\x61\x70\x70\x2e\x6e\x61\x6d\x65\x2c\x20\x64\x61\x70\x70\x2e\x64\x65\x73\x63\x72\x69\x70\x74\x69\x6f\x6e\x2c\x20\x64\x61\x70\x70\x2e\x74\x61\x67\x73\x2c\x20\x64\x61\x70\x70\x2e\x74\x79\x70\x65\x2c\x20\x64\x61\x70\x70\x2e\x73\x69\x61\x41\x73\x63\x69\x69\x2c\x20\x64\x61\x70\x70\x2e\x73\x69\x61\x49\x63\x6f\x6e\x2c\x20\x64\x61\x70\x70\x2e\x67\x69\x74\x2c\x20\x64\x61\x70\x70\x2e\x63\x61\x74\x65\x67\x6f\x72\x79\x2c\x20\x64\x61\x70\x70\x2e\x69\x63\x6f\x6e\x2c\x20\x69\x74\x2e\x64\x61\x70\x70\x49\x64\x2c\x20\x6f\x74\x2e\x64\x61\x70\x70\x49\x64\x2c\x20\x6f\x74\x2e\x6f\x75\x74\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x74\x2e\x72\x65\x71\x75\x65\x73\x74\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x29\x2c\x20\x74\x2e\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x46\x52\x4f\x4d\x20\x62\x6c\x6f\x63\x6b\x73\x20\x62\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x74\x72\x73\x20\x61\x73\x20\x74\x20\x6f\x6e\x20\x74\x2e\x62\x6c\x6f\x63\x6b\x49\x64\x3d\x62\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x64\x65\x6c\x65\x67\x61\x74\x65\x73\x20\x61\x73\x20\x64\x20\x6f\x6e\x20\x64\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x76\x6f\x74\x65\x73\x20\x61\x73\x20\x76\x20\x6f\x6e\x20\x76\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x61\x73\x20\x73\x20\x6f\x6e\x20\x73\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x63\x6f\x6e\x74\x61\x63\x74\x73\x20\x61\x73\x20\x63\x20\x6f\x6e\x20\x63\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x75\x73\x65\x72\x6e\x61\x6d\x65\x73\x20\x61\x73\x20\x75\x20\x6f\x6e\x20\x75\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x61\x73\x20\x6d\x20\x6f\x6e\x20\x6d\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x64\x61\x70\x70\x73\x20\x61\x73\x20\x64\x61\x70\x70\x20\x6f\x6e\x20\x64\x61\x70\x70\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x69\x6e\x74\x72\x61\x6e\x73\x66\x65\x72\x20\x69\x74\x20\x6f\x6e\x20\x69\x74\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x6f\x75\x74\x74\x72\x61\x6e\x73\x66\x65\x72\x20\x6f\x74\x20\x6f\x6e\x20\x6f\x74\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20"+(a.id||a.lastId?"\x77\x68\x65\x72\x65\x20":"")+"\x20"+(a.id?"\x20\x62\x2e\x69\x64\x20\x3d\x20\x24\x69\x64\x20":"")+(a.id&&a.lastId?"\x20\x61\x6e\x64\x20":"")+(a.lastId?"\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x20\x3e\x20\x24\x68\x65\x69\x67\x68\x74\x20\x61\x6e\x64\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x20\x3c\x20\x24\x6c\x69\x6d\x69\x74\x20":"")+j+"\x4f\x52\x44\x45\x52\x20\x42\x59\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x2c\x20\x74\x2e\x72\x6f\x77\x69\x64",d,e,b))})},c))},v.prototype.loadBlocksPart=function(a,b){s.loadBlocksData(a,function(a,c){var d=[];a||(d=t.readDbRows(c)),b(a,d)})},v.prototype.loadBlocksOffset=function(a,b,c,d){var e=a+(b||0),f={limit:e,offset:b||0};r.dbSequence.add(function(a){r.dbLite.query("\x53\x45\x4c\x45\x43\x54\x20\x62\x2e\x69\x64\x2c\x20\x62\x2e\x76\x65\x72\x73\x69\x6f\x6e\x2c\x20\x62\x2e\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x2c\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x2c\x20\x62\x2e\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b\x2c\x20\x62\x2e\x6e\x75\x6d\x62\x65\x72\x4f\x66\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73\x2c\x20\x62\x2e\x74\x6f\x74\x61\x6c\x41\x6d\x6f\x75\x6e\x74\x2c\x20\x62\x2e\x74\x6f\x74\x61\x6c\x46\x65\x65\x2c\x20\x62\x2e\x72\x65\x77\x61\x72\x64\x2c\x20\x62\x2e\x70\x61\x79\x6c\x6f\x61\x64\x4c\x65\x6e\x67\x74\x68\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x62\x2e\x70\x61\x79\x6c\x6f\x61\x64\x48\x61\x73\x68\x29\x29\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x62\x2e\x67\x65\x6e\x65\x72\x61\x74\x6f\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x29\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x62\x2e\x62\x6c\x6f\x63\x6b\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x29\x29\x2c\x20\x74\x2e\x69\x64\x2c\x20\x74\x2e\x74\x79\x70\x65\x2c\x20\x74\x2e\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x74\x2e\x73\x65\x6e\x64\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x29\x2c\x20\x74\x2e\x73\x65\x6e\x64\x65\x72\x49\x64\x2c\x20\x74\x2e\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x49\x64\x2c\x20\x74\x2e\x73\x65\x6e\x64\x65\x72\x55\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x74\x2e\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x55\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x74\x2e\x61\x6d\x6f\x75\x6e\x74\x2c\x20\x74\x2e\x66\x65\x65\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x74\x2e\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x29\x29\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x74\x2e\x73\x69\x67\x6e\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x29\x29\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x73\x2e\x70\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x29\x2c\x20\x64\x2e\x75\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x76\x2e\x76\x6f\x74\x65\x73\x2c\x20\x63\x2e\x61\x64\x64\x72\x65\x73\x73\x2c\x20\x75\x2e\x75\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x6d\x2e\x6d\x69\x6e\x2c\x20\x6d\x2e\x6c\x69\x66\x65\x74\x69\x6d\x65\x2c\x20\x6d\x2e\x6b\x65\x79\x73\x67\x72\x6f\x75\x70\x2c\x20\x64\x61\x70\x70\x2e\x6e\x61\x6d\x65\x2c\x20\x64\x61\x70\x70\x2e\x64\x65\x73\x63\x72\x69\x70\x74\x69\x6f\x6e\x2c\x20\x64\x61\x70\x70\x2e\x74\x61\x67\x73\x2c\x20\x64\x61\x70\x70\x2e\x74\x79\x70\x65\x2c\x20\x64\x61\x70\x70\x2e\x73\x69\x61\x41\x73\x63\x69\x69\x2c\x20\x64\x61\x70\x70\x2e\x73\x69\x61\x49\x63\x6f\x6e\x2c\x20\x64\x61\x70\x70\x2e\x67\x69\x74\x2c\x20\x64\x61\x70\x70\x2e\x63\x61\x74\x65\x67\x6f\x72\x79\x2c\x20\x64\x61\x70\x70\x2e\x69\x63\x6f\x6e\x2c\x20\x69\x74\x2e\x64\x61\x70\x70\x49\x64\x2c\x20\x6f\x74\x2e\x64\x61\x70\x70\x49\x64\x2c\x20\x6f\x74\x2e\x6f\x75\x74\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x74\x2e\x72\x65\x71\x75\x65\x73\x74\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x29\x2c\x20\x74\x2e\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x46\x52\x4f\x4d\x20\x62\x6c\x6f\x63\x6b\x73\x20\x62\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x74\x72\x73\x20\x61\x73\x20\x74\x20\x6f\x6e\x20\x74\x2e\x62\x6c\x6f\x63\x6b\x49\x64\x3d\x62\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x64\x65\x6c\x65\x67\x61\x74\x65\x73\x20\x61\x73\x20\x64\x20\x6f\x6e\x20\x64\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x76\x6f\x74\x65\x73\x20\x61\x73\x20\x76\x20\x6f\x6e\x20\x76\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x61\x73\x20\x73\x20\x6f\x6e\x20\x73\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x63\x6f\x6e\x74\x61\x63\x74\x73\x20\x61\x73\x20\x63\x20\x6f\x6e\x20\x63\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x75\x73\x65\x72\x6e\x61\x6d\x65\x73\x20\x61\x73\x20\x75\x20\x6f\x6e\x20\x75\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x61\x73\x20\x6d\x20\x6f\x6e\x20\x6d\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x64\x61\x70\x70\x73\x20\x61\x73\x20\x64\x61\x70\x70\x20\x6f\x6e\x20\x64\x61\x70\x70\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x69\x6e\x74\x72\x61\x6e\x73\x66\x65\x72\x20\x69\x74\x20\x6f\x6e\x20\x69\x74\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x6f\x75\x74\x74\x72\x61\x6e\x73\x66\x65\x72\x20\x6f\x74\x20\x6f\x6e\x20\x6f\x74\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x77\x68\x65\x72\x65\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x20\x3e\x3d\x20\x24\x6f\x66\x66\x73\x65\x74\x20\x61\x6e\x64\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x20\x3c\x20\x24\x6c\x69\x6d\x69\x74\x20\x4f\x52\x44\x45\x52\x20\x42\x59\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x2c\x20\x74\x2e\x72\x6f\x77\x69\x64",f,t.blocksDataFields,function(b,d){if(b)return a(b);var e=t.readDbRows(d);n.eachSeries(e,function(a,b){n.series([function(b){if(a.id!=i.block.id)if(c){if(a.previousBlock!=t.lastBlock.id)return b({message:"\x43\x61\x6e\x27\x74\x20\x76\x65\x72\x69\x66\x79\x20\x70\x72\x65\x76\x69\x6f\x75\x73\x20\x62\x6c\x6f\x63\x6b",block:a});try{var d=r.logic.block.verifySignature(a)}catch(e){return setImmediate(b,{message:""+e,block:a})}if(!d)return b({message:"\x43\x61\x6e\x27\x74\x20\x76\x65\x72\x69\x66\x79\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65",block:a});q.delegates.validateBlockSlot(a,function(c){return c?b({message:"\x43\x61\x6e\x27\x74\x20\x76\x65\x72\x69\x66\x79\x20\x73\x6c\x6f\x74",block:a}):void b()})}else setImmediate(b);else setImmediate(b)},function(b){a.transactions=a.transactions.sort(function(b){return a.id==i.block.id&&b.type==o.VOTE?1:b.type==o.SIGNATURE?1:0}),n.eachSeries(a.transactions,function(b,d){c?q.accounts.setAccountAndGet({publicKey:b.senderPublicKey},function(e,f){return e?d({message:e,transaction:b,block:a}):void(c&&a.id!=i.block.id?r.logic.transaction.verify(b,f,function(c){return c?setImmediate(d,{message:c,transaction:b,block:a}):void t.applyTransaction(a,b,f,d)}):t.applyTransaction(a,b,f,d))}):setImmediate(d)},function(c){var d,e;c?(r.logger.error(c),d=a.transactions.findIndex(function(a){return a.id==c.transaction.id}),e=a.transactions.slice(0,d+1),n.eachSeries(e.reverse(),function(b,c){n.series([function(c){q.accounts.getAccount({publicKey:b.senderPublicKey},function(d,e){return d?c(d):void q.transactions.undo(b,a,e,c)})},function(a){q.transactions.undoUnconfirmed(b,a)}],c)},b)):(t.lastBlock=a,q.round.tick(t.lastBlock,b))})}],b)},function(b){a(b,t.lastBlock)})})},d)},v.prototype.loadLastBlock=function(a){r.dbSequence.add(function(a){r.dbLite.query("\x53\x45\x4c\x45\x43\x54\x20\x62\x2e\x69\x64\x2c\x20\x62\x2e\x76\x65\x72\x73\x69\x6f\x6e\x2c\x20\x62\x2e\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x2c\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x2c\x20\x62\x2e\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b\x2c\x20\x62\x2e\x6e\x75\x6d\x62\x65\x72\x4f\x66\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73\x2c\x20\x62\x2e\x74\x6f\x74\x61\x6c\x41\x6d\x6f\x75\x6e\x74\x2c\x20\x62\x2e\x74\x6f\x74\x61\x6c\x46\x65\x65\x2c\x20\x62\x2e\x72\x65\x77\x61\x72\x64\x2c\x20\x62\x2e\x70\x61\x79\x6c\x6f\x61\x64\x4c\x65\x6e\x67\x74\x68\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x62\x2e\x70\x61\x79\x6c\x6f\x61\x64\x48\x61\x73\x68\x29\x29\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x62\x2e\x67\x65\x6e\x65\x72\x61\x74\x6f\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x29\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x62\x2e\x62\x6c\x6f\x63\x6b\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x29\x29\x2c\x20\x74\x2e\x69\x64\x2c\x20\x74\x2e\x74\x79\x70\x65\x2c\x20\x74\x2e\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x74\x2e\x73\x65\x6e\x64\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x29\x2c\x20\x74\x2e\x73\x65\x6e\x64\x65\x72\x49\x64\x2c\x20\x74\x2e\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x49\x64\x2c\x20\x74\x2e\x73\x65\x6e\x64\x65\x72\x55\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x74\x2e\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x55\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x74\x2e\x61\x6d\x6f\x75\x6e\x74\x2c\x20\x74\x2e\x66\x65\x65\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x74\x2e\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x29\x29\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x74\x2e\x73\x69\x67\x6e\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x29\x29\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x73\x2e\x70\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x29\x2c\x20\x64\x2e\x75\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x76\x2e\x76\x6f\x74\x65\x73\x2c\x20\x63\x2e\x61\x64\x64\x72\x65\x73\x73\x2c\x20\x75\x2e\x75\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x6d\x2e\x6d\x69\x6e\x2c\x20\x6d\x2e\x6c\x69\x66\x65\x74\x69\x6d\x65\x2c\x20\x6d\x2e\x6b\x65\x79\x73\x67\x72\x6f\x75\x70\x2c\x20\x64\x61\x70\x70\x2e\x6e\x61\x6d\x65\x2c\x20\x64\x61\x70\x70\x2e\x64\x65\x73\x63\x72\x69\x70\x74\x69\x6f\x6e\x2c\x20\x64\x61\x70\x70\x2e\x74\x61\x67\x73\x2c\x20\x64\x61\x70\x70\x2e\x74\x79\x70\x65\x2c\x20\x64\x61\x70\x70\x2e\x73\x69\x61\x41\x73\x63\x69\x69\x2c\x20\x64\x61\x70\x70\x2e\x73\x69\x61\x49\x63\x6f\x6e\x2c\x20\x64\x61\x70\x70\x2e\x67\x69\x74\x2c\x20\x64\x61\x70\x70\x2e\x63\x61\x74\x65\x67\x6f\x72\x79\x2c\x20\x64\x61\x70\x70\x2e\x69\x63\x6f\x6e\x2c\x20\x69\x74\x2e\x64\x61\x70\x70\x49\x64\x2c\x20\x6f\x74\x2e\x64\x61\x70\x70\x49\x64\x2c\x20\x6f\x74\x2e\x6f\x75\x74\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x74\x2e\x72\x65\x71\x75\x65\x73\x74\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x29\x2c\x20\x74\x2e\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x46\x52\x4f\x4d\x20\x62\x6c\x6f\x63\x6b\x73\x20\x62\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x74\x72\x73\x20\x61\x73\x20\x74\x20\x6f\x6e\x20\x74\x2e\x62\x6c\x6f\x63\x6b\x49\x64\x3d\x62\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x64\x65\x6c\x65\x67\x61\x74\x65\x73\x20\x61\x73\x20\x64\x20\x6f\x6e\x20\x64\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x76\x6f\x74\x65\x73\x20\x61\x73\x20\x76\x20\x6f\x6e\x20\x76\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x61\x73\x20\x73\x20\x6f\x6e\x20\x73\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x63\x6f\x6e\x74\x61\x63\x74\x73\x20\x61\x73\x20\x63\x20\x6f\x6e\x20\x63\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x75\x73\x65\x72\x6e\x61\x6d\x65\x73\x20\x61\x73\x20\x75\x20\x6f\x6e\x20\x75\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x61\x73\x20\x6d\x20\x6f\x6e\x20\x6d\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x64\x61\x70\x70\x73\x20\x61\x73\x20\x64\x61\x70\x70\x20\x6f\x6e\x20\x64\x61\x70\x70\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x69\x6e\x74\x72\x61\x6e\x73\x66\x65\x72\x20\x69\x74\x20\x6f\x6e\x20\x69\x74\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x6f\x75\x74\x74\x72\x61\x6e\x73\x66\x65\x72\x20\x6f\x74\x20\x6f\x6e\x20\x6f\x74\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x74\x2e\x69\x64\x20\x77\x68\x65\x72\x65\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x20\x3d\x20\x28\x73\x65\x6c\x65\x63\x74\x20\x6d\x61\x78\x28\x68\x65\x69\x67\x68\x74\x29\x20\x66\x72\x6f\x6d\x20\x62\x6c\x6f\x63\x6b\x73\x29\x20\x4f\x52\x44\x45\x52\x20\x42\x59\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x2c\x20\x74\x2e\x72\x6f\x77\x69\x64",{},t.blocksDataFields,function(b,c){if(b)return a(b);var d=t.readDbRows(c)[0];d.transactions=d.transactions.sort(function(a){return d.id==i.block.id&&a.type==o.VOTE?1:a.type==o.SIGNATURE?1:0}),a(null,d)})},a)},v.prototype.getLastBlock=function(){return t.lastBlock},v.prototype.processBlock=function(a,b,c){return t.loaded?(t.isActive=!0,void r.balancesSequence.add(function(c){try{a.id=r.logic.block.getId(a)}catch(e){return t.isActive=!1,setImmediate(c,""+e)}a.height=t.lastBlock.height+1,q.transactions.undoUnconfirmedList(function(e,f){function g(a){q.transactions.applyUnconfirmedList(f,function(){t.isActive=!1,setImmediate(c,a)})}if(e)return t.isActive=!1,process.exit(0);if(!a.previousBlock&&1!=a.height)return setImmediate(g,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x72\x65\x76\x69\x6f\x75\x73\x20\x62\x6c\x6f\x63\x6b");var i=t.blockStatus.calcReward(a.height);return 1!=a.height&&i!==a.reward?setImmediate(g,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x62\x6c\x6f\x63\x6b\x20\x72\x65\x77\x61\x72\x64"):void r.dbLite.query("\x53\x45\x4c\x45\x43\x54\x20\x69\x64\x20\x46\x52\x4f\x4d\x20\x62\x6c\x6f\x63\x6b\x73\x20\x57\x48\x45\x52\x45\x20\x69\x64\x3d\x24\x69\x64",{id:a.id},["\x69\x64"],function(e,i){var j,k,o,p;if(e)return g(e);if(j=i.length&&i[0].id)return g("\x42\x6c\x6f\x63\x6b\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x65\x78\x69\x73\x74\x73\x3a\x20"+a.id);try{k=r.logic.block.verifySignature(a)}catch(m){return setImmediate(c,""+m)}return k?a.previousBlock!=t.lastBlock.id?(q.delegates.fork(a,1),g("\x43\x61\x6e\x27\x74\x20\x76\x65\x72\x69\x66\x79\x20\x70\x72\x65\x76\x69\x6f\x75\x73\x20\x62\x6c\x6f\x63\x6b\x3a\x20"+a.id)):a.version>0?g("\x49\x6e\x76\x61\x6c\x69\x64\x20\x62\x6c\x6f\x63\x6b\x20\x76\x65\x72\x73\x69\x6f\x6e\x3a\x20"+a.id):(o=l.getSlotNumber(a.timestamp),p=l.getSlotNumber(t.lastBlock.timestamp),o>l.getSlotNumber()||p>=o?g("\x43\x61\x6e\x27\x74\x20\x76\x65\x72\x69\x66\x79\x20\x62\x6c\x6f\x63\x6b\x20\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x3a\x20"+a.id):void q.delegates.validateBlockSlot(a,function(c){if(c)return q.delegates.fork(a,3),g("\x43\x61\x6e\x27\x74\x20\x76\x65\x72\x69\x66\x79\x20\x73\x6c\x6f\x74\x3a\x20"+a.id);if(a.payloadLength>h.maxPayloadLength)return g("\x43\x61\x6e\x27\x74\x20\x76\x65\x72\x69\x66\x79\x20\x70\x61\x79\x6c\x6f\x61\x64\x20\x6c\x65\x6e\x67\x74\x68\x20\x6f\x66\x20\x62\x6c\x6f\x63\x6b\x3a\x20"+a.id);if(a.transactions.length!=a.numberOfTransactions||a.transactions.length>100)return g("\x49\x6e\x76\x61\x6c\x69\x64\x20\x61\x6d\x6f\x75\x6e\x74\x20\x6f\x66\x20\x62\x6c\x6f\x63\x6b\x20\x61\x73\x73\x65\x74\x73\x3a\x20"+a.id);var e=0,i=0,j=d.createHash("\x73\x68\x61\x32\x35\x36"),k={};n.eachSeries(a.transactions,function(b,c){try{b.id=r.logic.transaction.getId(b)}catch(d){return setImmediate(c,""+d)}b.blockId=a.id,r.dbLite.query("\x53\x45\x4c\x45\x43\x54\x20\x69\x64\x20\x46\x52\x4f\x4d\x20\x74\x72\x73\x20\x57\x48\x45\x52\x45\x20\x69\x64\x3d\x24\x69\x64",{id:b.id},["\x69\x64"],function(d,g){if(d)return c(d);var h=g.length&&g[0].id;if(h)q.delegates.fork(a,2),setImmediate(c,"\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x65\x78\x69\x73\x74\x73\x3a\x20"+b.id);else{if(k[b.id])return setImmediate(c,"\x44\x75\x70\x6c\x69\x63\x61\x74\x65\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x69\x6e\x20\x62\x6c\x6f\x63\x6b\x3a\x20"+b.id);q.accounts.getAccount({publicKey:b.senderPublicKey},function(a,d){return a?c(a):void r.logic.transaction.verify(b,d,function(a){return a?setImmediate(c,a):void q.transactions.applyUnconfirmed(b,d,function(a){var d,h;if(a)return setImmediate(c,"\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x61\x70\x70\x6c\x79\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x3a\x20"+b.id);try{d=r.logic.transaction.getBytes(b)}catch(g){return setImmediate(c,""+g)}k[b.id]=b,h=f.indexOf(b.id),h>=0&&f.splice(h,1),j.update(d),e+=b.amount,i+=b.fee,setImmediate(c)})})})}})},function(c){var d=[];if(c&&d.push(c),j.digest().toString("\x68\x65\x78")!==a.payloadHash&&d.push("\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x61\x79\x6c\x6f\x61\x64\x20\x68\x61\x73\x68\x3a\x20"+a.id),e!=a.totalAmount&&d.push("\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x6f\x74\x61\x6c\x20\x61\x6d\x6f\x75\x6e\x74\x3a\x20"+a.id),i!=a.totalFee&&d.push("\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x6f\x74\x61\x6c\x20\x66\x65\x65\x3a\x20"+a.id),d.length>0)n.eachSeries(a.transactions,function(a,b){k[a.id]?q.transactions.undoUnconfirmed(a,b):setImmediate(b)},function(){g(d[0])});else{try{a=r.logic.block.objectNormalize(a)}catch(f){return setImmediate(g,f)}n.eachSeries(a.transactions,function(b,c){q.accounts.setAccountAndGet({publicKey:b.senderPublicKey},function(d,e){d&&(r.logger.error("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x61\x70\x70\x6c\x79\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73\x3a\x20"+b.id),process.exit(0)),q.transactions.apply(b,a,e,function(a){a&&(r.logger.error("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x61\x70\x70\x6c\x79\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73\x3a\x20"+b.id),process.exit(0)),q.transactions.removeUnconfirmedTransaction(b.id),setImmediate(c)})})},function(){t.saveBlock(a,function(c){c&&(r.logger.error("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x73\x61\x76\x65\x20\x62\x6c\x6f\x63\x6b\x2e\x2e\x2e"),r.logger.error(c),process.exit(0)),r.bus.message("\x6e\x65\x77\x42\x6c\x6f\x63\x6b",a,b),t.lastBlock=a,q.round.tick(a,g)})})}})})):g("\x43\x61\x6e\x27\x74\x20\x76\x65\x72\x69\x66\x79\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x3a\x20"+a.id)})})},c)):setImmediate(c,"\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x69\x73\x20\x6c\x6f\x61\x64\x69\x6e\x67")},v.prototype.simpleDeleteAfterBlock=function(a,b){r.dbLite.query("\x44\x45\x4c\x45\x54\x45\x20\x46\x52\x4f\x4d\x20\x62\x6c\x6f\x63\x6b\x73\x20\x57\x48\x45\x52\x45\x20\x68\x65\x69\x67\x68\x74\x20\x3e\x3d\x20\x28\x53\x45\x4c\x45\x43\x54\x20\x68\x65\x69\x67\x68\x74\x20\x46\x52\x4f\x4d\x20\x62\x6c\x6f\x63\x6b\x73\x20\x77\x68\x65\x72\x65\x20\x69\x64\x20\x3d\x20\x24\x69\x64\x29",{id:a},b)},v.prototype.loadBlocksFromPeer=function(a,b,c){var d=!1,e=0,g=null;n.whilst(function(){return!d&&30>e},function(c){e++,q.transport.getFromPeer(a,{method:"\x47\x45\x54",api:"\x2f\x62\x6c\x6f\x63\x6b\x73\x3f\x6c\x61\x73\x74\x42\x6c\x6f\x63\x6b\x49\x64\x3d"+b},function(e,h){var i,j;return e||h.body.error?c(e||""+h.body.error):(i=h.body.blocks,"\x73\x74\x72\x69\x6e\x67"==typeof i&&(i=r.dbLite.parseCSV(i)),(j=r.scheme.validate(i,{type:"\x61\x72\x72\x61\x79"}))?(i=i.map(r.dbLite.row2parsed,r.dbLite.parseFields(t.blocksDataFields)),i=t.readDbRows(i),void(0==i.length?(d=!0,c()):n.eachSeries(i,function(c,d){try{c=r.logic.block.objectNormalize(c)}catch(e){var i=h.peer?f.fromLong(h.peer.ip)+"\x3a"+h.peer.port:"\x75\x6e\x6b\x6e\x6f\x77\x6e";return r.logger.log("\x42\x6c\x6f\x63\x6b\x20"+(c?c.id:"\x6e\x75\x6c\x6c")+"\x20\x69\x73\x20\x6e\x6f\x74\x20\x76\x61\x6c\x69\x64\x2c\x20\x62\x61\x6e\x20\x36\x30\x20\x6d\x69\x6e",i),q.peer.state(a.ip,a.port,0,3600),setImmediate(d,e)}s.processBlock(c,!1,function(e){if(e){var i=h.peer?f.fromLong(h.peer.ip)+"\x3a"+h.peer.port:"\x75\x6e\x6b\x6e\x6f\x77\x6e";r.logger.log("\x42\x6c\x6f\x63\x6b\x20"+(c?c.id:"\x6e\x75\x6c\x6c")+"\x20\x69\x73\x20\x6e\x6f\x74\x20\x76\x61\x6c\x69\x64\x2c\x20\x62\x61\x6e\x20\x36\x30\x20\x6d\x69\x6e",i),q.peer.state(a.ip,a.port,0,3600)}else b=c.id,g=c;setImmediate(d,e)})},c))):c("\x45\x72\x72\x6f\x72\x2c\x20\x63\x61\x6e\x27\x74\x20\x70\x61\x72\x73\x65\x20\x62\x6c\x6f\x63\x6b\x73\x2e\x2e\x2e"))})},function(a){setImmediate(c,a,g)})},v.prototype.deleteBlocksBefore=function(a,b){var c=[];n.whilst(function(){return!(a.height>=t.lastBlock.height)},function(a){c.unshift(t.lastBlock),t.popLastBlock(t.lastBlock,function(b,c){t.lastBlock=c,a(b)})},function(a){setImmediate(b,a,c)})},v.prototype.generateBlock=function(a,b,c){var d=q.transactions.getUnconfirmedTransactionList(),e=[];n.eachSeries(d,function(a,b){q.accounts.getAccount({publicKey:a.senderPublicKey},function(c,d){return c||!d?b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x6e\x64\x65\x72"):void(r.logic.transaction.ready(a,d)?r.logic.transaction.verify(a,d,function(){e.push(a),b()}):setImmediate(b))})},function(){try{var d=r.logic.block.create({keypair:a,timestamp:b,previousBlock:t.lastBlock,transactions:e})}catch(f){return setImmediate(c,f)}s.processBlock(d,!0,c)})},v.prototype.sandboxApi=function(a,b,c){p.callMethod(u,a,b,c)},v.prototype.onReceiveBlock=function(a){!q.loader.syncing()&&t.loaded&&r.sequence.add(function(b){a.previousBlock==t.lastBlock.id&&t.lastBlock.height+1==a.height?(r.logger.log("\x52\x65\x63\x69\x65\x76\x65\x64\x20\x6e\x65\x77\x20\x62\x6c\x6f\x63\x6b\x20\x69\x64\x3a\x20"+a.id+"\x20\x68\x65\x69\x67\x68\x74\x3a\x20"+a.height+"\x20\x73\x6c\x6f\x74\x3a\x20"+l.getSlotNumber(a.timestamp)+"\x20\x72\x65\x77\x61\x72\x64\x3a\x20"+q.blocks.getLastBlock().reward),s.processBlock(a,!0,b)):a.previousBlock!=t.lastBlock.id&&t.lastBlock.height+1==a.height?(q.delegates.fork(a,1),b("\x46\x6f\x72\x6b")):a.previousBlock==t.lastBlock.previousBlock&&a.height==t.lastBlock.height&&a.id!=t.lastBlock.id?(q.delegates.fork(a,5),b("\x46\x6f\x72\x6b")):b()})},v.prototype.onBind=function(a){q=a,t.loaded=!0},v.prototype.cleanup=function(a){t.loaded=!1,t.isActive?setImmediate(function b(){t.isActive?setTimeout(b,1e3):a()}):a()},u.getBlock=function(a,b){t.loaded||b("\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x69\x73\x20\x6c\x6f\x61\x64\x69\x6e\x67");var c=a.body;r.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{id:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1}},required:["\x69\x64"]},function(a){return a?b(a[0].message):void r.dbSequence.add(function(a){t.getById(c.id,function(b,c){return!c||b?a("\x42\x6c\x6f\x63\x6b\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64"):void a(null,{block:c})})},b)})},u.getBlocks=function(a,b){t.loaded||b("\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x69\x73\x20\x6c\x6f\x61\x64\x69\x6e\x67");var c=a.body;r.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{limit:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:100},orderBy:{type:"\x73\x74\x72\x69\x6e\x67"},offset:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0},generatorPublicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"},totalAmount:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:h.totalAmount},totalFee:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:h.totalAmount},reward:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0},previousBlock:{type:"\x73\x74\x72\x69\x6e\x67"},height:{type:"\x69\x6e\x74\x65\x67\x65\x72"}}},function(a){return a?b(a[0].message):void r.dbSequence.add(function(a){t.list(c,function(b,c){return b?a("\x44\x61\x74\x61\x62\x61\x73\x65\x20\x65\x72\x72\x6f\x72"):void a(null,{blocks:c.blocks,count:c.count})})},b)})},u.getHeight=function(a,b){t.loaded||b("\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x69\x73\x20\x6c\x6f\x61\x64\x69\x6e\x67");a.body;b(null,{height:t.lastBlock.height})},u.getFee=function(a,b){t.loaded||b("\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x69\x73\x20\x6c\x6f\x61\x64\x69\x6e\x67");a.body;b(null,{fee:r.logic.block.calculateFee()})},u.getMilestone=function(a,b){t.loaded||b("\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x69\x73\x20\x6c\x6f\x61\x64\x69\x6e\x67");var d=(a.body,t.lastBlock.height);b(null,{milestone:t.blockStatus.calcMilestone(d)})},u.getReward=function(a,b){t.loaded||b("\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x69\x73\x20\x6c\x6f\x61\x64\x69\x6e\x67");var d=(a.body,t.lastBlock.height);b(null,{reward:t.blockStatus.calcReward(d)})},u.getSupply=function(a,b){t.loaded||b("\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x69\x73\x20\x6c\x6f\x61\x64\x69\x6e\x67");var d=(a.body,t.lastBlock.height);b(null,{supply:t.blockStatus.calcSupply(d)})},u.getStatus=function(a,b){t.loaded||b("\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x69\x73\x20\x6c\x6f\x61\x64\x69\x6e\x67");var d=(a.body,t.lastBlock.height);b(null,{height:d,fee:r.logic.block.calculateFee(),milestone:t.blockStatus.calcMilestone(d),reward:t.blockStatus.calcReward(d),supply:t.blockStatus.calcSupply(d)})},a.exports=v}),c.register("\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x63\x6f\x6e\x74\x61\x63\x74\x73\x2e\x6a\x73",function(a,b,c){
function s(){this.create=function(a,b){return b.recipientId=null,b.amount=0,b.asset.contact={address:a.contactAddress},b},this.calculateFee=function(){return 1*f.fixedPoint},this.verify=function(a,b,c){if(!a.asset.contact)return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x61\x73\x73\x65\x74\x3a\x20"+a.id);if(!a.asset.contact.address)return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x61\x73\x73\x65\x74\x3a\x20"+a.id);var d=/^[\+|\-][0-9]+[L|l]$/g;return d.test(a.asset.contact.address.toLowerCase())?0!=a.amount?setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x61\x6d\x6f\x75\x6e\x74\x3a\x20"+a.id):a.recipientId?setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x3a\x20"+a.id):void p.checkContacts(a.senderPublicKey,[a.asset.contact.address],function(b){return b?setImmediate(c,"\x41\x63\x63\x6f\x75\x6e\x74\x20\x69\x73\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x61\x20\x63\x6f\x6e\x74\x61\x63\x74"):void setImmediate(c,b,a)}):setImmediate(c,"\x43\x6f\x6e\x74\x61\x63\x74\x20\x69\x73\x20\x6e\x6f\x74\x20\x61\x6e\x20\x61\x64\x64\x72\x65\x73\x73\x3a\x20"+a.asset.contact.address)},this.process=function(a,b,c){setImmediate(c,null,a)},this.getBytes=function(a){var b,c,d;try{for(b=new Buffer(a.asset.contact.address,"\x75\x74\x66\x38"),c=new h(b.length,!0),d=0;d<b.length;d++)c.writeByte(b[d]);c.flip()}catch(e){throw Error(""+e)}return c.toBuffer()},this.apply=function(a,b,c,d){this.scope.account.merge(c.address,{contacts:[a.asset.contact.address],blockId:b.id,round:n.round.calc(b.height)},function(a){d(a)})},this.undo=function(a,b,c,d){var e=j.reverse([a.asset.contact.address]);this.scope.account.merge(c.address,{contacts:e,blockId:b.id,round:n.round.calc(b.height)},function(a){d(a)})},this.applyUnconfirmed=function(a,b,c){p.checkUnconfirmedContacts(a.senderPublicKey,[a.asset.contact.address],function(d){return d?setImmediate(c,"\x41\x63\x63\x6f\x75\x6e\x74\x20\x69\x73\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x61\x20\x63\x6f\x6e\x74\x61\x63\x74"):void this.scope.account.merge(b.address,{u_contacts:[a.asset.contact.address]},function(a){c(a)})}.bind(this))},this.undoUnconfirmed=function(a,b,c){var d=j.reverse([a.asset.contact.address]);this.scope.account.merge(b.address,{u_contacts:d},function(a){c(a)})},this.objectNormalize=function(a){var b=o.scheme.validate(a.asset.contact,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{address:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1}},required:["\x61\x64\x64\x72\x65\x73\x73"]});if(!b)throw Error("\x49\x6e\x63\x6f\x72\x72\x65\x63\x74\x20\x61\x64\x64\x72\x65\x73\x73\x20\x69\x6e\x20\x63\x6f\x6e\x74\x61\x63\x74\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x3a\x20"+o.scheme.getLastError());return a},this.dbRead=function(a){if(a.c_address){var b={transactionId:a.t_id,address:a.c_address};return{contact:b}}return null},this.dbSave=function(a,b){o.dbLite.query("\x49\x4e\x53\x45\x52\x54\x20\x49\x4e\x54\x4f\x20\x63\x6f\x6e\x74\x61\x63\x74\x73\x28\x61\x64\x64\x72\x65\x73\x73\x2c\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29\x20\x56\x41\x4c\x55\x45\x53\x28\x24\x61\x64\x64\x72\x65\x73\x73\x2c\x20\x24\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29",{address:a.asset.contact.address,transactionId:a.id},b)},this.ready=function(a,b){return b.multisignatures.length?a.signatures?a.signatures.length>=b.multimin-1:!1:!0}}function t(a,b){o=b,p=this,p.__private=q,q.attachApi(),o.logic.transaction.attachAssetType(d.FOLLOW,new s),setImmediate(a,null,p)}var n,o,p,d=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x2d\x74\x79\x70\x65\x73\x2e\x6a\x73"),e=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x72\x6f\x75\x74\x65\x72\x2e\x6a\x73"),f=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x63\x6f\x6e\x73\x74\x61\x6e\x74\x73\x2e\x6a\x73"),g=c("\x65\x64\x32\x35\x35\x31\x39"),h=c("\x62\x79\x74\x65\x62\x75\x66\x66\x65\x72"),i=c("\x63\x72\x79\x70\x74\x6f"),j=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x64\x69\x66\x66\x2e\x6a\x73"),k=c("\x61\x73\x79\x6e\x63"),l=c("\x75\x74\x69\x6c"),m=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x61\x6e\x64\x62\x6f\x78\x2e\x6a\x73"),q={},r={};q.attachApi=function(){var a=new e;a.use(function(a,b,c){return n?c():void b.status(500).send({success:!1,error:"\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x69\x73\x20\x6c\x6f\x61\x64\x69\x6e\x67"})}),a.map(r,{"get /unconfirmed":"\x67\x65\x74\x55\x6e\x63\x6f\x6e\x66\x69\x72\x6d\x65\x64\x43\x6f\x6e\x74\x61\x63\x74\x73","get /":"\x67\x65\x74\x43\x6f\x6e\x74\x61\x63\x74\x73","put /":"\x61\x64\x64\x43\x6f\x6e\x74\x61\x63\x74","get /fee":"\x67\x65\x74\x46\x65\x65"}),a.use(function(a,b){b.status(500).send({success:!1,error:"\x41\x50\x49\x20\x65\x6e\x64\x70\x6f\x69\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64"})}),o.network.app.use("\x2f\x61\x70\x69\x2f\x63\x6f\x6e\x74\x61\x63\x74\x73",a),o.network.app.use(function(a,b,c,d){return a?(o.logger.error(b.url,""+a),void c.status(500).send({success:!1,error:""+a})):d()})},t.prototype.checkContacts=function(a,b,c){l.isArray(b)?n.accounts.setAccountAndGet({publicKey:a},function(a,d){var e,f,g;if(a)return c(a);if(!d)return c("\x41\x63\x63\x6f\x75\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64");for(e=0;e<b.length;e++){if(f=b[e][0],g=b[e].slice(1),"\x2b"!=f)return c("\x49\x6e\x63\x6f\x72\x72\x65\x63\x74\x20\x6d\x61\x74\x68\x20\x6f\x70\x65\x72\x61\x74\x6f\x72");if("\x2b"==f&&null!==d.contacts&&-1!=d.contacts.indexOf(g))return c("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x61\x64\x64\x20\x63\x6f\x6e\x74\x61\x63\x74\x2c\x20\x61\x63\x63\x6f\x75\x6e\x74\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x68\x61\x73\x20\x74\x68\x69\x73\x20\x63\x6f\x6e\x74\x61\x63\x74");if("\x2d"==f&&(null===d.contacts||-1===d.contacts.indexOf(g)))return c("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x72\x65\x6d\x6f\x76\x65\x20\x63\x6f\x6e\x74\x61\x63\x74\x2c\x20\x61\x63\x63\x6f\x75\x6e\x74\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x68\x61\x76\x65\x20\x74\x68\x69\x73\x20\x63\x6f\x6e\x74\x61\x63\x74")}c()}):setImmediate(c,"\x50\x6c\x65\x61\x73\x65\x20\x70\x72\x6f\x76\x69\x64\x65\x20\x61\x6e\x20\x61\x72\x72\x61\x79\x20\x6f\x66\x20\x63\x6f\x6e\x74\x61\x63\x74\x73")},t.prototype.checkUnconfirmedContacts=function(a,b,c){var d=n.accounts.generateAddressByPublicKey(a);return l.isArray(b)?void n.accounts.getAccount({address:d},function(a,d){return a?c(a):d?void k.eachSeries(b,function(a,b){var c=a[0],e=a.slice(1);return"\x2b"!=c?b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x6d\x61\x74\x68\x20\x6f\x70\x65\x72\x61\x74\x6f\x72"):void n.accounts.setAccountAndGet({address:e},function(a){return a?b(a):"\x2b"==c&&null!==d.u_contacts&&-1!=d.u_contacts.indexOf(e)?b("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x61\x64\x64\x20\x63\x6f\x6e\x74\x61\x63\x74\x2c\x20\x61\x63\x63\x6f\x75\x6e\x74\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x68\x61\x73\x20\x74\x68\x69\x73\x20\x63\x6f\x6e\x74\x61\x63\x74"):"\x2d"!=c||null!==d.u_contacts&&-1!==d.u_contacts.indexOf(e)?b():b("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x72\x65\x6d\x6f\x76\x65\x20\x63\x6f\x6e\x74\x61\x63\x74\x2c\x20\x61\x63\x63\x6f\x75\x6e\x74\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x68\x61\x76\x65\x20\x74\x68\x69\x73\x20\x63\x6f\x6e\x74\x61\x63\x74")})},c):c("\x41\x63\x63\x6f\x75\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")}):setImmediate(c,"\x50\x6c\x65\x61\x73\x65\x20\x70\x72\x6f\x76\x69\x64\x65\x20\x61\x6e\x20\x61\x72\x72\x61\x79\x20\x6f\x66\x20\x63\x6f\x6e\x74\x61\x63\x74\x73")},t.prototype.sandboxApi=function(a,b,c){m.callMethod(r,a,b,c)},t.prototype.onBind=function(a){n=a},r.getUnconfirmedContacts=function(a,b){var c=a.body;o.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{publicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"}},required:["\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"]},function(a){var e,f;return a?b(a[0].message):(e=n.transactions.getUnconfirmedTransactionList(),f=[],void k.eachSeries(e,function(a,b){return a.type!=d.FOLLOW?setImmediate(b):(a.senderPublicKey==c.publicKey&&f.push(a),void setImmediate(b))},function(){return b(null,{contacts:f})}))})},r.getContacts=function(a,b){var c=a.body;o.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{publicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"}},required:["\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"]},function(a){return a?b(a[0].message):(c.address=n.accounts.generateAddressByPublicKey(c.publicKey),void n.accounts.getAccount({address:c.address},function(a,c){return a?b(""+a):c?void k.series({contacts:function(a){return c.contacts.length?void n.accounts.getAccounts({address:{$in:c.contacts}},["\x61\x64\x64\x72\x65\x73\x73","\x75\x73\x65\x72\x6e\x61\x6d\x65"],a):a(null,[])},followers:function(a){return c.followers.length?void n.accounts.getAccounts({address:{$in:c.followers}},["\x61\x64\x64\x72\x65\x73\x73","\x75\x73\x65\x72\x6e\x61\x6d\x65"],a):a(null,[])}},function(a,c){var d,e,f;if(a)return b(""+a);d=[];for(e in c.followers)f=c.contacts.find(function(a){return a.address==c.followers[e].address}),f||d.push(c.followers[e]);b(null,{following:c.contacts,followers:d})}):b("\x41\x63\x63\x6f\x75\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")}))})},r.addContact=function(a,b){var c=a.body;o.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{secret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1},secondSecret:{type:"\x73\x74\x72\x69\x6e\x67"},publicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"},following:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1},multisigAccountPublicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"}},required:["\x73\x65\x63\x72\x65\x74","\x66\x6f\x6c\x6c\x6f\x77\x69\x6e\x67"]},function(a){var e,f,h,j,k;return a?b(a[0].message):(e=i.createHash("\x73\x68\x61\x32\x35\x36").update(c.secret,"\x75\x74\x66\x38").digest(),f=g.MakeKeypair(e),c.publicKey&&f.publicKey.toString("\x68\x65\x78")!=c.publicKey?b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65"):(h={},j=c.following.substring(1,c.following.length),k=/^[0-9]+[L|l]$/g,k.test(j)?h.address=j:h.username=j,void o.balancesSequence.add(function(a){c.multisigAccountPublicKey&&c.multisigAccountPublicKey!=f.publicKey.toString("\x68\x65\x78")?n.accounts.getAccount({publicKey:c.multisigAccountPublicKey},function(b,e){return b?a(""+b):e&&e.publicKey?e.multisignatures&&e.multisignatures?e.multisignatures.indexOf(f.publicKey.toString("\x68\x65\x78"))<0?a("\x41\x63\x63\x6f\x75\x6e\x74\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x62\x65\x6c\x6f\x6e\x67\x20\x74\x6f\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x67\x72\x6f\x75\x70"):void n.accounts.getAccount({publicKey:f.publicKey},function(b,h){var k,l,m;if(b)return a(""+b);if(!h||!h.publicKey)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x72\x65\x71\x75\x65\x73\x74\x65\x72");if(h.secondSignature&&!c.secondSecret)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x63\x6f\x6e\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65");if(h.publicKey==e.publicKey)return a("\x49\x6e\x63\x6f\x72\x72\x65\x63\x74\x20\x72\x65\x71\x75\x65\x73\x74\x65\x72");if(!following)return a("\x55\x73\x65\x72\x6e\x61\x6d\x65\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64");j=c.following[0]+following.address,k=null,h.secondSignature&&(l=i.createHash("\x73\x68\x61\x32\x35\x36").update(c.secondSecret,"\x75\x74\x66\x38").digest(),k=g.MakeKeypair(l));try{m=o.logic.transaction.create({type:d.FOLLOW,sender:e,keypair:f,secondKeypair:k,contactAddress:j,requester:f})}catch(p){return a(""+p)}n.transactions.receiveTransactions([m],a)}):a("\x41\x63\x63\x6f\x75\x6e\x74\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x68\x61\x76\x65\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x65\x6e\x61\x62\x6c\x65\x64"):a("\x4d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x61\x63\x63\x6f\x75\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")}):n.accounts.getAccount(h,function(b,e){return b?a(""+b):e?(j=c.following[0]+e.address,void n.accounts.getAccount({publicKey:f.publicKey.toString("\x68\x65\x78")},function(b,e){var h,k,l;if(b)return a(""+b);if(!e)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x61\x63\x63\x6f\x75\x6e\x74");if(e.secondSignature&&!c.secondSecret)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x63\x6f\x6e\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65");e.secondSignature&&c.secondSecret&&(h=i.createHash("\x73\x68\x61\x32\x35\x36").update(c.secondSecret,"\x75\x74\x66\x38").digest(),k=g.MakeKeypair(h));try{l=o.logic.transaction.create({type:d.FOLLOW,sender:e,keypair:f,secondKeypair:k,contactAddress:j})}catch(m){return a(""+m)}n.transactions.receiveTransactions([l],a)})):a("\x55\x73\x65\x72\x6e\x61\x6d\x65\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")})},function(a,c){return a?b(""+a):void b(null,{transaction:c[0]})})))})},r.getFee=function(a,b){a.body;b(null,{fee:1*f.fixedPoint})},a.exports=t}),c.register("\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x63\x72\x79\x70\x74\x6f\x2e\x6a\x73",function(a,b,c){function o(a,b){k=b,l=this,l.__private=m,setImmediate(a,null,l)}var j,k,l,i=(c("\x75\x74\x69\x6c"),c("\x72\x65\x71\x75\x65\x73\x74"),c("\x66\x73"),c("\x63\x72\x79\x70\x74\x6f"),c("\x65\x64\x32\x35\x35\x31\x39"),c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x61\x6e\x64\x62\x6f\x78\x2e\x6a\x73")),m={},n={};m.loaded=!1,o.prototype.sandboxApi=function(a,b,c){i.callMethod(n,a,b,c)},o.prototype.onBind=function(a){j=a},o.prototype.onBlockchainReady=function(){m.loaded=!0},a.exports=o}),c.register("\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x64\x61\x70\x70\x73\x2e\x6a\x73",function(a,b,c){function D(a,b){return(b?/^[\x00-\xFF]*$/:/^[\x00-\x7F]*$/).test(a)}function E(){this.create=function(a,b){return b.recipientId=a.recipientId,b.amount=a.amount,b.asset.outTransfer={dappId:a.dappId,transactionId:a.transactionId},b},this.calculateFee=function(){return z.logic.block.calculateFee()},this.verify=function(a,b,c){return a.recipientId?a.amount?a.asset.outTransfer.dappId?a.asset.outTransfer.transactionId?void setImmediate(c,null,a):setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x64\x61\x70\x70\x20\x69\x64\x20\x66\x6f\x72\x20\x69\x6e\x70\x75\x74\x20\x74\x72\x61\x6e\x73\x66\x65\x72"):setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x64\x61\x70\x70\x20\x69\x64\x20\x66\x6f\x72\x20\x6f\x75\x74\x20\x74\x72\x61\x6e\x73\x66\x65\x72"):setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x61\x6d\x6f\x75\x6e\x74"):setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x72\x65\x63\x69\x70\x69\x65\x6e\x74")},this.process=function(a,b,c){z.dbLite.query("\x53\x45\x4c\x45\x43\x54\x20\x63\x6f\x75\x6e\x74\x28\x2a\x29\x20\x46\x52\x4f\x4d\x20\x64\x61\x70\x70\x73\x20\x57\x48\x45\x52\x45\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x24\x69\x64",{id:a.asset.outTransfer.dappId},["\x63\x6f\x75\x6e\x74"],function(b,d){if(b)return z.logger.error(""+b),c("\x44\x61\x70\x70\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64\x3a\x20"+a.asset.outTransfer.dappId);var e=d[0].count;return 0==e?c("\x44\x61\x70\x70\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64\x3a\x20"+a.asset.outTransfer.dappId):B.unconfirmedOutTansfers[a.asset.outTransfer.transactionId]?c("\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x69\x73\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x70\x72\x6f\x63\x65\x73\x73\x69\x6e\x67\x3a\x20"+a.asset.outTransfer.transactionId):void z.dbLite.query("\x53\x45\x4c\x45\x43\x54\x20\x63\x6f\x75\x6e\x74\x28\x2a\x29\x20\x46\x52\x4f\x4d\x20\x6f\x75\x74\x74\x72\x61\x6e\x73\x66\x65\x72\x20\x57\x48\x45\x52\x45\x20\x6f\x75\x74\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x20\x3d\x20\x24\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64",{transactionId:a.asset.outTransfer.transactionId},{count:Number},function(b,d){if(b)return z.logger.error(""+b),c("\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x69\x73\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x63\x6f\x6e\x66\x69\x72\x6d\x65\x64\x3a\x20"+a.asset.outTransfer.transactionId);var e=d[0].count;return e?c("\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x69\x73\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x63\x6f\x6e\x66\x69\x72\x6d\x65\x64"):c(null,a)})})},this.getBytes=function(a){var b,c,d;try{b=new Buffer([]),c=new Buffer(a.asset.outTransfer.dappId,"\x75\x74\x66\x38"),d=new Buffer(a.asset.outTransfer.transactionId,"\x75\x74\x66\x38"),b=Buffer.concat([b,c,d])}catch(e){throw Error(""+e)}return b},this.apply=function(a,b,c,d){B.unconfirmedOutTansfers[a.asset.outTransfer.transactionId]=!1,y.accounts.setAccountAndGet({address:a.recipientId},function(c){return c?d(c):void y.accounts.mergeAccountAndGet({address:a.recipientId,balance:a.amount,u_balance:a.amount,blockId:b.id,round:y.round.calc(b.height)},function(a){d(a)})})},this.undo=function(a,b,c,d){B.unconfirmedOutTansfers[a.asset.outTransfer.transactionId]=!0,y.accounts.setAccountAndGet({address:a.recipientId},function(c){return c?d(c):void y.accounts.mergeAccountAndGet({address:a.recipientId,balance:-a.amount,u_balance:-a.amount,blockId:b.id,round:y.round.calc(b.height)},function(a){d(a)})})},this.applyUnconfirmed=function(a,b,c){B.unconfirmedOutTansfers[a.asset.outTransfer.transactionId]=!0,setImmediate(c)},this.undoUnconfirmed=function(a,b,c){B.unconfirmedOutTansfers[a.asset.outTransfer.transactionId]=!1,setImmediate(c)},this.objectNormalize=function(a){var b=z.scheme.validate(a.asset.outTransfer,{object:!0,properties:{dappId:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1},transactionId:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1}},required:["\x64\x61\x70\x70\x49\x64","\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64"]});if(!b)throw Error("\x43\x61\x6e\x27\x74\x20\x76\x65\x72\x69\x66\x79\x20\x64\x61\x70\x70\x20\x6f\x75\x74\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x2c\x20\x69\x6e\x63\x6f\x72\x72\x65\x63\x74\x20\x70\x61\x72\x61\x6d\x65\x74\x65\x72\x73\x3a\x20"+z.scheme.getLastError());return a},this.dbRead=function(a){if(a.ot_dappId){var b={dappId:a.ot_dappId,transactionId:a.ot_outTransactionId};return{outTransfer:b}}return null},this.dbSave=function(a,b){z.dbLite.query("\x49\x4e\x53\x45\x52\x54\x20\x49\x4e\x54\x4f\x20\x6f\x75\x74\x74\x72\x61\x6e\x73\x66\x65\x72\x28\x64\x61\x70\x70\x49\x64\x2c\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x2c\x20\x6f\x75\x74\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29\x20\x56\x41\x4c\x55\x45\x53\x28\x24\x64\x61\x70\x70\x49\x64\x2c\x20\x24\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x2c\x20\x24\x6f\x75\x74\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29",{dappId:a.asset.outTransfer.dappId,outTransactionId:a.asset.outTransfer.transactionId,transactionId:a.id},function(c){return c?b(c):void A.message(a.asset.outTransfer.dappId,{topic:"\x77\x69\x74\x68\x64\x72\x61\x77\x61\x6c",message:{transactionId:a.id}},b)})},this.ready=function(a,b){return b.multisignatures.length?a.signatures?a.signatures.length>=b.multimin-1:!1:!0}}function F(){this.create=function(a,b){return b.recipientId=null,b.amount=a.amount,b.asset.inTransfer={dappId:a.dappId},b},this.calculateFee=function(){return z.logic.block.calculateFee()},this.verify=function(a,b,c){return a.recipientId?setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x72\x65\x63\x69\x70\x69\x65\x6e\x74"):a.amount?void z.dbLite.query("\x53\x45\x4c\x45\x43\x54\x20\x63\x6f\x75\x6e\x74\x28\x2a\x29\x20\x46\x52\x4f\x4d\x20\x64\x61\x70\x70\x73\x20\x57\x48\x45\x52\x45\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x3d\x24\x69\x64",{id:a.asset.inTransfer.dappId},["\x63\x6f\x75\x6e\x74"],function(b,d){if(b)return z.logger.error(""+b),setImmediate(c,"\x44\x61\x70\x70\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64\x3a\x20"+a.asset.inTransfer.dappId);var e=d[0].count;return 0==e?setImmediate(c,"\x44\x61\x70\x70\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64\x3a\x20"+a.asset.inTransfer.dappId):void setImmediate(c)}):setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x61\x6d\x6f\x75\x6e\x74")},this.process=function(a,b,c){setImmediate(c,null,a)},this.getBytes=function(a){var b,c;try{b=new Buffer([]),c=new Buffer(a.asset.inTransfer.dappId,"\x75\x74\x66\x38"),b=Buffer.concat([b,c])}catch(d){throw Error(""+d)}return b},this.apply=function(a,b,c,d){C.getGenesis({dappid:a.asset.inTransfer.dappId},function(c,e){return c?d(c):void y.accounts.mergeAccountAndGet({address:e.authorId,balance:a.amount,u_balance:a.amount,blockId:b.id,round:y.round.calc(b.height)},function(a){d(a)})})},this.undo=function(a,b,c,d){C.getGenesis({dappid:a.asset.inTransfer.dappId},function(c,e){return c?d(c):void y.accounts.mergeAccountAndGet({address:e.authorId,balance:-a.amount,u_balance:-a.amount,blockId:b.id,round:y.round.calc(b.height)},function(a){d(a)})})},this.applyUnconfirmed=function(a,b,c){setImmediate(c)},this.undoUnconfirmed=function(a,b,c){setImmediate(c)},this.objectNormalize=function(a){var b=z.scheme.validate(a.asset.inTransfer,{object:!0,properties:{dappId:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1}},required:["\x64\x61\x70\x70\x49\x64"]});if(!b)throw Error("\x43\x61\x6e\x27\x74\x20\x76\x65\x72\x69\x66\x79\x20\x64\x61\x70\x70\x20\x69\x6e\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x2c\x20\x69\x6e\x63\x6f\x72\x72\x65\x63\x74\x20\x70\x61\x72\x61\x6d\x65\x74\x65\x72\x73\x3a\x20"+z.scheme.getLastError());return a},this.dbRead=function(a){if(a.in_dappId){var b={dappId:a.in_dappId};return{inTransfer:b}}return null},this.dbSave=function(a,b){z.dbLite.query("\x49\x4e\x53\x45\x52\x54\x20\x49\x4e\x54\x4f\x20\x69\x6e\x74\x72\x61\x6e\x73\x66\x65\x72\x28\x64\x61\x70\x70\x49\x64\x2c\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29\x20\x56\x41\x4c\x55\x45\x53\x28\x24\x64\x61\x70\x70\x49\x64\x2c\x20\x24\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29",{dappId:a.asset.inTransfer.dappId,transactionId:a.id},b)},this.ready=function(a,b){return b.multisignatures.length?a.signatures?a.signatures.length>=b.multimin-1:!1:!0}}function G(){this.create=function(a,b){return b.recipientId=null,b.amount=0,b.asset.dapp={category:a.category,name:a.name,description:a.description,tags:a.tags,type:a.dapp_type,siaAscii:a.siaAscii,git:a.git,icon:a.icon,siaIcon:a.siaIcon},b},this.calculateFee=function(){return 500*q.fixedPoint},this.verify=function(a,b,c){var g,h,i,j,d=!1,e=!1;if(a.recipientId)return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x72\x65\x63\x69\x70\x69\x65\x6e\x74");if(0!=a.amount)return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x61\x6d\x6f\x75\x6e\x74");if(0!=a.asset.dapp.category&&!a.asset.dapp.category)return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x64\x61\x70\x70\x20\x63\x61\x74\x65\x67\x6f\x72\x79");g=!1;for(h in f)if(f[h]==a.asset.dapp.category){g=!0;break}if(!g)return setImmediate(c,"\x55\x6e\x6b\x6e\x6f\x77\x6e\x20\x64\x61\x70\x70\x20\x63\x61\x74\x65\x67\x6f\x72\x79");if(a.asset.dapp.siaAscii){if(d=!0,a.asset.dapp.siaAscii.trim()!=a.asset.dapp.siaAscii)return setImmediate(c,"\x55\x6e\x74\x72\x69\x6d\x6d\x65\x64\x20\x73\x69\x61\x20\x61\x73\x63\x69\x69");if(0==a.asset.dapp.siaAscii.trim().length)return setImmediate(c,"\x45\x6d\x70\x74\x79\x20\x73\x69\x61\x20\x61\x73\x63\x69\x69");if(a.asset.dapp.siaAscii.length>1e4)return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x69\x61\x20\x61\x73\x63\x69\x69\x20\x6c\x65\x6e\x67\x74\x68\x2e\x20\x4d\x61\x78\x69\x6d\x75\x6d\x20\x69\x73\x20\x31\x30\x30\x30\x30");if("\x73\x74\x72\x69\x6e\x67"!=typeof a.asset.dapp.siaAscii)return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x69\x61\x20\x61\x73\x63\x69\x69");if(!D(a.asset.dapp.siaAscii))return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x69\x61\x20\x61\x73\x63\x69\x69")}if(a.asset.dapp.siaIcon){if(e=!0,0==a.asset.dapp.siaIcon.length)return setImmediate(c,"\x45\x6d\x70\x74\x79\x20\x73\x69\x61\x20\x69\x63\x6f\x6e");if(a.asset.dapp.siaIcon!=a.asset.dapp.siaIcon.trim())return setImmediate(c,"\x55\x6e\x74\x72\x69\x6d\x6d\x65\x64\x20\x73\x69\x61\x20\x69\x63\x6f\x6e");if(a.asset.dapp.siaIcon.length>1e4)return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x69\x61\x20\x69\x63\x6f\x6e\x20\x6c\x65\x6e\x67\x74\x68\x2e\x20\x4d\x61\x78\x69\x6d\x75\x6d\x20\x69\x73\x20\x31\x30\x30\x30\x30");if("\x73\x74\x72\x69\x6e\x67"!=typeof a.asset.dapp.siaIcon)return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x69\x61\x20\x69\x63\x6f\x6e");if(!D(a.asset.dapp.siaIcon))return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x69\x61\x20\x69\x63\x6f\x6e\x20\x61\x73\x63\x69\x69")}if(a.asset.dapp.icon){if(e)return setImmediate(c,"\x44\x61\x70\x70\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x68\x61\x73\x20\x61\x20\x73\x69\x61\x20\x69\x63\x6f\x6e");if(!w.isUri(a.asset.dapp.icon))return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x69\x61\x20\x69\x63\x6f\x6e\x20\x6c\x69\x6e\x6b");if(i=a.asset.dapp.icon.length,a.asset.dapp.icon.indexOf("\x2e\x70\x6e\x67")!=i-4&&a.asset.dapp.icon.indexOf("\x2e\x6a\x70\x67")!=i-4&&a.asset.dapp.icon.indexOf("\x2e\x6a\x70\x65\x67")!=i-5)return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x69\x61\x20\x69\x63\x6f\x6e\x20\x66\x69\x6c\x65\x20\x74\x79\x70\x65")}if(a.asset.dapp.type>1||a.asset.dapp.type<0)return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x64\x61\x70\x70\x20\x74\x79\x70\x65");if(a.asset.dapp.git){if(d)return setImmediate(c,"\x44\x61\x70\x70\x20\x63\x61\x6e\x20\x6f\x6e\x6c\x79\x20\x62\x65\x20\x68\x6f\x73\x74\x65\x64\x20\x69\x6e\x20\x6f\x6e\x65\x20\x6c\x6f\x63\x61\x74\x69\x6f\x6e\x20\x28\x67\x69\x74\x68\x75\x62\x20\x6f\x72\x20\x73\x69\x61\x29");if(!/^git\@github\.com\:.+\.git$/.test(a.asset.dapp.git))return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x67\x69\x74\x68\x75\x62\x20\x72\x65\x70\x6f\x73\x69\x74\x6f\x72\x79\x20\x6c\x69\x6e\x6b")}if(!d&&!a.asset.dapp.git)return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x64\x61\x70\x70\x20\x73\x74\x6f\x72\x61\x67\x65\x20\x6f\x70\x74\x69\x6f\x6e");if(!a.asset.dapp.name||0==a.asset.dapp.name.trim().length||a.asset.dapp.name.trim()!=a.asset.dapp.name)return setImmediate(c,"\x4d\x69\x73\x73\x69\x6e\x67\x20\x64\x61\x70\x70\x20\x6e\x61\x6d\x65");if(a.asset.dapp.name.length>32)return setImmediate(c,"\x44\x61\x70\x70\x20\x6e\x61\x6d\x65\x20\x69\x73\x20\x74\x6f\x6f\x20\x6c\x6f\x6e\x67\x2e\x20\x4d\x61\x78\x69\x6d\x75\x6d\x20\x69\x73\x20\x33\x32\x20\x63\x68\x61\x72\x61\x63\x74\x65\x72\x73");if(a.asset.dapp.description&&a.asset.dapp.description.length>160)return setImmediate(c,"\x44\x61\x70\x70\x20\x64\x65\x73\x63\x72\x69\x70\x74\x69\x6f\x6e\x20\x69\x73\x20\x74\x6f\x6f\x20\x6c\x6f\x6e\x67\x2e\x20\x4d\x61\x78\x69\x6d\x75\x6d\x20\x69\x73\x20\x31\x36\x30\x20\x63\x68\x61\x72\x61\x63\x74\x65\x72\x73");if(a.asset.dapp.tags&&a.asset.dapp.tags.length>160)return setImmediate(c,"\x44\x61\x70\x70\x20\x68\x61\x73\x20\x74\x6f\x6f\x20\x6d\x61\x6e\x79\x20\x74\x61\x67\x73\x2e\x20\x4d\x61\x78\x69\x6d\x75\x6d\x20\x69\x73\x20\x31\x36\x30");if(a.asset.dapp.tags)for(j=a.asset.dapp.tags.split("\x2c"),j=j.map(function(a){return a.trim()}).sort(),h=0;h<j.length-1;h++)if(j[h+1]==j[h])return setImmediate(c,"\x45\x6e\x63\x6f\x75\x6e\x74\x65\x72\x65\x64\x20\x64\x75\x70\x6c\x69\x63\x61\x74\x65\x20\x74\x61\x67\x73\x3a\x20"+j[h]);setImmediate(c)},this.process=function(a,b,c){setImmediate(c,null,a)},this.getBytes=function(a){var b,c,d,e,f;try{b=new Buffer([]),c=new Buffer(a.asset.dapp.name,"\x75\x74\x66\x38"),b=Buffer.concat([b,c]),a.asset.dapp.description&&(d=new Buffer(a.asset.dapp.description,"\x75\x74\x66\x38"),b=Buffer.concat([b,d])),a.asset.dapp.tags&&(e=new Buffer(a.asset.dapp.tags,"\x75\x74\x66\x38"),b=Buffer.concat([b,e])),a.asset.dapp.siaAscii&&(b=Buffer.concat([b,new Buffer(a.asset.dapp.siaAscii,"\x61\x73\x63\x69\x69")])),a.asset.dapp.siaIcon&&(b=Buffer.concat([b,new Buffer(a.asset.dapp.siaIcon,"\x61\x73\x63\x69\x69")])),a.asset.dapp.git&&(b=Buffer.concat([b,new Buffer(a.asset.dapp.git,"\x75\x74\x66\x38")])),a.asset.dapp.icon&&(b=Buffer.concat([b,new Buffer(a.asset.dapp.icon,"\x75\x74\x66\x38")])),f=new h(8,!0),f.writeInt(a.asset.dapp.type),f.writeInt(a.asset.dapp.category),f.flip(),b=Buffer.concat([b,f.toBuffer()])}catch(g){throw Error(""+g)}return b},this.apply=function(a,b,c,d){setImmediate(d)},this.undo=function(a,b,c,d){setImmediate(d)},this.applyUnconfirmed=function(a,b,c){return B.unconfirmedNames[a.asset.dapp.name]?setImmediate(c,"\x44\x61\x70\x70\x20\x6e\x61\x6d\x65\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x65\x78\x69\x73\x74\x73"):a.asset.dapp.git&&B.unconfirmedLinks[a.asset.dapp.git]?setImmediate(c,"\x47\x69\x74\x20\x72\x65\x70\x6f\x73\x69\x74\x6f\x72\x79\x20\x6c\x69\x6e\x6b\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x65\x78\x69\x73\x74\x73"):a.asset.dapp.siAscii&&B.unconfirmedAscii[a.asset.dapp.siaAscii]?setImmediate(c,"\x44\x61\x70\x70\x20\x61\x73\x63\x69\x69\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x65\x78\x69\x73\x74\x73"):(B.unconfirmedNames[a.asset.dapp.name]=!0,B.unconfirmedLinks[a.asset.dapp.git]=!0,B.unconfirmedAscii[a.asset.dapp.siaAscii]=!0,void z.dbLite.query("\x53\x45\x4c\x45\x43\x54\x20\x6e\x61\x6d\x65\x2c\x20\x73\x69\x61\x41\x73\x63\x69\x69\x2c\x20\x67\x69\x74\x20\x46\x52\x4f\x4d\x20\x64\x61\x70\x70\x73\x20\x57\x48\x45\x52\x45\x20\x28\x6e\x61\x6d\x65\x20\x3d\x20\x24\x6e\x61\x6d\x65\x20\x6f\x72\x20\x73\x69\x61\x41\x73\x63\x69\x69\x20\x3d\x20\x24\x73\x69\x61\x41\x73\x63\x69\x69\x20\x6f\x72\x20\x67\x69\x74\x20\x3d\x20\x24\x67\x69\x74\x29\x20\x61\x6e\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x20\x21\x3d\x20\x24\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64",{name:a.asset.dapp.name,siaAscii:a.asset.dapp.siaAscii||null,git:a.asset.dapp.git||null,transactionId:a.id},["\x6e\x61\x6d\x65","\x73\x69\x61\x41\x73\x63\x69\x69","\x67\x69\x74"],function(b,d){if(b)return setImmediate(c,"\x44\x61\x74\x61\x62\x61\x73\x65\x20\x65\x72\x72\x6f\x72");if(d.length>0){var e=d[0];return e.name==a.asset.dapp.name?setImmediate(c,"\x44\x61\x70\x70\x20\x6e\x61\x6d\x65\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x65\x78\x69\x73\x74\x73\x3a\x20"+e.name):e.siaAscii==a.asset.dapp.siaAscii?setImmediate(c,"\x44\x61\x70\x70\x20\x73\x69\x61\x20\x63\x6f\x64\x65\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x65\x78\x69\x73\x74\x73"):e.git==a.asset.dapp.git?setImmediate(c,"\x47\x69\x74\x20\x72\x65\x70\x6f\x73\x69\x74\x6f\x72\x79\x20\x6c\x69\x6e\x6b\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x65\x78\x69\x73\x74\x73\x3a\x20"+e.git):setImmediate(c,"\x55\x6e\x6b\x6e\x6f\x77\x6e\x20\x65\x72\x72\x6f\x72")}return setImmediate(c,null,a)}))},this.undoUnconfirmed=function(a,b,c){delete B.unconfirmedNames[a.asset.dapp.name],delete B.unconfirmedLinks[a.asset.dapp.git],delete B.unconfirmedAscii[a.asset.dapp.siaAscii],setImmediate(c)},this.objectNormalize=function(a){var b,c;for(b in a.asset.dapp)(null===a.asset.dapp[b]||void 0===a.asset.dapp[b])&&delete a.asset.dapp[b];if(c=z.scheme.validate(a.asset.dapp,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{category:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:8},name:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:32},description:{type:"\x73\x74\x72\x69\x6e\x67",minLength:0,maxLength:160},tags:{type:"\x73\x74\x72\x69\x6e\x67",minLength:0,maxLength:160},type:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0},git:{type:"\x73\x74\x72\x69\x6e\x67",minLength:0,maxLength:2e3},icon:{type:"\x73\x74\x72\x69\x6e\x67",minLength:0,maxLength:2e3}},required:["\x74\x79\x70\x65","\x6e\x61\x6d\x65","\x63\x61\x74\x65\x67\x6f\x72\x79"]}),!c)throw Error("\x43\x61\x6e\x27\x74\x20\x76\x65\x72\x69\x66\x79\x20\x64\x61\x70\x70\x20\x6e\x65\x77\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x2c\x20\x69\x6e\x63\x6f\x72\x72\x65\x63\x74\x20\x70\x61\x72\x61\x6d\x65\x74\x65\x72\x73\x3a\x20"+z.scheme.getLastError());return a},this.dbRead=function(a){if(a.dapp_name){var b={name:a.dapp_name,description:a.dapp_description,tags:a.dapp_tags,type:a.dapp_type,siaAscii:a.dapp_siaAscii,siaIcon:a.dapp_siaIcon,git:a.dapp_git,category:a.dapp_category,icon:a.dapp_icon};return{dapp:b}}return null},this.dbSave=function(a,b){z.dbLite.query("\x49\x4e\x53\x45\x52\x54\x20\x49\x4e\x54\x4f\x20\x64\x61\x70\x70\x73\x28\x74\x79\x70\x65\x2c\x20\x6e\x61\x6d\x65\x2c\x20\x64\x65\x73\x63\x72\x69\x70\x74\x69\x6f\x6e\x2c\x20\x74\x61\x67\x73\x2c\x20\x73\x69\x61\x41\x73\x63\x69\x69\x2c\x20\x73\x69\x61\x49\x63\x6f\x6e\x2c\x20\x67\x69\x74\x2c\x20\x63\x61\x74\x65\x67\x6f\x72\x79\x2c\x20\x69\x63\x6f\x6e\x2c\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29\x20\x56\x41\x4c\x55\x45\x53\x28\x24\x74\x79\x70\x65\x2c\x20\x24\x6e\x61\x6d\x65\x2c\x20\x24\x64\x65\x73\x63\x72\x69\x70\x74\x69\x6f\x6e\x2c\x20\x24\x74\x61\x67\x73\x2c\x20\x24\x73\x69\x61\x41\x73\x63\x69\x69\x2c\x20\x24\x73\x69\x61\x49\x63\x6f\x6e\x2c\x20\x24\x67\x69\x74\x2c\x20\x24\x63\x61\x74\x65\x67\x6f\x72\x79\x2c\x20\x24\x69\x63\x6f\x6e\x2c\x20\x24\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29",{
type:a.asset.dapp.type,name:a.asset.dapp.name,description:a.asset.dapp.description||null,tags:a.asset.dapp.tags||null,siaAscii:a.asset.dapp.siaAscii||null,siaIcon:a.asset.dapp.siaIcon||null,git:a.asset.dapp.git||null,icon:a.asset.dapp.icon||null,category:a.asset.dapp.category,transactionId:a.id},function(a){return a?setImmediate(b,a):(z.network.io.sockets.emit("\x64\x61\x70\x70\x73\x2f\x63\x68\x61\x6e\x67\x65",{}),setImmediate(b))})},this.ready=function(a,b){return b.multisignatures.length?a.signatures?a.signatures.length>=b.multimin-1:!1:!0}}function H(a,b){z=b,A=this,A.__private=B,z.logic.transaction.attachAssetType(g.DAPP,new G),z.logic.transaction.attachAssetType(g.IN_TRANSFER,new F),z.logic.transaction.attachAssetType(g.OUT_TRANSFER,new E),B.attachApi(),process.on("\x65\x78\x69\x74",function(){var a=Object.keys(B.launched);d.eachSeries(a,function(a,b){return B.launched[a]?void B.stop({transactionId:a},function(a){b(a)}):setImmediate(b)},function(a){z.logger.error(a)})}),i.exists(k.join("\x2e","\x70\x75\x62\x6c\x69\x63","\x64\x61\x70\x70\x73"),function(b){b?t(k.join("\x2e","\x70\x75\x62\x6c\x69\x63","\x64\x61\x70\x70\x73"),function(b){b&&z.logger.error(b),B.createBasePathes(function(b){setImmediate(a,b,A)})}):B.createBasePathes(function(){setImmediate(a,null,A)})})}var y,z,A,d=c("\x61\x73\x79\x6e\x63"),f=(c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x64\x61\x70\x70\x54\x79\x70\x65\x73\x2e\x6a\x73"),c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x64\x61\x70\x70\x43\x61\x74\x65\x67\x6f\x72\x79\x2e\x6a\x73")),g=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x2d\x74\x79\x70\x65\x73\x2e\x6a\x73"),h=c("\x62\x79\x74\x65\x62\x75\x66\x66\x65\x72"),i=c("\x66\x73"),j=c("\x67\x69\x66\x74"),k=c("\x70\x61\x74\x68"),l=c("\x6e\x70\x6d"),n=(c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x6c\x6f\x74\x73\x2e\x6a\x73"),c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x72\x6f\x75\x74\x65\x72\x2e\x6a\x73")),o=c("\x64\x65\x63\x6f\x6d\x70\x72\x65\x73\x73\x2d\x7a\x69\x70"),p=c("\x63\x72\x79\x70\x74\x6f"),q=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x63\x6f\x6e\x73\x74\x61\x6e\x74\x73\x2e\x6a\x73"),r=c("\x6c\x69\x73\x6b\x2d\x73\x61\x6e\x64\x62\x6f\x78"),s=c("\x65\x64\x32\x35\x35\x31\x39"),t=c("\x72\x69\x6d\x72\x61\x66"),v=(c("\x65\x78\x74\x65\x6e\x64"),c("\x69\x70")),w=c("\x76\x61\x6c\x69\x64\x2d\x75\x72\x6c"),x=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x61\x6e\x64\x62\x6f\x78\x2e\x6a\x73"),B={},C={};B.launched={},B.loading={},B.removing={},B.unconfirmedNames={},B.unconfirmedLinks={},B.unconfirmedAscii={},B.appPath=process.cwd(),B.dappsPath=k.join(process.cwd(),"\x64\x61\x70\x70\x73"),B.sandboxes={},B.dappready={},B.routes={},B.unconfirmedOutTansfers={},B.attachApi=function(){var a=new n;a.use(function(a,b,c){return y?c():void b.status(500).send({success:!1,error:"\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x69\x73\x20\x6c\x6f\x61\x64\x69\x6e\x67"})}),a.put("\x2f",function(a,b,c){a.sanitize(a.body,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{secret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1},secondSecret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1},publicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"},category:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0},name:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:32},description:{type:"\x73\x74\x72\x69\x6e\x67",minLength:0,maxLength:160},tags:{type:"\x73\x74\x72\x69\x6e\x67",minLength:0,maxLength:160},type:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0},siaAscii:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:1e4},git:{type:"\x73\x74\x72\x69\x6e\x67",maxLength:2e3,minLength:1},icon:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:2e3},siaIcon:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:1e4}},required:["\x73\x65\x63\x72\x65\x74","\x74\x79\x70\x65","\x6e\x61\x6d\x65","\x63\x61\x74\x65\x67\x6f\x72\x79"]},function(a,d,e){var f,h;return a?c(a):d.isValid?(f=p.createHash("\x73\x68\x61\x32\x35\x36").update(e.secret,"\x75\x74\x66\x38").digest(),h=s.MakeKeypair(f),e.publicKey&&h.publicKey.toString("\x68\x65\x78")!=e.publicKey?b.json({success:!1,error:"\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65"}):void z.balancesSequence.add(function(a){y.accounts.getAccount({publicKey:h.publicKey.toString("\x68\x65\x78")},function(b,c){var d,f,i;if(b)return a("\x44\x61\x74\x61\x62\x61\x73\x65\x20\x65\x72\x72\x6f\x72");if(!c||!c.publicKey)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x61\x63\x63\x6f\x75\x6e\x74");if(c.secondSignature&&!e.secondSecret)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x63\x6f\x6e\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65");d=null,c.secondSignature&&(f=p.createHash("\x73\x68\x61\x32\x35\x36").update(e.secondSecret,"\x75\x74\x66\x38").digest(),d=s.MakeKeypair(f));try{i=z.logic.transaction.create({type:g.DAPP,sender:c,keypair:h,secondKeypair:d,category:e.category,name:e.name,description:e.description,tags:e.tags,dapp_type:e.type,siaAscii:e.siaAscii,git:e.git,icon:e.icon,siaIcon:e.siaIcon})}catch(j){return a(""+j)}y.transactions.receiveTransactions([i],a)})},function(a,c){return a?b.json({success:!1,error:""+a}):void b.json({success:!0,transaction:c[0]})})):b.json({success:!1,error:d.issues})})}),a.get("\x2f",function(a,b,c){a.sanitize(a.query,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{category:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1},name:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:32},type:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0},git:{type:"\x73\x74\x72\x69\x6e\x67",maxLength:2e3,minLength:1},siaAscii:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1},siaIcon:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1},limit:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:100},icon:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1},offset:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0},orderBy:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1}}},function(a,d,e){return a?c(a):d.isValid?void B.list(e,function(a,c){return a?b.json({success:!1,error:"\x44\x61\x70\x70\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64"}):void b.json({success:!0,dapps:c})}):b.json({success:!1,error:d.issues})})}),a.get("\x2f\x67\x65\x74",function(a,b,c){a.sanitize(a.query,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{id:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1}},required:["\x69\x64"]},function(a,d,e){return a?c(a):d.isValid?void B.get(e.id,function(a,c){return a?b.json({success:!1,error:a}):b.json({success:!0,dapp:c})}):b.json({success:!1,error:d.issues})})}),a.get("\x2f\x73\x65\x61\x72\x63\x68",function(a,b,c){a.sanitize(a.query,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{q:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1},category:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:8},installed:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:1}},required:["\x71"]},function(a,d,e){if(a)return c(a);if(!d.isValid)return b.json({success:!1,error:d.issues});var f=null;e.category&&(f=e.category),z.dbLite.query("\x43\x52\x45\x41\x54\x45\x20\x56\x49\x52\x54\x55\x41\x4c\x20\x54\x41\x42\x4c\x45\x20\x49\x46\x20\x4e\x4f\x54\x20\x45\x58\x49\x53\x54\x53\x20\x64\x61\x70\x70\x73\x5f\x73\x65\x61\x72\x63\x68\x20\x55\x53\x49\x4e\x47\x20\x66\x74\x73\x34\x28\x63\x6f\x6e\x74\x65\x6e\x74\x3d\x64\x61\x70\x70\x73\x2c\x20\x6e\x61\x6d\x65\x2c\x20\x64\x65\x73\x63\x72\x69\x70\x74\x69\x6f\x6e\x2c\x20\x74\x61\x67\x73\x29",function(a){return a?(z.logger.error(a),b.json({success:!1,error:"\x53\x71\x6c\x20\x65\x72\x72\x6f\x72\x2c\x20\x63\x68\x65\x63\x6b\x20\x6c\x6f\x67\x73"})):void z.dbLite.query("\x49\x4e\x53\x45\x52\x54\x20\x4f\x52\x20\x49\x47\x4e\x4f\x52\x45\x20\x49\x4e\x54\x4f\x20\x64\x61\x70\x70\x73\x5f\x73\x65\x61\x72\x63\x68\x28\x64\x6f\x63\x69\x64\x2c\x20\x6e\x61\x6d\x65\x2c\x20\x64\x65\x73\x63\x72\x69\x70\x74\x69\x6f\x6e\x2c\x20\x74\x61\x67\x73\x29\x20\x53\x45\x4c\x45\x43\x54\x20\x72\x6f\x77\x69\x64\x2c\x20\x6e\x61\x6d\x65\x2c\x20\x64\x65\x73\x63\x72\x69\x70\x74\x69\x6f\x6e\x2c\x20\x74\x61\x67\x73\x20\x46\x52\x4f\x4d\x20\x64\x61\x70\x70\x73",function(a){return a?(z.logger.error(a),b.json({success:!1,error:"\x53\x71\x6c\x20\x65\x72\x72\x6f\x72\x2c\x20\x63\x68\x65\x63\x6b\x20\x6c\x6f\x67\x73"})):void z.dbLite.query("\x53\x45\x4c\x45\x43\x54\x20\x72\x6f\x77\x69\x64\x20\x46\x52\x4f\x4d\x20\x64\x61\x70\x70\x73\x5f\x73\x65\x61\x72\x63\x68\x20\x57\x48\x45\x52\x45\x20\x64\x61\x70\x70\x73\x5f\x73\x65\x61\x72\x63\x68\x20\x4d\x41\x54\x43\x48\x20\x24\x71",{q:e.q+"\x2a"},["\x72\x6f\x77\x69\x64"],function(a,c){var d,g;return a?(z.logger.error(a),b.json({success:!1,error:"\x53\x71\x6c\x20\x65\x72\x72\x6f\x72\x2c\x20\x63\x68\x65\x63\x6b\x20\x6c\x6f\x67\x73"})):c.length>0?(d="",(0===f||f>0)&&(d="\x20\x41\x4e\x44\x20\x63\x61\x74\x65\x67\x6f\x72\x79\x20\x3d\x20\x24\x63\x61\x74\x65\x67\x6f\x72\x79"),g=c.map(function(a){return a.rowid}),z.dbLite.query("\x53\x45\x4c\x45\x43\x54\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x2c\x20\x6e\x61\x6d\x65\x2c\x20\x64\x65\x73\x63\x72\x69\x70\x74\x69\x6f\x6e\x2c\x20\x74\x61\x67\x73\x2c\x20\x73\x69\x61\x41\x73\x63\x69\x69\x2c\x20\x73\x69\x61\x49\x63\x6f\x6e\x2c\x20\x67\x69\x74\x2c\x20\x74\x79\x70\x65\x2c\x20\x63\x61\x74\x65\x67\x6f\x72\x79\x2c\x20\x69\x63\x6f\x6e\x20\x46\x52\x4f\x4d\x20\x64\x61\x70\x70\x73\x20\x57\x48\x45\x52\x45\x20\x72\x6f\x77\x69\x64\x20\x49\x4e\x20\x28"+g.join("\x2c")+"\x29"+d,{category:f},{transactionId:String,name:String,description:String,tags:String,siaAscii:String,siaIcon:String,git:String,type:Number,category:Number,icon:String},function(a,c){return a?(z.logger.error(a),b.json({success:!1,error:"\x53\x71\x6c\x20\x65\x72\x72\x6f\x72\x2c\x20\x63\x68\x65\x63\x6b\x20\x6c\x6f\x67\x73"})):null===e.installed||void 0===e.installed?b.json({success:!0,dapps:c}):void(1==e.installed?B.getInstalledIds(function(a,d){if(a)return b.json({success:!1,error:"\x43\x61\x6e\x27\x74\x20\x67\x65\x74\x20\x69\x6e\x73\x74\x61\x6c\x6c\x65\x64\x20\x64\x61\x70\x70\x73\x20\x69\x64\x73"});var e=[];return c.forEach(function(a){d.indexOf(a.transactionId)>=0&&e.push(a)}),b.json({success:!0,dapps:e})}):B.getInstalledIds(function(a,d){if(a)return b.json({success:!1,error:"\x43\x61\x6e\x27\x74\x20\x67\x65\x74\x20\x69\x6e\x73\x74\x61\x6c\x6c\x65\x64\x20\x64\x61\x70\x70\x73\x20\x69\x64\x73\x20\x74\x6f\x20\x67\x65\x74\x20\x75\x6e\x69\x6e\x73\x74\x61\x6c\x6c\x65\x64"});var e=[];return c.forEach(function(a){d.indexOf(a.transactionId)<0&&e.push(a)}),b.json({success:!0,dapps:e})}))}),void 0):b.json({success:!0,dapps:[]})})})})})}),a.post("\x2f\x69\x6e\x73\x74\x61\x6c\x6c",function(a,b,c){a.sanitize(a.body,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{id:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1},master:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1}},required:["\x69\x64"]},function(a,d,e){return a?c(a):d.isValid?z.config.dapp.masterpassword&&e.master!==z.config.dapp.masterpassword?b.json({success:!1,error:"\x49\x6e\x63\x6f\x72\x72\x65\x63\x74\x20\x6d\x61\x73\x74\x65\x72\x20\x70\x61\x73\x73\x77\x6f\x72\x64"}):void B.get(e.id,function(a,c){return a?b.json({success:!1,error:a}):void B.getInstalledIds(function(a,d){return a?b.json({success:!1,error:a}):d.indexOf(e.id)>=0?b.json({success:!1,error:"\x54\x68\x69\x73\x20\x64\x61\x70\x70\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x69\x6e\x73\x74\x61\x6c\x6c\x65\x64"}):B.removing[e.id]||B.loading[e.id]?b.json({success:!1,error:"\x54\x68\x69\x73\x20\x44\x41\x70\x70\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x6f\x6e\x20\x64\x6f\x77\x6e\x6c\x6f\x61\x64\x69\x6e\x67\x2f\x72\x65\x6d\x6f\x76\x69\x6e\x67"}):(B.loading[e.id]=!0,void B.downloadDApp(c,function(a,d){return a?(B.loading[e.id]=!1,b.json({success:!1,error:a})):0!=c.type?(z.network.io.sockets.emit("\x64\x61\x70\x70\x73\x2f\x63\x68\x61\x6e\x67\x65",{}),B.loading[e.id]=!1,b.json({success:!0,path:d})):void B.installDependencies(c,function(a){return a?(z.logger.error(a),B.removing[e.id]=!0,B.removeDApp(c,function(a){return B.removing[e.id]=!1,a&&z.logger.error(a),B.loading[e.id]=!1,b.json({success:!1,error:"\x43\x61\x6e\x27\x74\x20\x69\x6e\x73\x74\x61\x6c\x6c\x20\x44\x41\x70\x70\x20\x64\x65\x70\x65\x6e\x64\x65\x6e\x63\x69\x65\x73\x2c\x20\x63\x68\x65\x63\x6b\x20\x6c\x6f\x67\x73"})}),void 0):(z.network.io.sockets.emit("\x64\x61\x70\x70\x73\x2f\x63\x68\x61\x6e\x67\x65",{}),B.loading[e.id]=!1,b.json({success:!0,path:d}))})}))})}):b.json({success:!1,error:d.issues})})}),a.get("\x2f\x69\x6e\x73\x74\x61\x6c\x6c\x65\x64",function(a,b){B.getInstalledIds(function(a,c){return a?(z.logger.error(a),b.json({success:!1,error:"\x43\x61\x6e\x27\x74\x20\x67\x65\x74\x20\x69\x6e\x73\x74\x61\x6c\x6c\x65\x64\x20\x64\x61\x70\x70\x73\x20\x69\x64\x2c\x20\x73\x65\x65\x20\x6c\x6f\x67\x73"})):0==c.length?b.json({success:!0,dapps:[]}):void B.getByIds(c,function(a,c){return a?(z.logger.error(a),b.json({success:!1,error:"\x43\x61\x6e\x27\x74\x20\x67\x65\x74\x20\x69\x6e\x73\x74\x61\x6c\x6c\x65\x64\x20\x64\x61\x70\x70\x73\x2c\x20\x73\x65\x65\x20\x6c\x6f\x67\x73"})):b.json({success:!0,dapps:c})})})}),a.get("\x2f\x69\x6e\x73\x74\x61\x6c\x6c\x65\x64\x49\x64\x73",function(a,b){B.getInstalledIds(function(a,c){return a?(z.logger.error(a),b.json({success:!1,error:"\x43\x61\x6e\x27\x74\x20\x67\x65\x74\x20\x69\x6e\x73\x74\x61\x6c\x6c\x65\x64\x20\x64\x61\x70\x70\x73\x20\x69\x64\x73\x2c\x20\x73\x65\x65\x20\x6c\x6f\x67\x73"})):b.json({success:!0,ids:c})})}),a.get("\x2f\x69\x73\x6d\x61\x73\x74\x65\x72\x70\x61\x73\x73\x77\x6f\x72\x64\x65\x6e\x61\x62\x6c\x65\x64",function(a,b){return b.json({success:!0,enabled:!!z.config.dapp.masterpassword})}),a.post("\x2f\x75\x6e\x69\x6e\x73\x74\x61\x6c\x6c",function(a,b,c){a.sanitize(a.body,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{id:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1},master:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1}},required:["\x69\x64"]},function(a,d,e){return a?c(a):d.isValid?z.config.dapp.masterpassword&&e.master!==z.config.dapp.masterpassword?b.json({success:!1,error:"\x49\x6e\x63\x6f\x72\x72\x65\x63\x74\x20\x6d\x61\x73\x74\x65\x72\x20\x70\x61\x73\x73\x77\x6f\x72\x64"}):void B.get(e.id,function(a,c){return a?b.json({success:!1,error:a}):B.removing[e.id]||B.loading[e.id]?b.json({success:!0,error:"\x54\x68\x69\x73\x20\x44\x41\x70\x70\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x6f\x6e\x20\x75\x6e\x69\x6e\x73\x74\x61\x6c\x6c\x2f\x6c\x6f\x61\x64\x69\x6e\x67"}):(B.removing[e.id]=!0,void(B.launched[e.id]?B.stop(c,function(a){return a?(z.logger.error(a),b.json({success:!1,error:"\x43\x61\x6e\x27\x74\x20\x73\x74\x6f\x70\x20\x64\x61\x70\x70\x2c\x20\x63\x68\x65\x63\x6b\x20\x6c\x6f\x67\x73"})):(B.launched[e.id]=!1,void B.removeDApp(c,function(a){return B.removing[e.id]=!1,a?b.json({success:!1,error:a}):(z.network.io.sockets.emit("\x64\x61\x70\x70\x73\x2f\x63\x68\x61\x6e\x67\x65",{}),b.json({success:!0}))}))}):B.removeDApp(c,function(a){return B.removing[e.id]=!1,a?b.json({success:!1,error:a}):(z.network.io.sockets.emit("\x64\x61\x70\x70\x73\x2f\x63\x68\x61\x6e\x67\x65",{}),b.json({success:!0}))})))}):b.json({success:!1,error:d.issues})})}),a.post("\x2f\x6c\x61\x75\x6e\x63\x68",function(a,b){return z.config.dapp.masterpassword&&a.body.master!==z.config.dapp.masterpassword?b.json({success:!1,error:"\x49\x6e\x63\x6f\x72\x72\x65\x63\x74\x20\x6d\x61\x73\x74\x65\x72\x20\x70\x61\x73\x73\x77\x6f\x72\x64"}):void B.launch(a.body,function(a){return a?b.json({success:!1,error:a}):(z.network.io.sockets.emit("\x64\x61\x70\x70\x73\x2f\x63\x68\x61\x6e\x67\x65",{}),void b.json({success:!0}))})}),a.get("\x2f\x73\x69\x61\x65\x6e\x61\x62\x6c\x65\x64",function(a,b){return b.json({success:!0,enabled:!!z.config.sia.peer})}),a.get("\x2f\x69\x6e\x73\x74\x61\x6c\x6c\x69\x6e\x67",function(a,b){var e,d=[];for(e in B.loading)B.loading[e]&&d.push(e);return b.json({success:!0,installing:d})}),a.get("\x2f\x72\x65\x6d\x6f\x76\x69\x6e\x67",function(a,b){var e,d=[];for(e in B.removing)B.removing[e]&&d.push(e);return b.json({success:!0,removing:d})}),a.get("\x2f\x6c\x61\x75\x6e\x63\x68\x65\x64",function(a,b){var e,d=[];for(e in B.launched)B.launched[e]&&d.push(e);return b.json({success:!0,launched:d})}),a.get("\x2f\x63\x61\x74\x65\x67\x6f\x72\x69\x65\x73",function(a,b){return b.json({success:!0,categories:f})}),a.post("\x2f\x73\x74\x6f\x70",function(a,b,c){a.sanitize(a.body,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{id:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1},master:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1}},required:["\x69\x64"]},function(a,d,e){return a?c(a):d.isValid?B.launched[e.id]?z.config.dapp.masterpassword&&e.master!==z.config.dapp.masterpassword?b.json({success:!1,error:"\x49\x6e\x63\x6f\x72\x72\x65\x63\x74\x20\x6d\x61\x73\x74\x65\x72\x20\x70\x61\x73\x73\x77\x6f\x72\x64"}):void B.get(e.id,function(a,c){return a?(z.logger.error(a),b.json({success:!1,error:"\x43\x61\x6e\x27\x74\x20\x66\x69\x6e\x64\x20\x64\x61\x70\x70"})):void B.stop(c,function(a){return a?(z.logger.error(a),b.json({success:!1,error:"\x43\x61\x6e\x27\x74\x20\x73\x74\x6f\x70\x20\x64\x61\x70\x70\x2c\x20\x63\x68\x65\x63\x6b\x20\x6c\x6f\x67\x73"})):(z.network.io.sockets.emit("\x64\x61\x70\x70\x73\x2f\x63\x68\x61\x6e\x67\x65",{}),B.launched[e.id]=!1,b.json({success:!0}))})}):b.json({success:!1,error:"\x44\x41\x70\x70\x20\x6e\x6f\x74\x20\x6c\x61\x75\x6e\x63\x68\x65\x64"}):b.json({success:!1,error:d.issues})})}),a.get("\x2f\x66\x69\x6c\x65",function(a,b,c){a.sanitize(a.query,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{id:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1}},required:["\x69\x64"]},function(a,d,e){return a?c(a):d.isValid?void B.get(e.id,function(a,c){return a?b.json({success:!1,error:a}):c.siaIcon?void B.getFile(c,b):b.json({success:!1,error:"\x54\x68\x69\x73\x20\x64\x61\x70\x70\x20\x64\x6f\x6e\x27\x74\x20\x68\x61\x76\x65\x20\x73\x69\x61\x20\x69\x63\x6f\x6e\x2e"})}):b.json({success:!1,error:d.issues})})}),a.get("\x2f\x69\x63\x6f\x6e",function(a,b,c){a.sanitize(a.query,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{id:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1}},required:["\x69\x64"]},function(a,d,e){return a?c(a):d.isValid?void B.get(e.id,function(a,c){return a?b.json({success:!1,error:a}):c.siaIcon?void B.getIcon(c,b):b.json({success:!1,error:"\x54\x68\x69\x73\x20\x64\x61\x70\x70\x20\x64\x6f\x6e\x27\x74\x20\x68\x61\x76\x65\x20\x73\x69\x61\x20\x69\x63\x6f\x6e\x2e"})}):b.json({success:!1,error:d.issues})})}),a.map(B,{"put /transaction":"\x61\x64\x64\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73"}),z.network.app.use("\x2f\x61\x70\x69\x2f\x64\x61\x70\x70\x73",a),z.network.app.use(function(a,b,c,d){return a?(z.logger.error(b.url,""+a),void c.status(500).send({success:!1,error:""+a})):d()})},B.get=function(a,b){z.dbLite.query("\x53\x45\x4c\x45\x43\x54\x20\x6e\x61\x6d\x65\x2c\x20\x64\x65\x73\x63\x72\x69\x70\x74\x69\x6f\x6e\x2c\x20\x74\x61\x67\x73\x2c\x20\x73\x69\x61\x41\x73\x63\x69\x69\x2c\x20\x73\x69\x61\x49\x63\x6f\x6e\x2c\x20\x67\x69\x74\x2c\x20\x74\x79\x70\x65\x2c\x20\x63\x61\x74\x65\x67\x6f\x72\x79\x2c\x20\x69\x63\x6f\x6e\x2c\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x20\x46\x52\x4f\x4d\x20\x64\x61\x70\x70\x73\x20\x57\x48\x45\x52\x45\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x20\x3d\x20\x24\x69\x64",{id:a},["\x6e\x61\x6d\x65","\x64\x65\x73\x63\x72\x69\x70\x74\x69\x6f\x6e","\x74\x61\x67\x73","\x73\x69\x61\x41\x73\x63\x69\x69","\x73\x69\x61\x49\x63\x6f\x6e","\x67\x69\x74","\x74\x79\x70\x65","\x63\x61\x74\x65\x67\x6f\x72\x79","\x69\x63\x6f\x6e","\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64"],function(a,c){return a||0==c.length?setImmediate(b,a?"\x44\x61\x74\x61\x62\x61\x73\x65\x20\x65\x72\x72\x6f\x72":"\x44\x41\x70\x70\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64"):setImmediate(b,null,c[0])})},B.getByIds=function(a,b){for(var c=0;c<a.length;c++)a[c]="\x27"+a[c]+"\x27";z.dbLite.query("\x53\x45\x4c\x45\x43\x54\x20\x6e\x61\x6d\x65\x2c\x20\x64\x65\x73\x63\x72\x69\x70\x74\x69\x6f\x6e\x2c\x20\x74\x61\x67\x73\x2c\x20\x73\x69\x61\x41\x73\x63\x69\x69\x2c\x20\x73\x69\x61\x49\x63\x6f\x6e\x2c\x20\x67\x69\x74\x2c\x20\x74\x79\x70\x65\x2c\x20\x63\x61\x74\x65\x67\x6f\x72\x79\x2c\x20\x69\x63\x6f\x6e\x2c\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x20\x46\x52\x4f\x4d\x20\x64\x61\x70\x70\x73\x20\x57\x48\x45\x52\x45\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x20\x49\x4e\x20\x28"+a.join("\x2c")+"\x29",{},["\x6e\x61\x6d\x65","\x64\x65\x73\x63\x72\x69\x70\x74\x69\x6f\x6e","\x74\x61\x67\x73","\x73\x69\x61\x41\x73\x63\x69\x69","\x73\x69\x61\x49\x63\x6f\x6e","\x67\x69\x74","\x74\x79\x70\x65","\x63\x61\x74\x65\x67\x6f\x72\x79","\x69\x63\x6f\x6e","\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64"],function(a,c){return a?setImmediate(b,a?"\x44\x61\x74\x61\x62\x61\x73\x65\x20\x65\x72\x72\x6f\x72":"\x44\x41\x70\x70\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64"):setImmediate(b,null,c)})},B.list=function(a,b){var g,h,i,j,c=["\x74\x79\x70\x65","\x6e\x61\x6d\x65","\x63\x61\x74\x65\x67\x6f\x72\x79","\x67\x69\x74"],d={},e=[];if(a.type>=0&&(e.push("\x74\x79\x70\x65\x20\x3d\x20\x24\x74\x79\x70\x65"),d.type=a.type),a.name&&(e.push("\x6e\x61\x6d\x65\x20\x3d\x20\x24\x6e\x61\x6d\x65"),d.name=a.name),a.category){if(g=f[a.category],null===g||void 0===g)return setImmediate(b,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x64\x61\x70\x70\x20\x63\x61\x74\x65\x67\x6f\x72\x79");e.push("\x63\x61\x74\x65\x67\x6f\x72\x79\x20\x3d\x20\x24\x63\x61\x74\x65\x67\x6f\x72\x79"),d.category=g}return a.git&&(e.push("\x67\x69\x74\x20\x3d\x20\x24\x67\x69\x74"),d.git=a.git),a.limit||0==a.limit||(a.limit=100),a.offset||0==a.offset||(a.offset=0),a.limit>=0&&(d.limit=a.limit),a.offset>=0&&(d.offset=a.offset),a.orderBy&&(h=a.orderBy.split("\x3a"),i=h[0].replace(/[^\w_]/gi,""),j=2==h.length?"\x64\x65\x73\x63"==h[1]?"\x64\x65\x73\x63":"\x61\x73\x63":"\x64\x65\x73\x63"),i&&c.indexOf(i)<0?b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x6f\x72\x74\x20\x66\x69\x65\x6c\x64"):void z.dbLite.query("\x73\x65\x6c\x65\x63\x74\x20\x6e\x61\x6d\x65\x2c\x20\x64\x65\x73\x63\x72\x69\x70\x74\x69\x6f\x6e\x2c\x20\x74\x61\x67\x73\x2c\x20\x73\x69\x61\x41\x73\x63\x69\x69\x2c\x20\x73\x69\x61\x49\x63\x6f\x6e\x2c\x20\x67\x69\x74\x2c\x20\x74\x79\x70\x65\x2c\x20\x63\x61\x74\x65\x67\x6f\x72\x79\x2c\x20\x69\x63\x6f\x6e\x2c\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x20\x66\x72\x6f\x6d\x20\x64\x61\x70\x70\x73\x20"+(e.length?"\x77\x68\x65\x72\x65\x20"+e.join("\x20\x6f\x72\x20")+"\x20":"")+(a.orderBy?"\x6f\x72\x64\x65\x72\x20\x62\x79\x20"+i+"\x20"+j:"")+"\x20"+(a.limit?"\x6c\x69\x6d\x69\x74\x20\x24\x6c\x69\x6d\x69\x74":"")+"\x20"+(a.offset?"\x6f\x66\x66\x73\x65\x74\x20\x24\x6f\x66\x66\x73\x65\x74":""),d,{name:String,description:String,tags:String,siaAscii:String,siaIcon:String,git:String,type:Number,category:Number,icon:String,transactionId:String},function(a,c){return a?b(a):void b(null,c)})},B.createBasePathes=function(a){d.series([function(a){var b=k.join(z["\x70\x75\x62\x6c\x69\x63"],"\x69\x6d\x61\x67\x65\x73","\x64\x61\x70\x70\x73");i.exists(b,function(c){return c?setImmediate(a):void i.mkdir(b,a)})},function(a){i.exists(B.dappsPath,function(b){return b?setImmediate(a):void i.mkdir(B.dappsPath,a)})},function(a){var b=k.join(B.appPath,"\x70\x75\x62\x6c\x69\x63","\x64\x61\x70\x70\x73");i.exists(b,function(c){return c?setImmediate(a):void i.mkdir(b,a)})}],function(b){return setImmediate(a,b)})},B.installDependencies=function(a,b){var c=k.join(B.dappsPath,a.transactionId),d=k.join(c,"\x70\x61\x63\x6b\x61\x67\x65\x2e\x6a\x73\x6f\x6e"),e=null;try{e=JSON.parse(i.readFileSync(d))}catch(f){return setImmediate(b,"\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x6f\x70\x65\x6e\x20\x70\x61\x63\x6b\x61\x67\x65\x2e\x6a\x73\x6f\x6e\x20\x66\x69\x6c\x65\x20\x66\x6f\x72\x3a\x20"+a.transactionId)}l.load(e,function(a){return a?setImmediate(b,a):(l.root=k.join(c,"\x6e\x6f\x64\x65\x5f\x6d\x6f\x64\x75\x6c\x65\x73"),l.prefix=c,void l.commands.install(function(a){return a?void setImmediate(b,a):setImmediate(b,null)}))})},B.getInstalledIds=function(a){i.readdir(B.dappsPath,function(b,c){return b?setImmediate(a,b):void setImmediate(a,null,c)})},B.removeDApp=function(a,b){function e(a){a&&z.logger.error("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x75\x6e\x69\x6e\x73\x74\x61\x6c\x6c\x20\x64\x61\x70\x70\x3a\x20"+a),t(d,function(a){return a?setImmediate(b,"\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x72\x65\x6d\x6f\x76\x65\x20\x64\x61\x70\x70\x20\x66\x6f\x6c\x64\x65\x72\x3a\x20"+a):b()})}var d=k.join(B.dappsPath,a.transactionId);i.exists(d,function(f){if(!f)return setImmediate(b,"\x44\x61\x70\x70\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64");try{var g=c(k.join(d,"\x62\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x2e\x6a\x73\x6f\x6e"))}catch(h){return e(""+h)}y.sql.dropTables(a.transactionId,g,function(a){a&&z.logger.error("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x64\x72\x6f\x70\x20\x64\x61\x70\x70\x20\x74\x61\x62\x6c\x65\x73\x3a\x20"+a),e(a)})})},B.downloadDApp=function(a,b){var c=k.join(B.dappsPath,a.transactionId);i.exists(c,function(d){return d?setImmediate(b,"\x44\x61\x70\x70\x20\x69\x73\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x69\x6e\x73\x74\x61\x6c\x6c\x65\x64"):void i.mkdir(c,function(d){if(d)return setImmediate(b,"\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x63\x72\x65\x61\x74\x65\x20\x64\x61\x70\x70\x20\x66\x6f\x6c\x64\x65\x72\x20\x66\x6f\x72\x3a\x20"+a.transactionId);if(a.git)j.clone(a.git,c,function(d){return d?(z.logger.error(""+d),void t(c,function(c){return c&&z.logger.error(""+c),setImmediate(b,"\x45\x72\x72\x6f\x72\x20\x63\x6c\x6f\x6e\x69\x6e\x67\x20\x67\x69\x74\x20\x72\x65\x70\x6f\x73\x69\x74\x6f\x72\x79\x20"+a.git+"\x20\x61\x74\x20"+a.transactionId)})):setImmediate(b,null,c)});else if(a.siaAscii){z.config.sia.peer||t(c,function(a){return a&&z.logger.error(""+a),setImmediate(b,"\x53\x69\x61\x20\x69\x73\x20\x64\x69\x73\x61\x62\x6c\x65\x64")});var e=k.join(c,a.transactionId+"\x2e\x7a\x69\x70");y.sia.uploadAscii(a.siaAscii,function(d,f){return d?(z.logger.error("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x75\x70\x6c\x6f\x61\x64\x20\x61\x73\x63\x69\x69\x3a\x20"+d),void t(c,function(a){return a&&z.logger.error(""+a),setImmediate(b,"\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x64\x6f\x77\x6e\x6c\x6f\x61\x64\x20\x64\x61\x70\x70\x20\x66\x72\x6f\x6d\x20\x73\x69\x61")})):void y.sia.download(f,e,function(d){if(d)z.logger.error(d),t(c,function(d){return d&&z.logger.error(d),setImmediate(b,"\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x67\x65\x74\x20\x61\x73\x63\x69\x69\x20\x63\x6f\x64\x65\x3a\x20\n"+a.siaAscii+"\x20\n\x20"+c)});else{var f=new o(e);f.on("\x65\x72\x72\x6f\x72",function(a){z.logger.error(a),i.unlink(e,function(a){a&&z.logger.error(a),t(c,function(a){return a&&z.logger.error(a),b("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x75\x6e\x7a\x69\x70\x20\x66\x69\x6c\x65\x3a\x20"+e)})})}),f.on("\x65\x78\x74\x72\x61\x63\x74",function(){i.unlink(e,function(a){return a?b("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x72\x65\x6d\x6f\x76\x65\x20\x7a\x69\x70\x20\x66\x69\x6c\x65\x3a\x20"+e):b(null,c)})}),f.extract({path:c})}})})}})})},B.symlink=function(a,b){var c=k.join(B.dappsPath,a.transactionId),d=k.join(c,"\x70\x75\x62\x6c\x69\x63"),e=k.join(B.appPath,"\x70\x75\x62\x6c\x69\x63","\x64\x61\x70\x70\x73",a.transactionId);i.exists(d,function(a){return a?void i.exists(e,function(a){return a?setImmediate(b):void i.symlink(d,e,b)}):setImmediate(b)})},B.apiHandler=function(a,b){var c,d,e;try{if(c=a.call.split("\x23"),d=c[0],e=c[1],!y[d])return setImmediate(b,"\x49\x6e\x63\x6f\x72\x72\x65\x63\x74\x20\x6d\x6f\x64\x75\x6c\x65\x20\x69\x6e\x20\x63\x61\x6c\x6c\x3a\x20"+a.call);if(!y[d].sandboxApi)return setImmediate(b,"\x54\x68\x69\x73\x20\x6d\x6f\x64\x75\x6c\x65\x20\x64\x6f\x65\x73\x6e\x27\x74\x20\x68\x61\x76\x65\x20\x73\x61\x6e\x64\x62\x6f\x78\x20\x61\x70\x69");y[d].sandboxApi(e,{body:a.args,dappid:a.dappid},b)}catch(f){return setImmediate(b,"\x49\x6e\x63\x6f\x72\x72\x65\x63\x74\x20\x63\x61\x6c\x6c\x20"+f)}},B.getFile=function(a,b){return z.config.sia.peer?void y.sia.uploadAscii(a.transactionId,a.siaAscii,!1,function(a,c){return a?b.json({success:!1,error:"\x49\x6e\x74\x65\x72\x6e\x61\x6c\x20\x65\x72\x72\x6f\x72"}):(b.writeHead(200,{"Content-Type":"\x61\x70\x70\x6c\x69\x63\x61\x74\x69\x6f\x6e\x2f\x76\x6e\x64\x2e\x61\x6e\x64\x72\x6f\x69\x64\x2e\x70\x61\x63\x6b\x61\x67\x65\x2d\x61\x72\x63\x68\x69\x76\x65","Content-Disposition":"\x61\x74\x74\x61\x63\x68\x6d\x65\x6e\x74\x3b\x20\x66\x69\x6c\x65\x6e\x61\x6d\x65\x3d"+c}),void y.sia.download(c,b))}):b.json({success:!1,error:"\x53\x69\x61\x20\x64\x69\x73\x61\x62\x6c\x65\x64"})},B.getIcon=function(a,b){function e(){var a=i.createReadStream(k.join(z["\x70\x75\x62\x6c\x69\x63"],"\x69\x6d\x61\x67\x65\x73","\x73\x69\x61\x65\x72\x72\x6f\x72\x2e\x70\x6e\x67"));a.pipe(b)}var d,c=k.join(z["\x70\x75\x62\x6c\x69\x63"],"\x69\x6d\x61\x67\x65\x73","\x64\x61\x70\x70\x73",a.transactionId);z.config.sia.peer?i.exists(c,function(d){if(d){var f=i.createReadStream(c);f.pipe(b)}else y.sia.uploadAscii(a.siaIcon,function(a,d){return a?(console.log(a),e()):void y.sia.download(d,c,function(a){if(a)return e();var d=i.createReadStream(c);d.pipe(b)})})}):(d=i.createReadStream(k.join(z["\x70\x75\x62\x6c\x69\x63"],"\x69\x6d\x61\x67\x65\x73","\x70\x6c\x61\x63\x65\x68\x6f\x6c\x64\x65\x72\x2e\x70\x6e\x67")),d.pipe(b))},B.dappRoutes=function(a,b){var d=k.join(B.dappsPath,a.transactionId),e=k.join(d,"\x72\x6f\x75\x74\x65\x73\x2e\x6a\x73\x6f\x6e");i.exists(e,function(d){if(d){try{var f=c(e)}catch(g){return setImmediate(b,"\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x6f\x70\x65\x6e\x20\x72\x6f\x75\x74\x65\x73\x2e\x6a\x73\x6f\x6e\x20\x66\x69\x6c\x65\x20\x66\x6f\x72\x3a\x20"+a.transactionId)}return B.routes[a.transactionId]=new n,f.forEach(function(b){("\x67\x65\x74"==b.method||"\x70\x6f\x73\x74"==b.method||"\x70\x75\x74"==b.method)&&B.routes[a.transactionId][b.method](b.path,function(c,d){A.request(a.transactionId,b.method,b.path,"\x67\x65\x74"==b.method?c.query:c.body,function(a,b){!a&&b.error&&(a=b.error),a&&(b={error:""+a}),b.success=!a,d.json(b)})})}),z.network.app.use("\x2f\x61\x70\x69\x2f\x64\x61\x70\x70\x73\x2f"+a.transactionId+"\x2f\x61\x70\x69\x2f",B.routes[a.transactionId]),z.network.app.use(function(a,b,c,d){return a?(z.logger.error(b.url,""+a),void c.status(500).send({success:!1,error:""+a})):d()}),setImmediate(b)}return setImmediate(b)})},B.launch=function(a,b){z.scheme.validate(a,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{params:{type:"\x61\x72\x72\x61\x79",minLength:1},id:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1},master:{type:"\x73\x74\x72\x69\x6e\x67",minLength:0}},required:["\x69\x64"]},function(c){return c?b(c[0].message):B.launched[a.id]?b("\x44\x61\x70\x70\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x6c\x61\x75\x6e\x63\x68\x65\x64"):(a.params=a.params||[""],a.params.length>0&&a.params.push("\x6d\x6f\x64\x75\x6c\x65\x73\x2e\x66\x75\x6c\x6c\x2e\x6a\x73\x6f\x6e"),B.launched[a.id]=!0,void B.get(a.id,function(c,d){return c?(B.launched[a.id]=!1,z.logger.error(c),b("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x66\x69\x6e\x64\x20\x64\x61\x70\x70")):void B.getInstalledIds(function(c,e){return c?(B.launched[a.id]=!1,z.logger.error(c),b("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x67\x65\x74\x20\x69\x6e\x73\x74\x61\x6c\x6c\x65\x64\x20\x64\x61\x70\x70\x73")):e.indexOf(a.id)>=0?void B.symlink(d,function(c){return c?(B.launched[a.id]=!1,z.logger.error(c),b("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x63\x72\x65\x61\x74\x65\x20\x70\x75\x62\x6c\x69\x63\x20\x6c\x69\x6e\x6b\x20\x66\x6f\x72\x3a\x20"+a.id)):void B.launchApp(d,a.params||["","\x6d\x6f\x64\x75\x6c\x65\x73\x2e\x66\x75\x6c\x6c\x2e\x6a\x73\x6f\x6e"],function(c){return c?(B.launched[a.id]=!1,z.logger.error(c),b("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x6c\x61\x75\x6e\x63\x68\x20\x64\x61\x70\x70\x2c\x20\x63\x68\x65\x63\x6b\x20\x6c\x6f\x67\x73\x3a\x20"+a.id)):void B.dappRoutes(d,function(c){return c?(B.launched[a.id]=!1,z.logger.error(c),B.stop(d,function(c){return c?(z.logger.error(c),b("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x73\x74\x6f\x70\x20\x64\x61\x70\x70\x2c\x20\x63\x68\x65\x63\x6b\x20\x6c\x6f\x67\x73\x3a\x20"+a.id)):b("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x6c\x61\x75\x6e\x63\x68\x20\x64\x61\x70\x70")}),void 0):b(null)})})}):(B.launched[a.id]=!1,b("\x44\x61\x70\x70\x20\x6e\x6f\x74\x20\x69\x6e\x73\x74\x61\x6c\x6c\x65\x64"));
})}))})},B.downloadSiaFile=function(a,b,c,d,e){y.sia.uploadAscii(a,b,c,function(a,b){return a?setImmediate(e,a):void y.sia.download(b,d,e)})},B.launchApp=function(a,b,e){var i,f=k.join(B.dappsPath,a.transactionId);k.join(f,"\x70\x75\x62\x6c\x69\x63"),k.join(B.appPath,"\x70\x75\x62\x6c\x69\x63","\x64\x61\x70\x70\x73",a.transactionId);try{i=c(k.join(f,"\x63\x6f\x6e\x66\x69\x67\x2e\x6a\x73\x6f\x6e"))}catch(j){return setImmediate(e,"\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x6f\x70\x65\x6e\x20\x63\x6f\x6e\x66\x69\x67\x2e\x6a\x73\x6f\x6e\x20\x66\x69\x6c\x65\x20\x66\x6f\x72\x3a\x20"+dapp.transactionId)}d.eachSeries(i.peers,function(b,c){y.peer.addDapp({ip:v.toLong(b.ip),port:b.port,dappid:a.transactionId},c)},function(d){if(d)return setImmediate(e,d);try{var g=c(k.join(f,"\x62\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x2e\x6a\x73\x6f\x6e"))}catch(h){return setImmediate(e,"\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x6f\x70\x65\x6e\x20\x62\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x2e\x64\x62\x20\x66\x69\x6c\x65\x20\x66\x6f\x72\x3a\x20"+dapp.transactionId)}y.sql.createTables(a.transactionId,g,function(c){if(c)return setImmediate(e,c);var d=new r(k.join(f,"\x69\x6e\x64\x65\x78\x2e\x6a\x73"),a.transactionId,b,B.apiHandler,!0);return B.sandboxes[a.transactionId]=d,d.on("\x65\x78\x69\x74",function(){z.logger.info("\x44\x61\x70\x70\x20"+a.transactionId+"\x20\x63\x6c\x6f\x73\x65\x64\x20"),B.stop(a,function(a){a&&z.logger.error("\x45\x6e\x63\x6f\x75\x6e\x74\x65\x72\x65\x64\x20\x65\x72\x72\x6f\x72\x20\x77\x68\x69\x6c\x65\x20\x73\x74\x6f\x70\x70\x69\x6e\x67\x20\x64\x61\x70\x70\x3a\x20"+a)})}),d.on("\x65\x72\x72\x6f\x72",function(b){z.logger.info("\x45\x6e\x63\x6f\x75\x6e\x74\x65\x72\x65\x64\x20\x65\x72\x72\x6f\x72\x20\x69\x6e\x20\x64\x61\x70\x70\x20"+a.transactionId+"\x20"+b),B.stop(a,function(a){a&&z.logger.error("\x45\x6e\x63\x6f\x75\x6e\x74\x65\x72\x65\x64\x20\x65\x72\x72\x6f\x72\x20\x77\x68\x69\x6c\x65\x20\x73\x74\x6f\x70\x70\x69\x6e\x67\x20\x64\x61\x70\x70\x3a\x20"+a)})}),d.run(),setImmediate(e)})})},B.stop=function(a,b){var c=k.join(B.appPath,"\x70\x75\x62\x6c\x69\x63","\x64\x61\x70\x70\x73",a.transactionId);d.series([function(a){i.exists(c,function(b){return b?setImmediate(a):void setImmediate(a)})},function(b){B.sandboxes[a.transactionId]&&B.sandboxes[a.transactionId].exit(),delete B.sandboxes[a.transactionId],setImmediate(b)},function(b){delete B.routes[a.transactionId],setImmediate(b)}],function(a){return setImmediate(b,a)})},B.addTransactions=function(a,b){var c=a.body;z.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{secret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:100},amount:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:1,maximum:q.totalAmount},publicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"},secondSecret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:100},dappId:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1},multisigAccountPublicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"}},required:["\x73\x65\x63\x72\x65\x74","\x61\x6d\x6f\x75\x6e\x74","\x64\x61\x70\x70\x49\x64"]},function(a){var d,e,f;return a?b(a[0].message):(d=p.createHash("\x73\x68\x61\x32\x35\x36").update(c.secret,"\x75\x74\x66\x38").digest(),e=s.MakeKeypair(d),c.publicKey&&e.publicKey.toString("\x68\x65\x78")!=c.publicKey?b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65"):(f={},void z.balancesSequence.add(function(a){c.multisigAccountPublicKey&&c.multisigAccountPublicKey!=e.publicKey.toString("\x68\x65\x78")?y.accounts.getAccount({publicKey:c.multisigAccountPublicKey},function(b,d){return b?a(""+b):d&&d.publicKey?d.multisignatures&&d.multisignatures?d.multisignatures.indexOf(e.publicKey.toString("\x68\x65\x78"))<0?a("\x41\x63\x63\x6f\x75\x6e\x74\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x62\x65\x6c\x6f\x6e\x67\x20\x74\x6f\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x67\x72\x6f\x75\x70"):void y.accounts.getAccount({publicKey:e.publicKey},function(b,f){var h,i,j;if(b)return a(""+b);if(!f||!f.publicKey)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x72\x65\x71\x75\x65\x73\x74\x65\x72");if(f.secondSignature&&!c.secondSecret)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x63\x6f\x6e\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65");if(f.publicKey==d.publicKey)return a("\x49\x6e\x63\x6f\x72\x72\x65\x63\x74\x20\x72\x65\x71\x75\x65\x73\x74\x65\x72");h=null,f.secondSignature&&(i=p.createHash("\x73\x68\x61\x32\x35\x36").update(c.secondSecret,"\x75\x74\x66\x38").digest(),h=s.MakeKeypair(i));try{j=z.logic.transaction.create({type:g.IN_TRANSFER,amount:c.amount,sender:d,keypair:e,requester:e,secondKeypair:h,dappId:c.dappId})}catch(k){return a(""+k)}y.transactions.receiveTransactions([j],a)}):a("\x41\x63\x63\x6f\x75\x6e\x74\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x68\x61\x76\x65\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x65\x6e\x61\x62\x6c\x65\x64"):a("\x4d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x61\x63\x63\x6f\x75\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")}):y.accounts.getAccount({publicKey:e.publicKey.toString("\x68\x65\x78")},function(b,d){var f,h,i;if(b)return a(""+b);if(!d||!d.publicKey)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x61\x63\x63\x6f\x75\x6e\x74");if(d.secondSignature&&!c.secondSecret)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x63\x6f\x6e\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65");f=null,d.secondSignature&&(h=p.createHash("\x73\x68\x61\x32\x35\x36").update(c.secondSecret,"\x75\x74\x66\x38").digest(),f=s.MakeKeypair(h));try{i=z.logic.transaction.create({type:g.IN_TRANSFER,amount:c.amount,sender:d,keypair:e,secondKeypair:f,dappId:c.dappId})}catch(j){return a(""+j)}y.transactions.receiveTransactions([i],a)})},function(a,c){return a?b(""+a):void b(null,{transactionId:c[0].id})})))})},H.prototype.sandboxApi=function(a,b,c){x.callMethod(C,a,b,c)},H.prototype.message=function(a,b,c){A.request(a,"\x70\x6f\x73\x74","\x2f\x6d\x65\x73\x73\x61\x67\x65",b,c)},H.prototype.request=function(a,b,c,d,e){return B.sandboxes[a]?B.dappready[a]?void B.sandboxes[a].sendMessage({method:b,path:c,query:d},e):e("\x44\x61\x70\x70\x20\x6e\x6f\x74\x20\x72\x65\x61\x64\x79"):e("\x44\x61\x70\x70\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")},H.prototype.onBind=function(a){y=a},H.prototype.onBlockchainReady=function(){z.config.dapp&&d.eachSeries(z.config.dapp.autoexec||[],function(a,b){B.launch({params:a.params,id:a.dappid,master:z.config.dapp.masterpassword},function(c){console.log("\x4c\x61\x75\x6e\x63\x68\x65\x64\x20"+a.dappid,c||"\x73\x75\x63\x63\x65\x73\x73\x66\x75\x6c\x6c\x79"),b()})})},H.prototype.onDeleteBlocksBefore=function(a){Object.keys(B.sandboxes).forEach(function(b){A.request(b,"\x70\x6f\x73\x74","\x2f\x6d\x65\x73\x73\x61\x67\x65",{topic:"\x72\x6f\x6c\x6c\x62\x61\x63\x6b",message:{pointId:a.id,pointHeight:a.height}},function(a){a&&z.logger.error("\x6f\x6e\x44\x65\x6c\x65\x74\x65\x42\x6c\x6f\x63\x6b\x73\x42\x65\x66\x6f\x72\x65\x20\x6d\x65\x73\x73\x61\x67\x65",a)})})},H.prototype.onNewBlock=function(a,b){Object.keys(B.sandboxes).forEach(function(c){b&&A.request(c,"\x70\x6f\x73\x74","\x2f\x6d\x65\x73\x73\x61\x67\x65",{topic:"\x70\x6f\x69\x6e\x74",message:{id:a.id,height:a.height}},function(a){a&&z.logger.error("\x6f\x6e\x4e\x65\x77\x42\x6c\x6f\x63\x6b\x20\x6d\x65\x73\x73\x61\x67\x65",a)})})},C.getGenesis=function(a,b){z.dbLite.query("\x53\x45\x4c\x45\x43\x54\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x2c\x20\x62\x2e\x69\x64\x2c\x20\x47\x52\x4f\x55\x50\x5f\x43\x4f\x4e\x43\x41\x54\x28\x6d\x2e\x64\x65\x70\x65\x6e\x64\x65\x6e\x74\x49\x64\x29\x2c\x20\x74\x2e\x73\x65\x6e\x64\x65\x72\x49\x64\x20\x46\x52\x4f\x4d\x20\x74\x72\x73\x20\x74\x20\x69\x6e\x6e\x65\x72\x20\x6a\x6f\x69\x6e\x20\x62\x6c\x6f\x63\x6b\x73\x20\x62\x20\x6f\x6e\x20\x74\x2e\x62\x6c\x6f\x63\x6b\x49\x64\x20\x3d\x20\x62\x2e\x69\x64\x20\x61\x6e\x64\x20\x74\x2e\x69\x64\x20\x3d\x20\x24\x69\x64\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x32\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x6d\x20\x6f\x6e\x20\x6d\x2e\x61\x63\x63\x6f\x75\x6e\x74\x49\x64\x20\x3d\x20\x74\x2e\x73\x65\x6e\x64\x65\x72\x49\x64\x20\x61\x6e\x64\x20\x74\x2e\x69\x64\x20\x3d\x20\x24\x69\x64",{id:a.dappid},{height:Number,id:String,multisignature:String,authorId:String},function(c,d){return c||0==d.length?b("\x44\x61\x74\x61\x62\x61\x73\x65\x20\x65\x72\x72\x6f\x72"):void b(null,{pointId:d[0].id,pointHeight:d[0].height,authorId:d[0].authorId,dappid:a.dappid,associate:d[0].multisignature?d[0].multisignature.split("\x2c"):[]})})},C.setReady=function(a,b){B.dappready[a.dappid]=!0,b(null,{})},C.getCommonBlock=function(a,b){z.dbLite.query("\x53\x45\x4c\x45\x43\x54\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x2c\x20\x74\x2e\x69\x64\x2c\x20\x74\x2e\x73\x65\x6e\x64\x65\x72\x49\x64\x2c\x20\x74\x2e\x61\x6d\x6f\x75\x6e\x74\x20\x46\x52\x4f\x4d\x20\x74\x72\x73\x20\x74\x20\x69\x6e\x6e\x65\x72\x20\x6a\x6f\x69\x6e\x20\x62\x6c\x6f\x63\x6b\x73\x20\x62\x20\x6f\x6e\x20\x74\x2e\x62\x6c\x6f\x63\x6b\x49\x64\x20\x3d\x20\x62\x2e\x69\x64\x20\x61\x6e\x64\x20\x74\x2e\x69\x64\x20\x3d\x20\x24\x69\x64\x20\x61\x6e\x64\x20\x74\x2e\x74\x79\x70\x65\x20\x3d\x20\x24\x74\x79\x70\x65\x69\x6e\x6e\x65\x72\x20\x6a\x6f\x69\x6e\x20\x69\x6e\x74\x72\x61\x6e\x73\x66\x65\x72\x20\x64\x74\x20\x6f\x6e\x20\x64\x74\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x20\x3d\x20\x74\x2e\x69\x64\x20\x61\x6e\x64\x20\x64\x74\x2e\x64\x61\x70\x70\x69\x64\x20\x3d\x20\x24\x64\x61\x70\x70\x69\x64",{dappid:a.dappid,type:g.IN_TRANSFER},{height:Number,id:String,senderId:String,amount:String},function(a,c){return a?b("\x44\x61\x74\x61\x62\x61\x73\x65\x20\x65\x72\x72\x6f\x72"):void b(null,c)})},C.sendWithdrawal=function(a,b){var c=a.body;z.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{secret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:100},amount:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:1,maximum:q.totalAmount},recipientId:{type:"\x73\x74\x72\x69\x6e\x67",minLength:2,maxLength:21},secondSecret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:100},transactionId:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:20},multisigAccountPublicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"}},required:["\x73\x65\x63\x72\x65\x74","\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x49\x64","\x61\x6d\x6f\x75\x6e\x74","\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64"]},function(d){var e,f,h,i;return d?b(d[0].message):(e=p.createHash("\x73\x68\x61\x32\x35\x36").update(c.secret,"\x75\x74\x66\x38").digest(),f=s.MakeKeypair(e),h={},i=/^[0-9]+[L|l]$/g,i.test(c.recipientId)?void z.balancesSequence.add(function(b){c.multisigAccountPublicKey&&c.multisigAccountPublicKey!=f.publicKey.toString("\x68\x65\x78")?y.accounts.getAccount({publicKey:c.multisigAccountPublicKey},function(d,e){return d?b(""+d):e&&e.publicKey?e.multisignatures&&e.multisignatures?e.multisignatures.indexOf(f.publicKey.toString("\x68\x65\x78"))<0?b("\x41\x63\x63\x6f\x75\x6e\x74\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x62\x65\x6c\x6f\x6e\x67\x20\x74\x6f\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x67\x72\x6f\x75\x70"):void y.accounts.getAccount({publicKey:f.publicKey},function(d,h){var i,j,k;if(d)return b(""+d);if(!h||!h.publicKey)return b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x72\x65\x71\x75\x65\x73\x74\x65\x72");if(h.secondSignature&&!c.secondSecret)return b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x63\x6f\x6e\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65");if(h.publicKey==e.publicKey)return b("\x49\x6e\x63\x6f\x72\x72\x65\x63\x74\x20\x72\x65\x71\x75\x65\x73\x74\x65\x72");i=null,h.secondSignature&&(j=p.createHash("\x73\x68\x61\x32\x35\x36").update(c.secondSecret,"\x75\x74\x66\x38").digest(),i=s.MakeKeypair(j));try{k=z.logic.transaction.create({type:g.OUT_TRANSFER,amount:c.amount,sender:e,recipientId:c.recipientId,keypair:f,secondKeypair:i,requester:f,dappId:a.dappid,transactionId:c.transactionId})}catch(l){return b(""+l)}y.transactions.receiveTransactions([k],b)}):b("\x41\x63\x63\x6f\x75\x6e\x74\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x68\x61\x76\x65\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x65\x6e\x61\x62\x6c\x65\x64"):b("\x4d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x61\x63\x63\x6f\x75\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")}):y.accounts.getAccount({publicKey:f.publicKey.toString("\x68\x65\x78")},function(d,e){var h,i,j;if(d)return b(""+d);if(!e||!e.publicKey)return b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x61\x63\x63\x6f\x75\x6e\x74");if(e.secondSignature&&!c.secondSecret)return b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x63\x6f\x6e\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65");h=null,e.secondSignature&&(i=p.createHash("\x73\x68\x61\x32\x35\x36").update(c.secondSecret,"\x75\x74\x66\x38").digest(),h=s.MakeKeypair(i));try{j=z.logic.transaction.create({type:g.OUT_TRANSFER,amount:c.amount,sender:e,recipientId:c.recipientId,keypair:f,secondKeypair:h,dappId:a.dappid,transactionId:c.transactionId})}catch(k){return b(""+k)}y.transactions.receiveTransactions([j],b)})},function(a,c){return a?b(""+a):void b(null,{transactionId:c[0].id})}):b("\x49\x6e\x63\x6f\x72\x72\x65\x63\x74\x20\x61\x64\x64\x72\x65\x73\x73"))})},C.getWithdrawalLastTransaction=function(a,b){z.dbLite.query("\x53\x45\x4c\x45\x43\x54\x20\x6f\x74\x2e\x6f\x75\x74\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x20\x46\x52\x4f\x4d\x20\x74\x72\x73\x20\x74\x20\x69\x6e\x6e\x65\x72\x20\x6a\x6f\x69\x6e\x20\x62\x6c\x6f\x63\x6b\x73\x20\x62\x20\x6f\x6e\x20\x74\x2e\x62\x6c\x6f\x63\x6b\x49\x64\x20\x3d\x20\x62\x2e\x69\x64\x20\x61\x6e\x64\x20\x74\x2e\x74\x79\x70\x65\x20\x3d\x20\x24\x74\x79\x70\x65\x20\x69\x6e\x6e\x65\x72\x20\x6a\x6f\x69\x6e\x20\x6f\x75\x74\x74\x72\x61\x6e\x73\x66\x65\x72\x20\x6f\x74\x20\x6f\x6e\x20\x6f\x74\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x20\x3d\x20\x74\x2e\x69\x64\x20\x61\x6e\x64\x20\x6f\x74\x2e\x64\x61\x70\x70\x69\x64\x20\x3d\x20\x24\x64\x61\x70\x70\x69\x64\x20\x6f\x72\x64\x65\x72\x20\x62\x79\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x20\x64\x65\x73\x63\x20\x6c\x69\x6d\x69\x74\x20\x31",{dappid:a.dappid,type:g.OUT_TRANSFER},{id:String},function(a,c){return a?b("\x44\x61\x74\x61\x62\x61\x73\x65\x20\x65\x72\x72\x6f\x72"):void b(null,c[0])})},C.getBalanceTransactions=function(a,b){z.dbLite.query("\x53\x45\x4c\x45\x43\x54\x20\x74\x2e\x69\x64\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x74\x2e\x73\x65\x6e\x64\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x29\x2c\x20\x74\x2e\x61\x6d\x6f\x75\x6e\x74\x20\x46\x52\x4f\x4d\x20\x74\x72\x73\x20\x74\x20\x69\x6e\x6e\x65\x72\x20\x6a\x6f\x69\x6e\x20\x62\x6c\x6f\x63\x6b\x73\x20\x62\x20\x6f\x6e\x20\x74\x2e\x62\x6c\x6f\x63\x6b\x49\x64\x20\x3d\x20\x62\x2e\x69\x64\x20\x61\x6e\x64\x20\x74\x2e\x74\x79\x70\x65\x20\x3d\x20\x24\x74\x79\x70\x65\x20\x69\x6e\x6e\x65\x72\x20\x6a\x6f\x69\x6e\x20\x69\x6e\x74\x72\x61\x6e\x73\x66\x65\x72\x20\x64\x74\x20\x6f\x6e\x20\x64\x74\x2e\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x20\x3d\x20\x74\x2e\x69\x64\x20\x61\x6e\x64\x20\x64\x74\x2e\x64\x61\x70\x70\x69\x64\x20\x3d\x20\x24\x64\x61\x70\x70\x69\x64\x20"+(a.body.lastTransactionId?"\x77\x68\x65\x72\x65\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x20\x3e\x20\x28\x73\x65\x6c\x65\x63\x74\x20\x68\x65\x69\x67\x68\x74\x20\x66\x72\x6f\x6d\x20\x62\x6c\x6f\x63\x6b\x73\x20\x69\x62\x20\x69\x6e\x6e\x65\x72\x20\x6a\x6f\x69\x6e\x20\x74\x72\x73\x20\x69\x74\x20\x6f\x6e\x20\x69\x62\x2e\x69\x64\x20\x3d\x20\x69\x74\x2e\x62\x6c\x6f\x63\x6b\x49\x64\x20\x61\x6e\x64\x20\x69\x74\x2e\x69\x64\x20\x3d\x20\x24\x6c\x61\x73\x74\x49\x64\x29\x20":"")+"\x6f\x72\x64\x65\x72\x20\x62\x79\x20\x62\x2e\x68\x65\x69\x67\x68\x74",{dappid:a.dappid,type:g.IN_TRANSFER,lastId:a.body.lastTransactionId},{id:String,senderPublicKey:String,amount:Number},function(a,c){return a?b("\x44\x61\x74\x61\x62\x61\x73\x65\x20\x65\x72\x72\x6f\x72"):void b(null,c)})},a.exports=H}),c.register("\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x64\x65\x6c\x65\x67\x61\x74\x65\x73\x2e\x6a\x73",function(a,b,c){function v(){this.create=function(a,b){return b.recipientId=null,b.amount=0,b.asset.delegate={username:a.username||a.sender.username,publicKey:a.sender.publicKey},b},this.calculateFee=function(){return 100*m.fixedPoint},this.verify=function(a,b,c){var d,e;if(a.recipientId)return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x72\x65\x63\x69\x70\x69\x65\x6e\x74");if(0!=a.amount)return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x61\x6d\x6f\x75\x6e\x74");if(b.username){if(a.asset.delegate.username&&a.asset.delegate.username!=b.username)return c("\x41\x63\x63\x6f\x75\x6e\x74\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x68\x61\x73\x20\x61\x20\x75\x73\x65\x72\x6e\x61\x6d\x65")}else{if(!a.asset.delegate.username)return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x61\x73\x73\x65\x74");if(d=/^[a-z0-9!@$&_.]+$/g,!d.test(a.asset.delegate.username.toLowerCase()))return setImmediate(c,"\x55\x73\x65\x72\x6e\x61\x6d\x65\x20\x63\x6f\x6e\x74\x61\x69\x6e\x73\x20\x69\x6e\x76\x61\x6c\x69\x64\x20\x63\x68\x61\x72\x61\x63\x74\x65\x72\x73");if(e=/^[0-9]+[L|l]$/g,e.test(a.asset.delegate.username))return setImmediate(c,"\x55\x73\x65\x72\x6e\x61\x6d\x65\x20\x63\x61\x6e\x6e\x6f\x74\x20\x62\x65\x20\x61\x20\x70\x6f\x74\x65\x6e\x74\x69\x61\x6c\x20\x61\x64\x64\x72\x65\x73\x73");if(a.asset.delegate.username.length<1)return setImmediate(c,"\x55\x73\x65\x72\x6e\x61\x6d\x65\x20\x69\x73\x20\x74\x6f\x6f\x20\x73\x68\x6f\x72\x74\x2e\x20\x4d\x69\x6e\x69\x6d\x75\x6d\x20\x69\x73\x20\x31\x20\x63\x68\x61\x72\x61\x63\x74\x65\x72");if(a.asset.delegate.username.length>20)return setImmediate(c,"\x55\x73\x65\x72\x6e\x61\x6d\x65\x20\x69\x73\x20\x74\x6f\x6f\x20\x6c\x6f\x6e\x67\x2e\x20\x4d\x61\x78\x69\x6d\x75\x6d\x20\x69\x73\x20\x32\x30\x20\x63\x68\x61\x72\x61\x63\x74\x65\x72\x73")}return b.isDelegate?c("\x41\x63\x63\x6f\x75\x6e\x74\x20\x69\x73\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x61\x20\x64\x65\x6c\x65\x67\x61\x74\x65"):b.username?c(null,a):void q.accounts.getAccount({username:a.asset.delegate.username},function(b,d){return b?c(b):d?c("\x55\x73\x65\x72\x6e\x61\x6d\x65\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x65\x78\x69\x73\x74\x73"):void c(null,a)})},this.process=function(a,b,c){setImmediate(c,null,a)},this.getBytes=function(a){if(!a.asset.delegate.username)return null;try{var b=new Buffer(a.asset.delegate.username,"\x75\x74\x66\x38")}catch(c){throw Error(""+c)}return b},this.apply=function(a,b,c,d){var e={address:c.address,u_isDelegate:0,isDelegate:1,vote:0};!c.nameexist&&a.asset.delegate.username&&(e.u_username=null,e.username=a.asset.delegate.username),q.accounts.setAccountAndGet(e,d)},this.undo=function(a,b,c,d){var e={address:c.address,u_isDelegate:1,isDelegate:0,vote:0};!c.nameexist&&a.asset.delegate.username&&(e.username=null,e.u_username=a.asset.delegate.username),q.accounts.setAccountAndGet(e,d)},this.applyUnconfirmed=function(a,b,c){function d(){var d={address:b.address,u_isDelegate:1,isDelegate:0};!b.nameexist&&a.asset.delegate.username&&(d.username=null,d.u_username=a.asset.delegate.username),q.accounts.setAccountAndGet(d,c)}return b.u_username&&a.asset.delegate.username&&a.asset.delegate.username!=b.u_username?c("\x41\x63\x63\x6f\x75\x6e\x74\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x68\x61\x73\x20\x61\x20\x75\x73\x65\x72\x6e\x61\x6d\x65"):b.u_isDelegate?c("\x41\x63\x63\x6f\x75\x6e\x74\x20\x69\x73\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x61\x20\x64\x65\x6c\x65\x67\x61\x74\x65"):b.username?d():void q.accounts.getAccount({u_username:a.asset.delegate.username},function(a,b){return a?c(a):b?c("\x55\x73\x65\x72\x6e\x61\x6d\x65\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x65\x78\x69\x73\x74\x73"):void d()})},this.undoUnconfirmed=function(a,b,c){var d={address:b.address,u_isDelegate:0,isDelegate:0};!b.nameexist&&a.asset.delegate.username&&(d.username=null,d.u_username=null),q.accounts.setAccountAndGet(d,c)},this.objectNormalize=function(a){var b=r.scheme.validate(a.asset.delegate,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{publicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"}},required:["\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"]});if(!b)throw Error("\x43\x61\x6e\x27\x74\x20\x76\x65\x72\x69\x66\x79\x20\x64\x65\x6c\x65\x67\x61\x74\x65\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x2c\x20\x69\x6e\x63\x6f\x72\x72\x65\x63\x74\x20\x70\x61\x72\x61\x6d\x65\x74\x65\x72\x73\x3a\x20"+r.scheme.getLastError());return a},this.dbRead=function(a){if(a.d_username){var b={username:a.d_username,publicKey:a.t_senderPublicKey,address:a.t_senderId};return{delegate:b}}return null},this.dbSave=function(a,b){r.dbLite.query("\x49\x4e\x53\x45\x52\x54\x20\x49\x4e\x54\x4f\x20\x64\x65\x6c\x65\x67\x61\x74\x65\x73\x28\x75\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29\x20\x56\x41\x4c\x55\x45\x53\x28\x24\x75\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x24\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29",{username:a.asset.delegate.username,transactionId:a.id},b)},this.ready=function(a,b){return b.multisignatures.length?a.signatures?a.signatures.length>=b.multimin-1:!1:!0}}function w(a,b){r=b,s=this,s.__private=t,t.attachApi(),r.logic.transaction.attachAssetType(n.DELEGATE,new v),setImmediate(a,null,s)}var q,r,s,t,u,d=c("\x63\x72\x79\x70\x74\x6f"),f=(c("\x65\x78\x74\x65\x6e\x64"),c("\x65\x64\x32\x35\x35\x31\x39")),g=c("\x61\x73\x79\x6e\x63"),i=(c("\x6b\x6e\x75\x74\x68\x2d\x73\x68\x75\x66\x66\x6c\x65").knuthShuffle,c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x72\x6f\x75\x74\x65\x72\x2e\x6a\x73")),j=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x6c\x6f\x74\x73\x2e\x6a\x73"),l=(c("\x6e\x6f\x64\x65\x2d\x73\x63\x68\x65\x64\x75\x6c\x65"),c("\x75\x74\x69\x6c")),m=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x63\x6f\x6e\x73\x74\x61\x6e\x74\x73\x2e\x6a\x73"),n=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x2d\x74\x79\x70\x65\x73\x2e\x6a\x73"),p=(c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x6d\x69\x6c\x65\x73\x74\x6f\x6e\x65\x42\x6c\x6f\x63\x6b\x73\x2e\x6a\x73"),c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x61\x6e\x64\x62\x6f\x78\x2e\x6a\x73"));c("\x61\x72\x72\x61\x79\x2e\x70\x72\x6f\x74\x6f\x74\x79\x70\x65\x2e\x66\x69\x6e\x64"),t={},u={},t.loaded=!1,t.keypairs={},t.attachApi=function(){var b,a=new i;a.use(function(a,b,c){return q&&t.loaded?c():void b.status(500).send({success:!1,error:"\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x69\x73\x20\x6c\x6f\x61\x64\x69\x6e\x67"})}),a.map(u,{"get /voters":"\x67\x65\x74\x56\x6f\x74\x65\x72\x73","get /get":"\x67\x65\x74\x44\x65\x6c\x65\x67\x61\x74\x65","get /":"\x67\x65\x74\x44\x65\x6c\x65\x67\x61\x74\x65\x73","get /fee":"\x67\x65\x74\x46\x65\x65","get /forging/getForgedByAccount":"\x67\x65\x74\x46\x6f\x72\x67\x65\x64\x42\x79\x41\x63\x63\x6f\x75\x6e\x74","put /":"\x61\x64\x64\x44\x65\x6c\x65\x67\x61\x74\x65"}),process.env.DEBUG&&(b={},a.get("\x2f\x66\x6f\x72\x67\x69\x6e\x67\x2f\x64\x69\x73\x61\x62\x6c\x65\x41\x6c\x6c",function(a,c){return 0!=Object.keys(b).length?c.json({success:!1}):(b=t.keypairs,t.keypairs={},c.json({success:!0}))}),a.get("\x2f\x66\x6f\x72\x67\x69\x6e\x67\x2f\x65\x6e\x61\x62\x6c\x65\x41\x6c\x6c",function(a,c){return 0==Object.keys(b).length?c.json({success:!1}):(t.keypairs=b,b={},c.json({success:!0}))})),a.post("\x2f\x66\x6f\x72\x67\x69\x6e\x67\x2f\x65\x6e\x61\x62\x6c\x65",function(a,b){var c=a.body;r.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{secret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:100},publicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"}},required:["\x73\x65\x63\x72\x65\x74"]},function(e){var g,h;return e?b.json({success:!1,error:e[0].message}):(g=a.connection.remoteAddress,r.config.forging.access.whiteList.length>0&&r.config.forging.access.whiteList.indexOf(g)<0?b.json({success:!1,error:"\x41\x63\x63\x65\x73\x73\x20\x64\x65\x6e\x69\x65\x64"}):(h=f.MakeKeypair(d.createHash("\x73\x68\x61\x32\x35\x36").update(c.secret,"\x75\x74\x66\x38").digest()),c.publicKey&&h.publicKey.toString("\x68\x65\x78")!=c.publicKey?b.json({success:!1,error:"\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65"}):t.keypairs[h.publicKey.toString("\x68\x65\x78")]?b.json({success:!1,error:"\x46\x6f\x72\x67\x69\x6e\x67\x20\x69\x73\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x65\x6e\x61\x62\x6c\x65\x64"}):void q.accounts.getAccount({publicKey:h.publicKey.toString("\x68\x65\x78")},function(a,c){return a?b.json({success:!1,error:""+a}):c&&c.isDelegate?(t.keypairs[h.publicKey.toString("\x68\x65\x78")]=h,b.json({success:!0,address:c.address})):b.json({success:!1,error:"\x44\x65\x6c\x65\x67\x61\x74\x65\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64"})})))})}),a.post("\x2f\x66\x6f\x72\x67\x69\x6e\x67\x2f\x64\x69\x73\x61\x62\x6c\x65",function(a,b){var c=a.body;r.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{secret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:100},publicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"}},required:["\x73\x65\x63\x72\x65\x74"]},function(e){var g,h;return e?b.json({success:!1,error:e[0].message}):(g=a.connection.remoteAddress,r.config.forging.access.whiteList.length>0&&r.config.forging.access.whiteList.indexOf(g)<0?b.json({success:!1,error:"\x41\x63\x63\x65\x73\x73\x20\x64\x65\x6e\x69\x65\x64"}):(h=f.MakeKeypair(d.createHash("\x73\x68\x61\x32\x35\x36").update(c.secret,"\x75\x74\x66\x38").digest()),c.publicKey&&h.publicKey.toString("\x68\x65\x78")!=c.publicKey?b.json({success:!1,error:"\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65"}):t.keypairs[h.publicKey.toString("\x68\x65\x78")]?void q.accounts.getAccount({publicKey:h.publicKey.toString("\x68\x65\x78")},function(a,c){return a?b.json({success:!1,error:""+a}):c&&c.isDelegate?(delete t.keypairs[h.publicKey.toString("\x68\x65\x78")],b.json({success:!0,address:c.address})):b.json({success:!1,error:"\x44\x65\x6c\x65\x67\x61\x74\x65\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64"})}):b.json({success:!1,error:"\x44\x65\x6c\x65\x67\x61\x74\x65\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64"})))})}),a.get("\x2f\x66\x6f\x72\x67\x69\x6e\x67\x2f\x73\x74\x61\x74\x75\x73",function(a,b){var c=a.query;r.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{publicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"}},required:["\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"]},function(a){return a?b.json({success:!1,error:a[0].message}):b.json({success:!0,enabled:!!t.keypairs[c.publicKey]})})}),r.network.app.use("\x2f\x61\x70\x69\x2f\x64\x65\x6c\x65\x67\x61\x74\x65\x73",a),r.network.app.use(function(a,b,c,d){return a?(r.logger.error(b.url,""+a),void c.status(500).send({success:!1,error:""+a})):d()})},t.getKeysSortByVote=function(a){q.accounts.getAccounts({isDelegate:1,sort:{vote:-1,publicKey:1},limit:j.delegates},["\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"],function(b,c){b&&a(b),a(null,c.map(function(a){return a.publicKey}))})},t.getBlockSlotData=function(a,b,c){s.generateDelegateList(b,function(b,d){var e,f,g,h;if(b)return c(b);for(e=a,f=j.getLastSlot(e);f>e;e+=1)if(g=e%j.delegates,h=d[g],h&&t.keypairs[h])return c(null,{time:j.getSlotTime(e),keypair:t.keypairs[h]});c(null,null)})},t.loop=function(a){var b,c;return Object.keys(t.keypairs).length?t.loaded&&!q.loader.syncing()&&q.round.loaded()?(b=j.getSlotNumber(),c=q.blocks.getLastBlock(),b==j.getSlotNumber(c.timestamp)?setImmediate(a):void t.getBlockSlotData(b,c.height+1,function(b,c){return b||null===c?(r.logger.log("\x4c\x6f\x6f\x70","\x73\x6b\x69\x70\x69\x6e\x67\x20\x73\x6c\x6f\x74"),setImmediate(a)):void r.sequence.add(function(a){j.getSlotNumber(c.time)==j.getSlotNumber()?q.blocks.generateBlock(c.keypair,c.time,function(b){r.logger.log("\x52\x6f\x75\x6e\x64\x20"+q.round.calc(q.blocks.getLastBlock().height)+"\x20\x6e\x65\x77\x20\x62\x6c\x6f\x63\x6b\x20\x69\x64\x3a\x20"+q.blocks.getLastBlock().id+"\x20\x68\x65\x69\x67\x68\x74\x3a\x20"+q.blocks.getLastBlock().height+"\x20\x73\x6c\x6f\x74\x3a\x20"+j.getSlotNumber(c.time)+"\x20\x72\x65\x77\x61\x72\x64\x3a\x20"+q.blocks.getLastBlock().reward),a(b)}):setImmediate(a)},function(b){b&&r.logger.error("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x67\x65\x74\x20\x62\x6c\x6f\x63\x6b\x20\x73\x6c\x6f\x74\x20\x64\x61\x74\x61",b),setImmediate(a)})})):setImmediate(a):(r.logger.debug("\x4c\x6f\x6f\x70","\x65\x78\x69\x74\x3a\x20\x6e\x6f\x20\x64\x65\x6c\x65\x67\x61\x74\x65\x73"),setImmediate(a))},t.loadMyDelegates=function(a){var b=null;r.config.forging.secret&&(b=l.isArray(r.config.forging.secret)?r.config.forging.secret:[r.config.forging.secret]),g.eachSeries(b,function(a,b){var c=f.MakeKeypair(d.createHash("\x73\x68\x61\x32\x35\x36").update(a,"\x75\x74\x66\x38").digest());q.accounts.getAccount({publicKey:c.publicKey.toString("\x68\x65\x78")},function(a,d){return a?b(a):d?(d.isDelegate?(t.keypairs[c.publicKey.toString("\x68\x65\x78")]=c,r.logger.info("\x46\x6f\x72\x67\x69\x6e\x67\x20\x65\x6e\x61\x62\x6c\x65\x64\x20\x6f\x6e\x20\x61\x63\x63\x6f\x75\x6e\x74\x3a\x20"+d.address)):r.logger.info("\x44\x65\x6c\x65\x67\x61\x74\x65\x20\x77\x69\x74\x68\x20\x74\x68\x69\x73\x20\x70\x75\x62\x6c\x69\x63\x20\x6b\x65\x79\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64\x3a\x20"+c.publicKey.toString("\x68\x65\x78")),void b()):b("\x41\x63\x63\x6f\x75\x6e\x74\x20"+c.publicKey.toString("\x68\x65\x78")+"\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")})},a)},w.prototype.generateDelegateList=function(a,b){t.getKeysSortByVote(function(c,e){var f,g,h,i,j,k,l;if(c)return b(c);for(f=""+q.round.calc(a),g=d.createHash("\x73\x68\x61\x32\x35\x36").update(f,"\x75\x74\x66\x38").digest(),h=0,i=e.length;i>h;h++){for(j=0;4>j&&i>h;h++,j++)k=g[j]%i,l=e[k],e[k]=e[h],e[h]=l;g=d.createHash("\x73\x68\x61\x32\x35\x36").update(g).digest()}b(null,e)})},w.prototype.checkDelegates=function(a,b,c){l.isArray(b)?q.accounts.getAccount({publicKey:a},function(a,d){return a?c(a):d?void g.eachSeries(b,function(a,b){var e,c=a[0];if("\x2b"!==c&&"\x2d"!==c)return b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x6d\x61\x74\x68\x20\x6f\x70\x65\x72\x61\x74\x6f\x72");e=a.slice(1);try{new Buffer(e,"\x68\x65\x78")}catch(f){return b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x75\x62\x6c\x69\x63\x20\x6b\x65\x79")}return"\x2b"==c&&null!==d.delegates&&-1!=d.delegates.indexOf(e)?b("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x61\x64\x64\x20\x76\x6f\x74\x65\x2c\x20\x61\x63\x63\x6f\x75\x6e\x74\x20\x68\x61\x73\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x76\x6f\x74\x65\x64\x20\x66\x6f\x72\x20\x74\x68\x69\x73\x20\x64\x65\x6c\x65\x67\x61\x74\x65"):"\x2d"!=c||null!==d.delegates&&-1!==d.delegates.indexOf(e)?void q.accounts.getAccount({publicKey:e,isDelegate:1},function(a,c){return a?b(a):c?void b():b("\x44\x65\x6c\x65\x67\x61\x74\x65\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")}):b("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x72\x65\x6d\x6f\x76\x65\x20\x76\x6f\x74\x65\x2c\x20\x61\x63\x63\x6f\x75\x6e\x74\x20\x68\x61\x73\x20\x6e\x6f\x74\x20\x76\x6f\x74\x65\x64\x20\x66\x6f\x72\x20\x74\x68\x69\x73\x20\x64\x65\x6c\x65\x67\x61\x74\x65")},c):c("\x41\x63\x63\x6f\x75\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")}):setImmediate(c,"\x50\x6c\x65\x61\x73\x65\x20\x70\x72\x6f\x76\x69\x64\x65\x20\x61\x6e\x20\x61\x72\x72\x61\x79\x20\x6f\x66\x20\x76\x6f\x74\x65\x73")},w.prototype.checkUnconfirmedDelegates=function(a,b,c){return l.isArray(b)?void q.accounts.getAccount({publicKey:a},function(a,d){return a?c(a):d?void g.eachSeries(b,function(a,b){var e,c=a[0];if("\x2b"!==c&&"\x2d"!==c)return b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x6d\x61\x74\x68\x20\x6f\x70\x65\x72\x61\x74\x6f\x72");e=a.slice(1);try{new Buffer(e,"\x68\x65\x78")}catch(f){return b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x75\x62\x6c\x69\x63\x20\x6b\x65\x79")}return"\x2b"==c&&null!==d.u_delegates&&-1!=d.u_delegates.indexOf(e)?b("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x61\x64\x64\x20\x76\x6f\x74\x65\x2c\x20\x61\x63\x63\x6f\x75\x6e\x74\x20\x68\x61\x73\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x76\x6f\x74\x65\x64\x20\x66\x6f\x72\x20\x74\x68\x69\x73\x20\x64\x65\x6c\x65\x67\x61\x74\x65"):"\x2d"!=c||null!==d.u_delegates&&-1!==d.u_delegates.indexOf(e)?void q.accounts.getAccount({
publicKey:e,isDelegate:1},function(a,c){return a?b(a):c?void b():b("\x44\x65\x6c\x65\x67\x61\x74\x65\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")}):b("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x72\x65\x6d\x6f\x76\x65\x20\x76\x6f\x74\x65\x2c\x20\x61\x63\x63\x6f\x75\x6e\x74\x20\x68\x61\x73\x20\x6e\x6f\x74\x20\x76\x6f\x74\x65\x64\x20\x66\x6f\x72\x20\x74\x68\x69\x73\x20\x64\x65\x6c\x65\x67\x61\x74\x65")},c):c("\x41\x63\x63\x6f\x75\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")}):setImmediate(c,"\x50\x6c\x65\x61\x73\x65\x20\x70\x72\x6f\x76\x69\x64\x65\x20\x61\x6e\x20\x61\x72\x72\x61\x79\x20\x6f\x66\x20\x76\x6f\x74\x65\x73")},w.prototype.fork=function(a,b){r.logger.info("\x46\x6f\x72\x6b",{delegate:a.generatorPublicKey,block:{id:a.id,timestamp:a.timestamp,height:a.height,previousBlock:a.previousBlock},cause:b}),r.dbLite.query("\x49\x4e\x53\x45\x52\x54\x20\x49\x4e\x54\x4f\x20\x66\x6f\x72\x6b\x73\x5f\x73\x74\x61\x74\x20\x28\x64\x65\x6c\x65\x67\x61\x74\x65\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x2c\x20\x62\x6c\x6f\x63\x6b\x54\x69\x6d\x65\x73\x74\x61\x6d\x70\x2c\x20\x62\x6c\x6f\x63\x6b\x49\x64\x2c\x20\x62\x6c\x6f\x63\x6b\x48\x65\x69\x67\x68\x74\x2c\x20\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b\x2c\x20\x63\x61\x75\x73\x65\x29\x20\x56\x41\x4c\x55\x45\x53\x20\x28\x24\x64\x65\x6c\x65\x67\x61\x74\x65\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x2c\x20\x24\x62\x6c\x6f\x63\x6b\x54\x69\x6d\x65\x73\x74\x61\x6d\x70\x2c\x20\x24\x62\x6c\x6f\x63\x6b\x49\x64\x2c\x20\x24\x62\x6c\x6f\x63\x6b\x48\x65\x69\x67\x68\x74\x2c\x20\x24\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b\x2c\x20\x24\x63\x61\x75\x73\x65\x29\x3b",{delegatePublicKey:a.generatorPublicKey,blockTimestamp:a.timestamp,blockId:a.id,blockHeight:a.height,previousBlock:a.previousBlock,cause:b})},w.prototype.validateBlockSlot=function(a,b){s.generateDelegateList(a.height,function(c,d){var e,f,g,h;return c?b(c):(e=j.getSlotNumber(a.timestamp),f=d[e%j.delegates],g=d[(e+1)%j.delegates],h=d[(e-1)%j.delegates],f&&a.generatorPublicKey==f?b():void b("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x76\x65\x72\x69\x66\x79\x20\x73\x6c\x6f\x74"))})},w.prototype.sandboxApi=function(a,b,c){p.callMethod(u,a,b,c)},w.prototype.onBind=function(a){q=a},w.prototype.onBlockchainReady=function(){t.loaded=!0,t.loadMyDelegates(function a(b){b&&r.logger.error("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x6c\x6f\x61\x64\x20\x64\x65\x6c\x65\x67\x61\x74\x65\x73",b),t.loop(function(){setTimeout(a,1e3)})})},w.prototype.cleanup=function(a){t.loaded=!1,a()},u.getDelegate=function(a,b){var c=a.body;r.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{transactionId:{type:"\x73\x74\x72\x69\x6e\x67"},publicKey:{type:"\x73\x74\x72\x69\x6e\x67"},username:{type:"\x73\x74\x72\x69\x6e\x67"}}},function(a){return a?b(a[0].message):void q.accounts.getAccounts({isDelegate:1,sort:{vote:-1,publicKey:1}},["\x75\x73\x65\x72\x6e\x61\x6d\x65","\x61\x64\x64\x72\x65\x73\x73","\x70\x75\x62\x6c\x69\x63\x4b\x65\x79","\x76\x6f\x74\x65","\x6d\x69\x73\x73\x65\x64\x62\x6c\x6f\x63\x6b\x73","\x70\x72\x6f\x64\x75\x63\x65\x64\x62\x6c\x6f\x63\x6b\x73","\x76\x69\x72\x67\x69\x6e"],function(a,d){var e,f,g,h,i,k,l,m,n,o,p,q,r;if(a)return b(""+a);for(e=c.limit||101,f=c.offset||0,g=c.orderBy,h=c.active,g=g?g.split("\x3a"):null,e=e>101?101:e,i=g?g[0]:null,k=g&&2==g.length?g[1]:"\x61\x73\x63",l=d.length,m=Math.min(e,l),n=Math.min(f+e,l),o=0;o<d.length;o++)d[o].rate=o+1,p=100-d[o].missedblocks/((d[o].producedblocks+d[o].missedblocks)/100),p=p||0,q=o+1>j.delegates&&d[o].virgin,d[o].productivity=q?null:d[o].virgin?0:parseFloat(Math.floor(100*p)/100).toFixed(2);r=d.find(function(a){return c.transactionId,c.publicKey?a.publicKey==c.publicKey:c.username?a.username==c.username:!1}),r?b(null,{delegate:r}):b("\x44\x65\x6c\x65\x67\x61\x74\x65\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")})})},u.getVoters=function(a,b){var c=a.body;r.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{publicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"}},required:["\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"]},function(a){return a?b(a[0].message):void r.dbLite.query("\x73\x65\x6c\x65\x63\x74\x20\x47\x52\x4f\x55\x50\x5f\x43\x4f\x4e\x43\x41\x54\x28\x61\x63\x63\x6f\x75\x6e\x74\x49\x64\x29\x20\x66\x72\x6f\x6d\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x32\x64\x65\x6c\x65\x67\x61\x74\x65\x73\x20\x77\x68\x65\x72\x65\x20\x64\x65\x70\x65\x6e\x64\x65\x6e\x74\x49\x64\x20\x3d\x20\x24\x70\x75\x62\x6c\x69\x63\x4b\x65\x79",{publicKey:c.publicKey},["\x61\x63\x63\x6f\x75\x6e\x74\x49\x64"],function(a,c){if(a)return r.logger.error(a),b("\x44\x61\x74\x61\x62\x61\x73\x65\x20\x65\x72\x72\x6f\x72");var d=c[0].accountId.split("\x2c");q.accounts.getAccounts({address:{$in:d},sort:"\x62\x61\x6c\x61\x6e\x63\x65"},["\x61\x64\x64\x72\x65\x73\x73","\x62\x61\x6c\x61\x6e\x63\x65"],function(a,c){return a?(r.logger.error(a),b("\x44\x61\x74\x61\x62\x61\x73\x65\x20\x65\x72\x72\x6f\x72")):b(null,{accounts:c})})})})},u.getDelegates=function(a,b){var c=a.body;r.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{limit:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:101},offset:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0},orderBy:{type:"\x73\x74\x72\x69\x6e\x67"}}},function(a){return a?b(a[0].message):void q.accounts.getAccounts({isDelegate:1,sort:{vote:-1,publicKey:1}},["\x75\x73\x65\x72\x6e\x61\x6d\x65","\x61\x64\x64\x72\x65\x73\x73","\x70\x75\x62\x6c\x69\x63\x4b\x65\x79","\x76\x6f\x74\x65","\x6d\x69\x73\x73\x65\x64\x62\x6c\x6f\x63\x6b\x73","\x70\x72\x6f\x64\x75\x63\x65\x64\x62\x6c\x6f\x63\x6b\x73","\x76\x69\x72\x67\x69\x6e"],function(a,d){var e,f,g,h,i,k,l,m,n,o,p,q,r;if(a)return b(""+a);for(e=c.limit||101,f=c.offset||0,g=c.orderBy,h=c.active,g=g?g.split("\x3a"):null,e=e>101?101:e,i=g?g[0]:null,k=g&&2==g.length?g[1]:"\x61\x73\x63",l=d.length,m=Math.min(e,l),n=Math.min(f+e,l),o=0;o<d.length;o++)d[o].rate=o+1,p=100-d[o].missedblocks/((d[o].producedblocks+d[o].missedblocks)/100),p=p||0,q=o+1>j.delegates&&d[o].virgin,d[o].productivity=q?null:d[o].virgin?0:parseFloat(Math.floor(100*p)/100).toFixed(2);d.sort(function(a,b){if("\x61\x73\x63"==k){if(a[i]<b[i])return-1;if(a[i]>b[i])return 1}else if("\x64\x65\x73\x63"==k){if(a[i]>b[i])return-1;if(a[i]<b[i])return 1}return 0}),r=d.slice(f,n),b(null,{delegates:r,totalCount:l})})})},u.getFee=function(a,b){var d=(a.body,null);d=100*m.fixedPoint,b(null,{fee:d})},u.getForgedByAccount=function(a,b){var c=a.body;r.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{generatorPublicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"}},required:["\x67\x65\x6e\x65\x72\x61\x74\x6f\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79"]},function(a){return a?b(a[0].message):void q.accounts.getAccount({publicKey:c.generatorPublicKey},["\x66\x65\x65\x73","\x72\x65\x77\x61\x72\x64\x73"],function(a,c){return a||!c?b(a||"\x41\x63\x63\x6f\x75\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64"):void b(null,{fees:c.fees,rewards:c.rewards,forged:c.fees+c.rewards})})})},t.enableForging=function(){},t.disableForging=function(){},t.statusForging=function(){},u.addDelegate=function(a,b){var c=a.body;r.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{secret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:100},publicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"},secondSecret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:100},username:{type:"\x73\x74\x72\x69\x6e\x67"}},required:["\x73\x65\x63\x72\x65\x74"]},function(a){var e,g;return a?b(a[0].message):(e=d.createHash("\x73\x68\x61\x32\x35\x36").update(c.secret,"\x75\x74\x66\x38").digest(),g=f.MakeKeypair(e),c.publicKey&&g.publicKey.toString("\x68\x65\x78")!=c.publicKey?b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65"):void r.balancesSequence.add(function(a){c.multisigAccountPublicKey&&c.multisigAccountPublicKey!=g.publicKey.toString("\x68\x65\x78")?q.accounts.getAccount({publicKey:c.multisigAccountPublicKey},function(b,e){return b?a(""+b):e&&e.publicKey?e.multisignatures&&e.multisignatures?e.multisignatures.indexOf(g.publicKey.toString("\x68\x65\x78"))<0?a("\x41\x63\x63\x6f\x75\x6e\x74\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x62\x65\x6c\x6f\x6e\x67\x20\x74\x6f\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x67\x72\x6f\x75\x70"):void q.accounts.getAccount({publicKey:g.publicKey},function(b,h){var i,j,k;if(b)return a(""+b);if(!h||!h.publicKey)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x72\x65\x71\x75\x65\x73\x74\x65\x72");if(h.secondSignature&&!c.secondSecret)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x63\x6f\x6e\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65");if(h.publicKey==e.publicKey)return a("\x49\x6e\x63\x6f\x72\x72\x65\x63\x74\x20\x72\x65\x71\x75\x65\x73\x74\x65\x72");i=null,h.secondSignature&&(j=d.createHash("\x73\x68\x61\x32\x35\x36").update(c.secondSecret,"\x75\x74\x66\x38").digest(),i=f.MakeKeypair(j));try{k=r.logic.transaction.create({type:n.DELEGATE,username:c.username,sender:e,keypair:g,secondKeypair:i,requester:g})}catch(l){return a(""+l)}q.transactions.receiveTransactions([k],a)}):a("\x41\x63\x63\x6f\x75\x6e\x74\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x68\x61\x76\x65\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x65\x6e\x61\x62\x6c\x65\x64"):a("\x4d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x61\x63\x63\x6f\x75\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")}):q.accounts.getAccount({publicKey:g.publicKey.toString("\x68\x65\x78")},function(b,e){var h,i,j;if(b)return a(""+b);if(!e||!e.publicKey)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x61\x63\x63\x6f\x75\x6e\x74");if(e.secondSignature&&!c.secondSecret)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x63\x6f\x6e\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65");h=null,e.secondSignature&&(i=d.createHash("\x73\x68\x61\x32\x35\x36").update(c.secondSecret,"\x75\x74\x66\x38").digest(),h=f.MakeKeypair(i));try{j=r.logic.transaction.create({type:n.DELEGATE,username:c.username,sender:e,keypair:g,secondKeypair:h})}catch(k){return a(""+k)}q.transactions.receiveTransactions([j],a)})},function(a,c){return a?b(""+a):void b(null,{transaction:c[0]})}))})},a.exports=w}),c.register("\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x6c\x6f\x61\x64\x65\x72\x2e\x6a\x73",function(a,b,c){function o(a,b){k=b,m.genesisBlock=m.loadingLastBlock=k.genesisblock,l=this,l.__private=m,m.attachApi(),setImmediate(a,null,l)}var j,k,l,m,n,d=c("\x61\x73\x79\x6e\x63"),e=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x72\x6f\x75\x74\x65\x72\x2e\x6a\x73"),g=(c("\x75\x74\x69\x6c"),c("\x69\x70")),h=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x62\x69\x67\x6e\x75\x6d\x2e\x6a\x73"),i=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x61\x6e\x64\x62\x6f\x78\x2e\x6a\x73");c("\x63\x6f\x6c\x6f\x72\x73"),m={},n={},m.loaded=!1,m.isActive=!1,m.loadingLastBlock=null,m.genesisBlock=null,m.total=0,m.blocksToSync=0,m.syncIntervalId=null,m.attachApi=function(){var a=new e;a.map(n,{"get /status":"\x73\x74\x61\x74\x75\x73","get /status/sync":"\x73\x79\x6e\x63"}),k.network.app.use("\x2f\x61\x70\x69\x2f\x6c\x6f\x61\x64\x65\x72",a),k.network.app.use(function(a,b,c,d){return a?(k.logger.error(b.url,""+a),void c.status(500).send({success:!1,error:""+a})):d()})},m.syncTrigger=function(a){a===!1&&m.syncIntervalId&&(clearTimeout(m.syncIntervalId),m.syncIntervalId=null),a!==!0||m.syncIntervalId||setImmediate(function b(){k.network.io.sockets.emit("\x6c\x6f\x61\x64\x65\x72\x2f\x73\x79\x6e\x63",{blocks:m.blocksToSync,height:j.blocks.getLastBlock().height}),m.syncIntervalId=setTimeout(b,1e3)})},m.loadFullDb=function(a,b){var c=a?g.fromLong(a.ip)+"\x3a"+a.port:"\x75\x6e\x6b\x6e\x6f\x77\x6e",d=m.genesisBlock.block.id;k.logger.debug("\x4c\x6f\x61\x64\x69\x6e\x67\x20\x62\x6c\x6f\x63\x6b\x73\x20\x66\x72\x6f\x6d\x20\x67\x65\x6e\x65\x73\x69\x73\x20\x66\x72\x6f\x6d\x20"+c),j.blocks.loadBlocksFromPeer(a,d,b)},m.findUpdate=function(a,b,c){var e=b?g.fromLong(b.ip)+"\x3a"+b.port:"\x75\x6e\x6b\x6e\x6f\x77\x6e";k.logger.info("\x4c\x6f\x6f\x6b\x69\x6e\x67\x20\x66\x6f\x72\x20\x63\x6f\x6d\x6d\x6f\x6e\x20\x62\x6c\x6f\x63\x6b\x20\x77\x69\x74\x68\x20"+e),j.blocks.getCommonBlock(b,a.height,function(f,g){var h,i;return f||!g?c(f):(k.logger.info("\x46\x6f\x75\x6e\x64\x20\x63\x6f\x6d\x6d\x6f\x6e\x20\x62\x6c\x6f\x63\x6b\x20"+g.id+"\x20\x28\x61\x74\x20"+g.height+"\x29\x20\x77\x69\x74\x68\x20\x70\x65\x65\x72\x20"+e),h=a.height-g.height,h>1010?(k.logger.log("\x6c\x6f\x6e\x67\x20\x66\x6f\x72\x6b\x2c\x20\x62\x61\x6e\x20\x36\x30\x20\x6d\x69\x6e",e),j.peer.state(b.ip,b.port,0,3600),c()):(i=[],void j.transactions.undoUnconfirmedList(function(f,l){var m,n;if(f)return process.exit(0);for(m=0;m<l.length;m++)n=j.transactions.getUnconfirmedTransaction(l[m]),i.push(n),j.transactions.removeUnconfirmedTransaction(l[m]);d.series([function(b){g.id!=a.id?j.round.directionSwap("\x62\x61\x63\x6b\x77\x61\x72\x64",a,b):b()},function(a){k.bus.message("\x64\x65\x6c\x65\x74\x65\x42\x6c\x6f\x63\x6b\x73\x42\x65\x66\x6f\x72\x65",g),j.blocks.deleteBlocksBefore(g,a)},function(b){g.id!=a.id?j.round.directionSwap("\x66\x6f\x72\x77\x61\x72\x64",a,b):b()},function(c){k.logger.debug("\x4c\x6f\x61\x64\x69\x6e\x67\x20\x62\x6c\x6f\x63\x6b\x73\x20\x66\x72\x6f\x6d\x20\x70\x65\x65\x72\x20"+e),j.blocks.loadBlocksFromPeer(b,g.id,function(f,l){var m,n,o;if(f)j.transactions.deleteHiddenTransaction(),k.logger.error(f),k.logger.log("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x6c\x6f\x61\x64\x20\x62\x6c\x6f\x63\x6b\x73\x2c\x20\x62\x61\x6e\x20\x36\x30\x20\x6d\x69\x6e",e),j.peer.state(b.ip,b.port,0,3600),l?(m=l.height-g.height,m>h?(k.logger.info("\x52\x65\x6d\x6f\x76\x65\x20\x62\x6c\x6f\x63\x6b\x73\x20\x61\x67\x61\x69\x6e\x20\x75\x6e\x74\x69\x6c\x20"+l.id+"\x20\x28\x61\x74\x20"+l.height+"\x29"),d.series([function(b){l.id!=a.id?j.round.directionSwap("\x62\x61\x63\x6b\x77\x61\x72\x64",a,b):b()},function(b){j.blocks.deleteBlocksBefore(l,function(){d.series([function(b){l.id!=a.id&&j.round.directionSwap("\x66\x6f\x72\x77\x61\x72\x64",a,b)},function(a){d.eachSeries(i,function(a,b){j.transactions.processUnconfirmedTransaction(a,!1,b)},a)}],b)})}],c)):(k.logger.info("\x52\x65\x6d\x6f\x76\x65\x20\x62\x6c\x6f\x63\x6b\x73\x20\x61\x67\x61\x69\x6e\x20\x75\x6e\x74\x69\x6c\x20\x63\x6f\x6d\x6d\x6f\x6e\x20"+g.id+"\x20\x28\x61\x74\x20"+g.height+"\x29"),d.series([function(b){g.id!=a.id?j.round.directionSwap("\x62\x61\x63\x6b\x77\x61\x72\x64",a,b):b()},function(a){j.blocks.deleteBlocksBefore(g,a)},function(b){g.id!=a.id?j.round.directionSwap("\x66\x6f\x72\x77\x61\x72\x64",a,b):b()},function(a){d.eachSeries(i,function(a,b){j.transactions.processUnconfirmedTransaction(a,!1,b)},a)}],c))):d.eachSeries(i,function(a,b){j.transactions.processUnconfirmedTransaction(a,!1,b)},c);else{for(n=0;n<i.length;n++)j.transactions.pushHiddenTransaction(i[n]);o=j.transactions.shiftHiddenTransaction(),d.whilst(function(){return o},function(a){j.transactions.processUnconfirmedTransaction(o,!0,function(){o=j.transactions.shiftHiddenTransaction(),a()})},c)}})}],c)})))})},m.loadBlocks=function(a,b){j.transport.getFromRandomPeer({api:"\x2f\x68\x65\x69\x67\x68\x74",method:"\x47\x45\x54"},function(c,d){var f,e=d&&d.peer?g.fromLong(d.peer.ip)+"\x3a"+d.peer.port:"\x75\x6e\x6b\x6e\x6f\x77\x6e";return c||!d.body?(k.logger.log("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x67\x65\x74\x20\x68\x65\x69\x67\x68\x74\x20\x66\x72\x6f\x6d\x20\x70\x65\x65\x72\x3a\x20"+e),b()):(k.logger.info("\x43\x68\x65\x63\x6b\x20\x62\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x6f\x6e\x20"+e),d.body.height=parseInt(d.body.height),(f=k.scheme.validate(d.body,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{height:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0}},required:["\x68\x65\x69\x67\x68\x74"]}))?void(h(j.blocks.getLastBlock().height).lt(d.body.height)?(m.blocksToSync=d.body.height,a.id!=m.genesisBlock.block.id?m.findUpdate(a,d.peer,b):m.loadFullDb(d.peer,b)):b()):(k.logger.log("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x70\x61\x72\x73\x65\x20\x62\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x68\x65\x69\x67\x68\x74\x3a\x20"+e+"\n"+k.scheme.getLastError()),b()))})},m.loadSignatures=function(a){j.transport.getFromRandomPeer({api:"\x2f\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73",method:"\x47\x45\x54",not_ban:!0},function(b,c){return b?a():void k.scheme.validate(c.body,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{signatures:{type:"\x61\x72\x72\x61\x79",uniqueItems:!0}},required:["\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73"]},function(b){return b?a():void k.sequence.add(function(a){d.eachSeries(c.body.signatures,function(a,b){d.eachSeries(a.signatures,function(b,c){j.multisignatures.processSignature({signature:b,transaction:a.transaction},function(){setImmediate(c)})},b)},a)},a)})})},m.loadUnconfirmedTransactions=function(a){j.transport.getFromRandomPeer({api:"\x2f\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73",method:"\x47\x45\x54"},function(b,c){var d,e,f,i;if(b)return a();if(d=k.scheme.validate(c.body,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{transactions:{type:"\x61\x72\x72\x61\x79",uniqueItems:!0}},required:["\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73"]}),!d)return a();for(e=c.body.transactions,f=0;f<e.length;f++)try{e[f]=k.logic.transaction.objectNormalize(e[f])}catch(h){return i=c.peer?g.fromLong(c.peer.ip)+"\x3a"+c.peer.port:"\x75\x6e\x6b\x6e\x6f\x77\x6e",k.logger.log("\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20"+(e[f]?e[f].id:"\x6e\x75\x6c\x6c")+"\x20\x69\x73\x20\x6e\x6f\x74\x20\x76\x61\x6c\x69\x64\x2c\x20\x62\x61\x6e\x20\x36\x30\x20\x6d\x69\x6e",i),j.peer.state(c.peer.ip,c.peer.port,0,3600),setImmediate(a)}k.balancesSequence.add(function(a){j.transactions.receiveTransactions(e,a)},a)})},m.loadBlockChain=function(){function e(e){c=!0,m.total=e,k.logic.account.removeTables(function(f){if(f)throw f;k.logic.account.createTables(function(f){if(f)throw f;d.until(function(){return a>e},function(d){k.logger.info("\x43\x75\x72\x72\x65\x6e\x74\x20"+a),setImmediate(function(){j.blocks.loadBlocksOffset(b,a,c,function(c,e){return c?d(c):(a+=b,m.loadingLastBlock=e,void d())})})},function(a){a?(k.logger.error("\x6c\x6f\x61\x64\x42\x6c\x6f\x63\x6b\x73\x4f\x66\x66\x73\x65\x74",a),a.block&&(k.logger.error("\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x66\x61\x69\x6c\x65\x64\x20\x61\x74\x20",a.block.height),j.blocks.simpleDeleteAfterBlock(a.block.id,function(){k.logger.error("\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x63\x6c\x69\x70\x70\x65\x64"),k.bus.message("\x62\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x52\x65\x61\x64\x79")}))):(k.logger.info("\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x72\x65\x61\x64\x79"),k.bus.message("\x62\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x52\x65\x61\x64\x79"))})})})}var a=0,b=k.config.loading.loadPerIteration,c=k.config.loading.verifyOnLoading;k.logic.account.createTables(function(a){if(a)throw a;k.dbLite.query("\x73\x65\x6c\x65\x63\x74\x20\x63\x6f\x75\x6e\x74\x28\x2a\x29\x20\x66\x72\x6f\x6d\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x20\x77\x68\x65\x72\x65\x20\x62\x6c\x6f\x63\x6b\x49\x64\x20\x3d\x20\x28\x73\x65\x6c\x65\x63\x74\x20\x69\x64\x20\x66\x72\x6f\x6d\x20\x62\x6c\x6f\x63\x6b\x73\x20\x77\x68\x65\x72\x65\x20\x6e\x75\x6d\x62\x65\x72\x4f\x66\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73\x20\x3e\x20\x30\x20\x6f\x72\x64\x65\x72\x20\x62\x79\x20\x68\x65\x69\x67\x68\x74\x20\x64\x65\x73\x63\x20\x6c\x69\x6d\x69\x74\x20\x31\x29",{count:Number},function(a,b){if(a)throw a;var d=!b[0].count;j.blocks.count(function(a,b){return a?k.logger.error("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x63\x6f\x75\x6e\x74\x20\x62\x6c\x6f\x63\x6b\x73",a):(k.logger.info("\x42\x6c\x6f\x63\x6b\x73\x20"+b),void(d||c||1==b?e(b):k.dbLite.query("\x55\x50\x44\x41\x54\x45\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x20\x53\x45\x54\x20\x75\x5f\x69\x73\x44\x65\x6c\x65\x67\x61\x74\x65\x3d\x69\x73\x44\x65\x6c\x65\x67\x61\x74\x65\x2c\x75\x5f\x73\x65\x63\x6f\x6e\x64\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x3d\x73\x65\x63\x6f\x6e\x64\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x2c\x75\x5f\x75\x73\x65\x72\x6e\x61\x6d\x65\x3d\x75\x73\x65\x72\x6e\x61\x6d\x65\x2c\x75\x5f\x62\x61\x6c\x61\x6e\x63\x65\x3d\x62\x61\x6c\x61\x6e\x63\x65\x2c\x75\x5f\x64\x65\x6c\x65\x67\x61\x74\x65\x73\x3d\x64\x65\x6c\x65\x67\x61\x74\x65\x73\x2c\x75\x5f\x63\x6f\x6e\x74\x61\x63\x74\x73\x3d\x63\x6f\x6e\x74\x61\x63\x74\x73\x2c\x75\x5f\x66\x6f\x6c\x6c\x6f\x77\x65\x72\x73\x3d\x66\x6f\x6c\x6c\x6f\x77\x65\x72\x73\x2c\x75\x5f\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x3d\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73",function(a){a?(k.logger.error(a),k.logger.info("\x55\x6e\x61\x62\x6c\x65\x20\x74\x6f\x20\x6c\x6f\x61\x64\x20\x77\x69\x74\x68\x6f\x75\x74\x20\x76\x65\x72\x69\x66\x79\x69\x6e\x67\x2c\x20\x63\x6c\x65\x61\x72\x69\x6e\x67\x20\x61\x63\x63\x6f\x75\x6e\x74\x73\x20\x66\x72\x6f\x6d\x20\x64\x61\x74\x61\x62\x61\x73\x65\x20\x61\x6e\x64\x20\x6c\x6f\x61\x64\x69\x6e\x67"),e(b)):k.dbLite.query("\x73\x65\x6c\x65\x63\x74\x20\x61\x2e\x62\x6c\x6f\x63\x6b\x49\x64\x2c\x20\x62\x2e\x69\x64\x20\x66\x72\x6f\x6d\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x20\x61\x20\x6c\x65\x66\x74\x20\x6f\x75\x74\x65\x72\x20\x6a\x6f\x69\x6e\x20\x62\x6c\x6f\x63\x6b\x73\x20\x62\x20\x6f\x6e\x20\x62\x2e\x69\x64\x20\x3d\x20\x61\x2e\x62\x6c\x6f\x63\x6b\x49\x64\x20\x77\x68\x65\x72\x65\x20\x62\x2e\x69\x64\x20\x69\x73\x20\x6e\x75\x6c\x6c",{},["\x61\x5f\x62\x6c\x6f\x63\x6b\x49\x64","\x62\x5f\x69\x64"],function(a,d){a||d.length>0?(k.logger.error(a||"\x45\x6e\x63\x6f\x75\x6e\x74\x65\x72\x65\x64\x20\x6d\x69\x73\x73\x69\x6e\x67\x20\x62\x6c\x6f\x63\x6b\x2c\x20\x6c\x6f\x6f\x6b\x73\x20\x6c\x69\x6b\x65\x20\x6e\x6f\x64\x65\x20\x77\x65\x6e\x74\x20\x64\x6f\x77\x6e\x20\x64\x75\x72\x69\x6e\x67\x20\x62\x6c\x6f\x63\x6b\x20\x70\x72\x6f\x63\x65\x73\x73\x69\x6e\x67"),k.logger.info("\x55\x6e\x61\x62\x6c\x65\x20\x74\x6f\x20\x6c\x6f\x61\x64\x20\x77\x69\x74\x68\x6f\x75\x74\x20\x76\x65\x72\x69\x66\x79\x69\x6e\x67\x2c\x20\x63\x6c\x65\x61\x72\x69\x6e\x67\x20\x61\x63\x63\x6f\x75\x6e\x74\x73\x20\x66\x72\x6f\x6d\x20\x64\x61\x74\x61\x62\x61\x73\x65\x20\x61\x6e\x64\x20\x6c\x6f\x61\x64\x69\x6e\x67"),e(b)):k.dbLite.query("\x53\x45\x4c\x45\x43\x54\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x70\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x29\x20\x46\x52\x4f\x4d\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x20\x57\x48\x45\x52\x45\x20\x69\x73\x44\x65\x6c\x65\x67\x61\x74\x65\x3d\x31",["\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"],function(a,d){a||0==d.length?(k.logger.error(a||"\x4e\x6f\x20\x64\x65\x6c\x65\x67\x61\x74\x65\x73\x2c\x20\x72\x65\x6c\x6f\x61\x64\x20\x64\x61\x74\x61\x62\x61\x73\x65"),k.logger.info("\x55\x6e\x61\x62\x6c\x65\x20\x74\x6f\x20\x6c\x6f\x61\x64\x20\x77\x69\x74\x68\x6f\x75\x74\x20\x76\x65\x72\x69\x66\x79\x69\x6e\x67\x2c\x20\x63\x6c\x65\x61\x72\x69\x6e\x67\x20\x61\x63\x63\x6f\x75\x6e\x74\x73\x20\x66\x72\x6f\x6d\x20\x64\x61\x74\x61\x62\x61\x73\x65\x20\x61\x6e\x64\x20\x6c\x6f\x61\x64\x69\x6e\x67"),e(b)):j.blocks.loadBlocksOffset(1,b,c,function(a){a?(k.logger.error(a||"\x55\x6e\x61\x62\x6c\x65\x20\x74\x6f\x20\x6c\x6f\x61\x64\x20\x6c\x61\x73\x74\x20\x62\x6c\x6f\x63\x6b"),k.logger.info("\x55\x6e\x61\x62\x6c\x65\x20\x74\x6f\x20\x6c\x6f\x61\x64\x20\x77\x69\x74\x68\x6f\x75\x74\x20\x76\x65\x72\x69\x66\x79\x69\x6e\x67\x2c\x20\x63\x6c\x65\x61\x72\x69\x6e\x67\x20\x61\x63\x63\x6f\x75\x6e\x74\x73\x20\x66\x72\x6f\x6d\x20\x64\x61\x74\x61\x62\x61\x73\x65\x20\x61\x6e\x64\x20\x6c\x6f\x61\x64\x69\x6e\x67"),e(b)):j.blocks.loadLastBlock(function(a,c){return a?e(b):(m.lastBlock=c,k.logger.info("\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x72\x65\x61\x64\x79"),void k.bus.message("\x62\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x52\x65\x61\x64\x79"))})})})})})))})})})},o.prototype.syncing=function(){return!!m.syncIntervalId},o.prototype.sandboxApi=function(a,b,c){i.callMethod(n,a,b,c)},o.prototype.onPeerReady=function(){setImmediate(function a(){m.loaded&&(m.isActive=!0,k.sequence.add(function(a){m.syncTrigger(!0);var b=j.blocks.getLastBlock();m.loadBlocks(b,a)},function(b){b&&k.logger.error("\x6c\x6f\x61\x64\x42\x6c\x6f\x63\x6b\x73\x20\x74\x69\x6d\x65\x72",b),m.syncTrigger(!1),m.blocksToSync=0,m.isActive=!1,m.loaded&&setTimeout(a,9e3)}))}),setImmediate(function b(){m.loaded&&m.loadUnconfirmedTransactions(function(a){a&&k.logger.error("\x6c\x6f\x61\x64\x55\x6e\x63\x6f\x6e\x66\x69\x72\x6d\x65\x64\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73\x20\x74\x69\x6d\x65\x72",a),setTimeout(b,14e3)})}),setImmediate(function c(){m.loaded&&m.loadSignatures(function(a){a&&k.logger.error("\x6c\x6f\x61\x64\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x74\x69\x6d\x65\x72",a),setTimeout(c,14e3)})})},o.prototype.onBind=function(a){j=a,m.loadBlockChain()},o.prototype.onBlockchainReady=function(){m.loaded=!0},o.prototype.cleanup=function(a){m.loaded=!1,m.isActive?setImmediate(function b(){m.isActive?setTimeout(b,1e3):a()}):a()},n.status=function(a,b){b(null,{loaded:m.loaded,now:m.loadingLastBlock.height,blocksCount:m.total})},n.sync=function(a,b){b(null,{sync:l.syncing(),blocks:m.blocksToSync,height:j.blocks.getLastBlock().height})},a.exports=o}),c.register("\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x2e\x6a\x73",function(a,b,c){function w(){this.create=function(a,b){return b.recipientId=null,b.amount=0,b.asset.multisignature={min:a.min,keysgroup:a.keysgroup,lifetime:a.lifetime},b},this.calculateFee=function(a){return 5*(a.asset.multisignature.keysgroup.length+1)*i.fixedPoint},this.verify=function(a,b,c){var d,f,g;if(!a.asset.multisignature)return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x61\x73\x73\x65\x74\x3a\x20"+a.id);if(!e.isArray(a.asset.multisignature.keysgroup))return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x61\x73\x73\x65\x74\x3a\x20"+a.id);if(0==a.asset.multisignature.keysgroup.length)return setImmediate(c,"\x4d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x67\x72\x6f\x75\x70\x20\x6d\x75\x73\x74\x20\x63\x6f\x6e\x74\x61\x69\x6e\x20\x61\x74\x20\x6c\x65\x61\x73\x74\x20\x6f\x6e\x65\x20\x6d\x65\x6d\x62\x65\x72");if(a.asset.multisignature.min<=1||a.asset.multisignature.min>16)return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x61\x73\x73\x65\x74\x3a\x20"+a.id);if(a.asset.multisignature.min>a.asset.multisignature.keysgroup.length+1)return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x6d\x69\x6e");if(a.asset.multisignature.lifetime<1||a.asset.multisignature.lifetime>72)return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x6c\x69\x66\x65\x74\x69\x6d\x65\x3a\x20"+a.id);if(this.ready(a,b))try{for(d=0;d<a.asset.multisignature.keysgroup.length;d++){if(f=!1,a.signatures)for(g=0;g<a.signatures.length&&!f;g++)f="\x2d"!=a.asset.multisignature.keysgroup[d][0]&&"\x2b"!=a.asset.multisignature.keysgroup[d][0]?!1:s.logic.transaction.verifySignature(a,a.asset.multisignature.keysgroup[d].substring(1),a.signatures[g]);if(!f)return setImmediate(c,"\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x76\x65\x72\x69\x66\x79\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x3a\x20"+a.id)}}catch(h){return setImmediate(c,"\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x76\x65\x72\x69\x66\x79\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x3a\x20"+a.id)}return-1!=a.asset.multisignature.keysgroup.indexOf("\x2b"+b.publicKey)?setImmediate(c,"\x55\x6e\x61\x62\x6c\x65\x20\x74\x6f\x20\x73\x69\x67\x6e\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x75\x73\x69\x6e\x67\x20\x6f\x77\x6e\x20\x70\x75\x62\x6c\x69\x63\x20\x6b\x65\x79"):void m.eachSeries(a.asset.multisignature.keysgroup,function(a,b){var e,c=a[0],d=a.slice(1);if("\x2b"!=c)return b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x6d\x61\x74\x68\x20\x6f\x70\x65\x72\x61\x74\x6f\x72");try{if(e=new Buffer(d,"\x68\x65\x78"),32!=e.length)return b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x75\x62\x6c\x69\x63\x20\x6b\x65\x79")}catch(f){return b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x75\x62\x6c\x69\x63\x20\x6b\x65\x79")}return setImmediate(b)},function(b){if(b)return c(b);var d=a.asset.multisignature.keysgroup.reduce(function(a,b){return a.indexOf(b)<0&&a.push(b),a},[]);return d.length!=a.asset.multisignature.keysgroup.length?setImmediate(c,"\x4d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x67\x72\x6f\x75\x70\x20\x63\x6f\x6e\x74\x61\x69\x6e\x73\x20\x6e\x6f\x6e\x2d\x75\x6e\x69\x71\x75\x65\x20\x70\x75\x62\x6c\x69\x63\x20\x6b\x65\x79\x73"):void setImmediate(c,null,a)})},this.process=function(a,b,c){setImmediate(c,null,a)},this.getBytes=function(a){var e,c=new Buffer(a.asset.multisignature.keysgroup.join(""),"\x75\x74\x66\x38"),d=new f(2+c.length,!0);for(d.writeByte(a.asset.multisignature.min),d.writeByte(a.asset.multisignature.lifetime),e=0;e<c.length;e++)d.writeByte(c[e]);return d.flip(),d.toBuffer()},this.apply=function(a,b,c,d){u.unconfirmedSignatures[c.address]=!1,this.scope.account.merge(c.address,{multisignatures:a.asset.multisignature.keysgroup,multimin:a.asset.multisignature.min,multilifetime:a.asset.multisignature.lifetime,blockId:b.id,round:r.round.calc(b.height)},function(b){return b?d(b):void m.eachSeries(a.asset.multisignature.keysgroup,function(a,b){var c=a.substring(1),d=r.accounts.generateAddressByPublicKey(c);r.accounts.setAccountAndGet({address:d,publicKey:c},function(a){b(a)})},d)})},this.undo=function(a,b,c,d){var e=p.reverse(a.asset.multisignature.keysgroup);u.unconfirmedSignatures[c.address]=!0,this.scope.account.merge(c.address,{multisignatures:e,multimin:-a.asset.multisignature.min,multilifetime:-a.asset.multisignature.lifetime,blockId:b.id,round:r.round.calc(b.height)},function(a){d(a)})},this.applyUnconfirmed=function(a,b,c){return u.unconfirmedSignatures[b.address]?setImmediate(c,"\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x6f\x6e\x20\x74\x68\x69\x73\x20\x61\x63\x63\x6f\x75\x6e\x74\x20\x69\x73\x20\x70\x65\x6e\x64\x69\x6e\x67\x20\x63\x6f\x6e\x66\x69\x72\x6d\x61\x74\x69\x6f\x6e"):b.multisignatures.length?setImmediate(c,"\x41\x63\x63\x6f\x75\x6e\x74\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x68\x61\x73\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x65\x6e\x61\x62\x6c\x65\x64"):(u.unconfirmedSignatures[b.address]=!0,void this.scope.account.merge(b.address,{u_multisignatures:a.asset.multisignature.keysgroup,u_multimin:a.asset.multisignature.min,u_multilifetime:a.asset.multisignature.lifetime},function(){c()}))},this.undoUnconfirmed=function(a,b,c){var d=p.reverse(a.asset.multisignature.keysgroup);u.unconfirmedSignatures[b.address]=!1,this.scope.account.merge(b.address,{u_multisignatures:d,u_multimin:-a.asset.multisignature.min,u_multilifetime:-a.asset.multisignature.lifetime},function(a){c(a)})},this.objectNormalize=function(a){var b=s.scheme.validate(a.asset.multisignature,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{min:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:1,maximum:15},keysgroup:{type:"\x61\x72\x72\x61\x79",minLength:1,maxLength:16},lifetime:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:1,maximum:24}},required:["\x6d\x69\x6e","\x6b\x65\x79\x73\x67\x72\x6f\x75\x70","\x6c\x69\x66\x65\x74\x69\x6d\x65"]});if(!b)throw Error(b.getLastError());return a},this.dbRead=function(a){if(a.m_keysgroup){var b={min:a.m_min,lifetime:a.m_lifetime,keysgroup:a.m_keysgroup.split("\x2c")};return{multisignature:b}}return null},this.dbSave=function(a,b){s.dbLite.query("\x49\x4e\x53\x45\x52\x54\x20\x49\x4e\x54\x4f\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x28\x6d\x69\x6e\x2c\x20\x6c\x69\x66\x65\x74\x69\x6d\x65\x2c\x20\x6b\x65\x79\x73\x67\x72\x6f\x75\x70\x2c\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29\x20\x56\x41\x4c\x55\x45\x53\x28\x24\x6d\x69\x6e\x2c\x20\x24\x6c\x69\x66\x65\x74\x69\x6d\x65\x2c\x20\x24\x6b\x65\x79\x73\x67\x72\x6f\x75\x70\x2c\x20\x24\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x29",{min:a.asset.multisignature.min,
lifetime:a.asset.multisignature.lifetime,keysgroup:a.asset.multisignature.keysgroup.join("\x2c"),transactionId:a.id},function(a){return a?b(a):(s.network.io.sockets.emit("\x6d\x75\x74\x6c\x73\x69\x67\x69\x61\x6e\x74\x75\x72\x65\x73\x2f\x63\x68\x61\x6e\x67\x65",{}),b())})},this.ready=function(a,b){return a.signatures?b.multisignatures.length?a.signatures.length>=b.multimin-1:a.signatures.length==a.asset.multisignature.keysgroup.length:!1}}function x(a,b){s=b,h=s.genesisblock,t=this,t.__private=u,u.attachApi(),s.logic.transaction.attachAssetType(o.MULTI,new w),setImmediate(a,null,t)}var r,s,t,d=c("\x65\x64\x32\x35\x35\x31\x39"),e=c("\x75\x74\x69\x6c"),f=c("\x62\x79\x74\x65\x62\x75\x66\x66\x65\x72"),g=c("\x63\x72\x79\x70\x74\x6f"),h=null,i=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x63\x6f\x6e\x73\x74\x61\x6e\x74\x73\x2e\x6a\x73"),l=(c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x6c\x6f\x74\x73\x2e\x6a\x73"),c("\x65\x78\x74\x65\x6e\x64"),c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x72\x6f\x75\x74\x65\x72\x2e\x6a\x73")),m=c("\x61\x73\x79\x6e\x63"),o=(c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x72\x65\x71\x75\x65\x73\x74\x2d\x73\x61\x6e\x69\x74\x69\x7a\x65\x72\x2e\x6a\x73"),c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x2d\x74\x79\x70\x65\x73\x2e\x6a\x73")),p=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x64\x69\x66\x66\x2e\x6a\x73"),q=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x61\x6e\x64\x62\x6f\x78\x2e\x6a\x73"),u={},v={};u.unconfirmedSignatures={},u.attachApi=function(){var a=new l;a.use(function(a,b,c){return r?c():void b.status(500).send({success:!1,error:"\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x69\x73\x20\x6c\x6f\x61\x64\x69\x6e\x67"})}),a.map(v,{"get /pending":"\x70\x65\x6e\x64\x69\x6e\x67","post /sign":"\x73\x69\x67\x6e","put /":"\x61\x64\x64\x4d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65","get /accounts":"\x67\x65\x74\x41\x63\x63\x6f\x75\x6e\x74\x73"}),a.use(function(a,b){b.status(500).send({success:!1,error:"\x41\x50\x49\x20\x65\x6e\x64\x70\x6f\x69\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64"})}),s.network.app.use("\x2f\x61\x70\x69\x2f\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73",a),s.network.app.use(function(a,b,c,d){return a?(s.logger.error(b.url,""+a),void c.status(500).send({success:!1,error:""+a})):d()})},x.prototype.sandboxApi=function(a,b,c){q.callMethod(v,a,b,c)},x.prototype.onBind=function(a){r=a},v.getAccounts=function(a,b){var c=a.body;s.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{publicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"}},required:["\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"]},function(a){return a?b(a[0].message):void s.dbLite.query("\x73\x65\x6c\x65\x63\x74\x20\x47\x52\x4f\x55\x50\x5f\x43\x4f\x4e\x43\x41\x54\x28\x61\x63\x63\x6f\x75\x6e\x74\x49\x64\x29\x20\x66\x72\x6f\x6d\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x32\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x77\x68\x65\x72\x65\x20\x64\x65\x70\x65\x6e\x64\x65\x6e\x74\x49\x64\x20\x3d\x20\x24\x70\x75\x62\x6c\x69\x63\x4b\x65\x79",{publicKey:c.publicKey},["\x61\x63\x63\x6f\x75\x6e\x74\x49\x64"],function(a,c){if(a)return s.logger.error(""+a),b("\x44\x61\x74\x61\x62\x61\x73\x65\x20\x65\x72\x72\x6f\x72");var d=c[0].accountId.split("\x2c");r.accounts.getAccounts({address:{$in:d},sort:"\x62\x61\x6c\x61\x6e\x63\x65"},["\x61\x64\x64\x72\x65\x73\x73","\x62\x61\x6c\x61\x6e\x63\x65","\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73","\x6d\x75\x6c\x74\x69\x6c\x69\x66\x65\x74\x69\x6d\x65","\x6d\x75\x6c\x74\x69\x6d\x69\x6e"],function(a,c){return a?(s.logger.error(a),b("\x44\x61\x74\x61\x62\x61\x73\x65\x20\x65\x72\x72\x6f\x72")):void m.eachSeries(c,function(a,b){var d,c=[];for(d=0;d<a.multisignatures.length;d++)c.push(r.accounts.generateAddressByPublicKey(a.multisignatures[d]));r.accounts.getAccounts({address:{$in:c}},["\x61\x64\x64\x72\x65\x73\x73","\x70\x75\x62\x6c\x69\x63\x4b\x65\x79","\x62\x61\x6c\x61\x6e\x63\x65","\x75\x73\x65\x72\x6e\x61\x6d\x65"],function(c,d){return c?b(c):(a.multisigaccounts=d,b())})},function(a){return a?b(a):b(null,{accounts:c})})})})})},v.pending=function(a,b){var c=a.body;s.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{publicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"}},required:["\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"]},function(a){var d,e;return a?b(a[0].message):(d=r.transactions.getUnconfirmedTransactionList(),e=[],void m.eachSeries(d,function(a,b){var f,g,h,d=!1;if(!f&&a.signatures&&a.signatures.length>0){f=!1;for(g in a.signatures){h=a.signatures[g];try{f=s.logic.transaction.verifySignature(a,c.publicKey,a.signatures[g])}catch(i){f=!1}if(f)break}f&&(d=!0)}d||a.senderPublicKey!=c.publicKey||(d=!0),r.accounts.getAccount({publicKey:a.senderPublicKey},function(f,g){var h,i,j;return f?b(f):g?((g.publicKey==c.publicKey&&g.u_multisignatures.length>0||g.u_multisignatures.indexOf(c.publicKey)>=0||g.multisignatures.indexOf(c.publicKey)>=0)&&(h=g.u_multimin||g.multimin,i=g.u_multilifetime||g.multilifetime,j=g.u_multisignatures.length,e.push({max:j.length,min:h,lifetime:i,signed:d,transaction:a})),b()):b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x6e\x64\x65\x72")})},function(){return b(null,{transactions:e})}))})},x.prototype.processSignature=function(a,b){function d(b){s.balancesSequence.add(function(b){var c=r.transactions.getUnconfirmedTransaction(a.transaction);return c?(c.signatures=c.signatures||[],c.signatures.push(a.signature),s.bus.message("\x73\x69\x67\x6e\x61\x74\x75\x72\x65",c,!0),void b()):b("\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")},b)}var e,f,g,c=r.transactions.getUnconfirmedTransaction(a.transaction);if(!c)return b("\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64");if(c.type==o.MULTI){if(c.signatures=c.signatures||[],c.asset.multisignature.signatures||-1!=c.signatures.indexOf(a.signature))return b("\x50\x65\x72\x6d\x69\x73\x73\x69\x6f\x6e\x20\x74\x6f\x20\x73\x69\x67\x6e\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x64\x65\x6e\x69\x65\x64");e=!1;try{for(f=0;f<c.asset.multisignature.keysgroup.length&&!e;f++)g=c.asset.multisignature.keysgroup[f].substring(1),e=s.logic.transaction.verifySignature(c,g,a.signature)}catch(h){return b("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x76\x65\x72\x69\x66\x79\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65")}if(!e)return b("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x76\x65\x72\x69\x66\x79\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65");d(b)}else r.accounts.getAccount({address:c.senderId},function(e,f){var g,h,i;if(e)return b("\x4d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x61\x63\x63\x6f\x75\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64");if(g=!1,h=f.multisignatures,c.requesterPublicKey&&h.push(c.senderPublicKey),!f)return b("\x41\x63\x63\x6f\x75\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64");if(c.signatures=c.signatures||[],c.signatures.indexOf(a.signature)>=0)return b("\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x65\x78\x69\x73\x74\x73");try{for(i=0;i<h.length&&!g;i++)g=s.logic.transaction.verifySignature(c,h[i],a.signature)}catch(j){return b("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x76\x65\x72\x69\x66\x79\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65")}return g?(s.network.io.sockets.emit("\x6d\x75\x74\x6c\x73\x69\x67\x69\x61\x6e\x74\x75\x72\x65\x73\x2f\x73\x69\x6e\x67\x61\x74\x75\x72\x65\x2f\x63\x68\x61\x6e\x67\x65",{}),d(b)):b("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x76\x65\x72\x69\x66\x79\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65")})},v.sign=function(a,b){var c=a.body;s.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{secret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:100},secondSecret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:100},publicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"},transactionId:{type:"\x73\x74\x72\x69\x6e\x67"}},required:["\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64","\x73\x65\x63\x72\x65\x74"]},function(a){function j(a){s.balancesSequence.add(function(a){var b=r.transactions.getUnconfirmedTransaction(c.transactionId);return b?(b.signatures=b.signatures||[],b.signatures.push(i),s.bus.message("\x73\x69\x67\x6e\x61\x74\x75\x72\x65",{signature:i,transaction:b.id},!0),void a()):a("\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")},function(b){return b?a(""+b):void a(null,{transactionId:e.id})})}var e,f,h,i;if(a)return b(a[0].message);if(e=r.transactions.getUnconfirmedTransaction(c.transactionId),!e)return b("\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64");if(f=g.createHash("\x73\x68\x61\x32\x35\x36").update(c.secret,"\x75\x74\x66\x38").digest(),h=d.MakeKeypair(f),c.publicKey&&h.publicKey.toString("\x68\x65\x78")!=c.publicKey)return b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65");if(i=s.logic.transaction.multisign(h,e),e.type==o.MULTI){if(-1==e.asset.multisignature.keysgroup.indexOf("\x2b"+h.publicKey.toString("\x68\x65\x78"))||e.signatures&&-1!=e.signatures.indexOf(i.toString("\x68\x65\x78")))return b("\x50\x65\x72\x6d\x69\x73\x73\x69\x6f\x6e\x20\x74\x6f\x20\x73\x69\x67\x6e\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x64\x65\x6e\x69\x65\x64");s.network.io.sockets.emit("\x6d\x75\x74\x6c\x73\x69\x67\x69\x61\x6e\x74\x75\x72\x65\x73\x2f\x73\x69\x6e\x67\x61\x74\x75\x72\x65\x2f\x63\x68\x61\x6e\x67\x65",{}),j(b)}else r.accounts.getAccount({address:e.senderId},function(a,c){if(a)return b("\x4d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x61\x63\x63\x6f\x75\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64");if(!c)return b("\x41\x63\x63\x6f\x75\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64");if(e.requesterPublicKey){if(c.publicKey!=h.publicKey.toString("\x68\x65\x78")||e.senderPublicKey!=h.publicKey.toString("\x68\x65\x78"))return b("\x50\x65\x72\x6d\x69\x73\x73\x69\x6f\x6e\x20\x74\x6f\x20\x73\x69\x67\x6e\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x64\x65\x6e\x69\x65\x64")}else if(c.multisignatures.indexOf(h.publicKey.toString("\x68\x65\x78"))<0)return b("\x50\x65\x72\x6d\x69\x73\x73\x69\x6f\x6e\x20\x74\x6f\x20\x73\x69\x67\x6e\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x64\x65\x6e\x69\x65\x64");return e.signatures&&-1!=e.signatures.indexOf(i)?b("\x50\x65\x72\x6d\x69\x73\x73\x69\x6f\x6e\x20\x74\x6f\x20\x73\x69\x67\x6e\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x64\x65\x6e\x69\x65\x64"):(s.network.io.sockets.emit("\x6d\x75\x74\x6c\x73\x69\x67\x69\x61\x6e\x74\x75\x72\x65\x73\x2f\x73\x69\x6e\x67\x61\x74\x75\x72\x65\x2f\x63\x68\x61\x6e\x67\x65",{}),void j(b))})})},v.addMultisignature=function(a,b){var c=a.body;s.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{secret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:100},publicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"},secondSecret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:100},min:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:1,maximum:16},lifetime:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:1,maximum:24},keysgroup:{type:"\x61\x72\x72\x61\x79",minLength:1,maxLength:10}},required:["\x6d\x69\x6e","\x6c\x69\x66\x65\x74\x69\x6d\x65","\x6b\x65\x79\x73\x67\x72\x6f\x75\x70","\x73\x65\x63\x72\x65\x74"]},function(a){var e,f;return a?b(a[0].message):(e=g.createHash("\x73\x68\x61\x32\x35\x36").update(c.secret,"\x75\x74\x66\x38").digest(),f=d.MakeKeypair(e),c.publicKey&&f.publicKey.toString("\x68\x65\x78")!=c.publicKey?b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65"):void s.balancesSequence.add(function(a){r.accounts.getAccount({publicKey:f.publicKey.toString("\x68\x65\x78")},function(b,e){var h,i,j;if(b)return a(""+b);if(!e||!e.publicKey)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x61\x63\x63\x6f\x75\x6e\x74");if(e.secondSignature&&!c.secondSecret)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x63\x6f\x6e\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65");h=null,e.secondSignature&&(i=g.createHash("\x73\x68\x61\x32\x35\x36").update(c.secondSecret,"\x75\x74\x66\x38").digest(),h=d.MakeKeypair(i));try{j=s.logic.transaction.create({type:o.MULTI,sender:e,keypair:f,secondKeypair:h,min:c.min,keysgroup:c.keysgroup,lifetime:c.lifetime})}catch(k){return a(""+k)}r.transactions.receiveTransactions([j],a)})},function(a,c){return a?b(""+a):(s.network.io.sockets.emit("\x6d\x75\x74\x6c\x73\x69\x67\x69\x61\x6e\x74\x75\x72\x65\x73\x2f\x63\x68\x61\x6e\x67\x65",{}),void b(null,{transactionId:c[0].id}))}))})},a.exports=x}),c.register("\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x70\x65\x65\x72\x2e\x6a\x73",function(a,b,c){function q(a,b){m=b,n=this,n.__private=o,o.attachApi(),setImmediate(a,null,n)}var l,m,n,o,p,d=c("\x61\x73\x79\x6e\x63"),f=(c("\x75\x74\x69\x6c"),c("\x69\x70")),g=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x72\x6f\x75\x74\x65\x72\x2e\x6a\x73"),h=c("\x65\x78\x74\x65\x6e\x64"),k=(c("\x66\x73"),c("\x70\x61\x74\x68"),c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x61\x6e\x64\x62\x6f\x78\x2e\x6a\x73"));c("\x61\x72\x72\x61\x79\x2e\x70\x72\x6f\x74\x6f\x74\x79\x70\x65\x2e\x66\x69\x6e\x64"),o={},p={},o.attachApi=function(){var a=new g;a.use(function(a,b,c){return l?c():void b.status(500).send({success:!1,error:"\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x69\x73\x20\x6c\x6f\x61\x64\x69\x6e\x67"})}),a.map(p,{"get /":"\x67\x65\x74\x50\x65\x65\x72\x73","get /version":"\x76\x65\x72\x73\x69\x6f\x6e","get /get":"\x67\x65\x74\x50\x65\x65\x72"}),a.use(function(a,b){b.status(500).send({success:!1,error:"\x41\x50\x49\x20\x65\x6e\x64\x70\x6f\x69\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64"})}),m.network.app.use("\x2f\x61\x70\x69\x2f\x70\x65\x65\x72\x73",a),m.network.app.use(function(a,b,c,d){return a?(m.logger.error(b.url,""+a),void c.status(500).send({success:!1,error:""+a})):d()})},o.updatePeerList=function(a){l.transport.getFromRandomPeer({api:"\x2f\x6c\x69\x73\x74",method:"\x47\x45\x54"},function(b,c){if(b)return a();m.scheme.validate(c.body.peers,{type:"\x61\x72\x72\x61\x79",required:!0,uniqueItems:!0});m.scheme.validate(c.body,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{peers:{type:"\x61\x72\x72\x61\x79",uniqueItems:!0}},required:["\x70\x65\x65\x72\x73"]},function(b){if(b)return a();var e=c.body.peers;d.eachLimit(e,2,function(a,b){m.scheme.validate(a,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{ip:{type:"\x73\x74\x72\x69\x6e\x67"},port:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:1,maximum:65535},state:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:3},os:{type:"\x73\x74\x72\x69\x6e\x67"},sharePort:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:1},version:{type:"\x73\x74\x72\x69\x6e\x67"}},required:["\x69\x70","\x70\x6f\x72\x74","\x73\x74\x61\x74\x65"]},function(c){return c?(console.log(c,a),setImmediate(b,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x65\x65\x72\x3a\x20"+c)):(a.ip=parseInt(a.ip),isNaN(a.ip)?setImmediate(b):f.toLong("\x31\x32\x37\x2e\x30\x2e\x30\x2e\x31")==a.ip||0==a.port||a.port>65535?setImmediate(b):void n.update(a,b))})},a)})})},o.count=function(a){m.dbLite.query("\x73\x65\x6c\x65\x63\x74\x20\x63\x6f\x75\x6e\x74\x28\x2a\x29\x20\x66\x72\x6f\x6d\x20\x70\x65\x65\x72\x73",{count:Number},function(b,c){if(b)return m.logger.error("\x50\x65\x65\x72\x23\x63\x6f\x75\x6e\x74",b),a(b);var d=c.length&&c[0].count;a(null,d)})},o.banManager=function(a){m.dbLite.query("\x55\x50\x44\x41\x54\x45\x20\x70\x65\x65\x72\x73\x20\x53\x45\x54\x20\x73\x74\x61\x74\x65\x20\x3d\x20\x31\x2c\x20\x63\x6c\x6f\x63\x6b\x20\x3d\x20\x6e\x75\x6c\x6c\x20\x77\x68\x65\x72\x65\x20\x28\x73\x74\x61\x74\x65\x20\x3d\x20\x30\x20\x61\x6e\x64\x20\x63\x6c\x6f\x63\x6b\x20\x2d\x20\x24\x6e\x6f\x77\x20\x3c\x20\x30\x29",{now:Date.now()},a)},o.getByFilter=function(a,b){var h,i,j,c=["\x69\x70","\x70\x6f\x72\x74","\x73\x74\x61\x74\x65","\x6f\x73","\x73\x68\x61\x72\x65\x50\x6f\x72\x74","\x76\x65\x72\x73\x69\x6f\x6e"],d="",e="",f=a.limit||null,g=a.offset||null;if(delete a.limit,delete a.offset,h=[],i={},a.hasOwnProperty("\x73\x74\x61\x74\x65")&&null!==a.state&&(h.push("\x73\x74\x61\x74\x65\x20\x3d\x20\x24\x73\x74\x61\x74\x65"),i.state=a.state),a.hasOwnProperty("\x6f\x73")&&null!==a.os&&(h.push("\x6f\x73\x20\x3d\x20\x24\x6f\x73"),i.os=a.os),a.hasOwnProperty("\x76\x65\x72\x73\x69\x6f\x6e")&&null!==a.version&&(h.push("\x76\x65\x72\x73\x69\x6f\x6e\x20\x3d\x20\x24\x76\x65\x72\x73\x69\x6f\x6e"),i.version=a.version),a.hasOwnProperty("\x73\x68\x61\x72\x65\x64")&&null!==a.shared&&(h.push("\x73\x68\x61\x72\x65\x50\x6f\x72\x74\x20\x3d\x20\x24\x73\x68\x61\x72\x65\x50\x6f\x72\x74"),i.sharePort=a.shared),a.hasOwnProperty("\x69\x70")&&null!==a.ip&&(h.push("\x69\x70\x20\x3d\x20\x24\x69\x70"),i.ip=a.ip),a.hasOwnProperty("\x70\x6f\x72\x74")&&null!==a.port&&(h.push("\x70\x6f\x72\x74\x20\x3d\x20\x24\x70\x6f\x72\x74"),i.port=a.port),a.hasOwnProperty("\x6f\x72\x64\x65\x72\x42\x79")&&(j=a.orderBy.split("\x3a"),e=j[0].replace(/[^\w\s]/gi,""),d=2==j.length?"\x64\x65\x73\x63"==j[1]?"\x64\x65\x73\x63":"\x61\x73\x63":"\x64\x65\x73\x63"),e&&c.indexOf(e)<0)return b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x6f\x72\x74\x20\x66\x69\x65\x6c\x64");if(null!==f){if(f>100)return b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x6c\x69\x6d\x69\x74\x2e\x20\x4d\x61\x78\x69\x6d\x75\x6d\x20\x69\x73\x20\x31\x30\x30");i.limit=f}null!==g&&(i.offset=g),m.dbLite.query("\x73\x65\x6c\x65\x63\x74\x20\x69\x70\x2c\x20\x70\x6f\x72\x74\x2c\x20\x73\x74\x61\x74\x65\x2c\x20\x6f\x73\x2c\x20\x73\x68\x61\x72\x65\x50\x6f\x72\x74\x2c\x20\x76\x65\x72\x73\x69\x6f\x6e\x20\x66\x72\x6f\x6d\x20\x70\x65\x65\x72\x73"+(h.length?"\x20\x77\x68\x65\x72\x65\x20"+h.join("\x20\x61\x6e\x64\x20"):"")+(e?"\x20\x6f\x72\x64\x65\x72\x20\x62\x79\x20"+e+"\x20"+d:"")+"\x20"+(f?"\x20\x6c\x69\x6d\x69\x74\x20\x24\x6c\x69\x6d\x69\x74":"")+(g?"\x20\x6f\x66\x66\x73\x65\x74\x20\x24\x6f\x66\x66\x73\x65\x74\x20":""),i,{ip:String,port:Number,state:Number,os:String,sharePort:Number,version:String},function(a,c){b(a,c)})},q.prototype.list=function(a,b){a.limit=a.limit||100,m.dbLite.query("\x73\x65\x6c\x65\x63\x74\x20\x70\x2e\x69\x70\x2c\x20\x70\x2e\x70\x6f\x72\x74\x2c\x20\x70\x2e\x73\x74\x61\x74\x65\x2c\x20\x70\x2e\x6f\x73\x2c\x20\x70\x2e\x73\x68\x61\x72\x65\x50\x6f\x72\x74\x2c\x20\x70\x2e\x76\x65\x72\x73\x69\x6f\x6e\x20\x66\x72\x6f\x6d\x20\x70\x65\x65\x72\x73\x20\x70\x20"+(a.dappid?"\x20\x69\x6e\x6e\x65\x72\x20\x6a\x6f\x69\x6e\x20\x70\x65\x65\x72\x73\x5f\x64\x61\x70\x70\x20\x70\x64\x20\x6f\x6e\x20\x70\x2e\x69\x64\x20\x3d\x20\x70\x64\x2e\x70\x65\x65\x72\x49\x64\x20\x61\x6e\x64\x20\x70\x64\x2e\x64\x61\x70\x70\x69\x64\x20\x3d\x20\x24\x64\x61\x70\x70\x69\x64\x20":"")+"\x20\x77\x68\x65\x72\x65\x20\x70\x2e\x73\x74\x61\x74\x65\x20\x3e\x20\x30\x20\x61\x6e\x64\x20\x70\x2e\x73\x68\x61\x72\x65\x50\x6f\x72\x74\x20\x3d\x20\x31\x20\x4f\x52\x44\x45\x52\x20\x42\x59\x20\x52\x41\x4e\x44\x4f\x4d\x28\x29\x20\x4c\x49\x4d\x49\x54\x20\x24\x6c\x69\x6d\x69\x74",a,{ip:String,port:Number,state:Number,os:String,sharePort:Number,version:String},function(a,c){b(a,c)})},q.prototype.state=function(a,b,c,d,e){var h,g=m.config.peers.list.find(function(c){return c.ip==f.fromLong(a)&&c.port==b});return void 0!==g?e&&e("\x50\x65\x65\x72\x20\x69\x6e\x20\x77\x68\x69\x74\x65\x20\x6c\x69\x73\x74"):(0==c?(h=1e3*(d||1),h=Date.now()+h):h=null,void m.dbLite.query("\x55\x50\x44\x41\x54\x45\x20\x70\x65\x65\x72\x73\x20\x53\x45\x54\x20\x73\x74\x61\x74\x65\x20\x3d\x20\x24\x73\x74\x61\x74\x65\x2c\x20\x63\x6c\x6f\x63\x6b\x20\x3d\x20\x24\x63\x6c\x6f\x63\x6b\x20\x57\x48\x45\x52\x45\x20\x69\x70\x20\x3d\x20\x24\x69\x70\x20\x61\x6e\x64\x20\x70\x6f\x72\x74\x20\x3d\x20\x24\x70\x6f\x72\x74\x3b",{state:c,clock:h,ip:a,port:b},function(a){a&&m.logger.error("\x50\x65\x65\x72\x23\x73\x74\x61\x74\x65",a),e&&e()}))},q.prototype.remove=function(a,b,c){var d=m.config.peers.list.find(function(c){return c.ip==f.fromLong(a)&&c.port==b});return void 0!==d?c&&c("\x50\x65\x65\x72\x20\x69\x6e\x20\x77\x68\x69\x74\x65\x20\x6c\x69\x73\x74"):void m.dbLite.query("\x44\x45\x4c\x45\x54\x45\x20\x46\x52\x4f\x4d\x20\x70\x65\x65\x72\x73\x20\x57\x48\x45\x52\x45\x20\x69\x70\x20\x3d\x20\x24\x69\x70\x20\x61\x6e\x64\x20\x70\x6f\x72\x74\x20\x3d\x20\x24\x70\x6f\x72\x74\x3b",{ip:a,port:b},function(a){a&&m.logger.error("\x50\x65\x65\x72\x23\x64\x65\x6c\x65\x74\x65",a),c&&c(a)})},q.prototype.addDapp=function(a,b){m.dbLite.query("\x53\x45\x4c\x45\x43\x54\x20\x69\x64\x20\x66\x72\x6f\x6d\x20\x70\x65\x65\x72\x73\x20\x77\x68\x65\x72\x65\x20\x69\x70\x20\x3d\x20\x24\x69\x70\x20\x61\x6e\x64\x20\x70\x6f\x72\x74\x20\x3d\x20\x24\x70\x6f\x72\x74",{ip:a.ip,port:a.port},["\x69\x64"],function(c,d){if(c)return b(c);if(!d.length)return b();var e=d[0].id;m.dbLite.query("\x49\x4e\x53\x45\x52\x54\x20\x4f\x52\x20\x49\x47\x4e\x4f\x52\x45\x20\x49\x4e\x54\x4f\x20\x70\x65\x65\x72\x73\x5f\x64\x61\x70\x70\x20\x28\x70\x65\x65\x72\x49\x64\x2c\x20\x64\x61\x70\x70\x49\x64\x29\x20\x56\x41\x4c\x55\x45\x53\x20\x28\x24\x70\x65\x65\x72\x49\x64\x2c\x20\x24\x64\x61\x70\x70\x49\x64\x29\x3b",{dappId:a.dappid,peerId:e},b)})},q.prototype.update=function(a,b){var c=a.dappid,e={ip:a.ip,port:a.port,os:a.os||null,sharePort:a.sharePort,version:a.version||null};d.series([function(a){m.dbLite.query("\x49\x4e\x53\x45\x52\x54\x20\x4f\x52\x20\x49\x47\x4e\x4f\x52\x45\x20\x49\x4e\x54\x4f\x20\x70\x65\x65\x72\x73\x20\x28\x69\x70\x2c\x20\x70\x6f\x72\x74\x2c\x20\x73\x74\x61\x74\x65\x2c\x20\x6f\x73\x2c\x20\x73\x68\x61\x72\x65\x50\x6f\x72\x74\x2c\x20\x76\x65\x72\x73\x69\x6f\x6e\x29\x20\x56\x41\x4c\x55\x45\x53\x20\x28\x24\x69\x70\x2c\x20\x24\x70\x6f\x72\x74\x2c\x20\x24\x73\x74\x61\x74\x65\x2c\x20\x24\x6f\x73\x2c\x20\x24\x73\x68\x61\x72\x65\x50\x6f\x72\x74\x2c\x20\x24\x76\x65\x72\x73\x69\x6f\x6e\x29\x3b",h({},e,{state:1}),a)},function(b){void 0!==a.state&&(e.state=a.state),m.dbLite.query("\x55\x50\x44\x41\x54\x45\x20\x70\x65\x65\x72\x73\x20\x53\x45\x54\x20\x6f\x73\x20\x3d\x20\x24\x6f\x73\x2c\x20\x73\x68\x61\x72\x65\x50\x6f\x72\x74\x20\x3d\x20\x24\x73\x68\x61\x72\x65\x50\x6f\x72\x74\x2c\x20\x76\x65\x72\x73\x69\x6f\x6e\x20\x3d\x20\x24\x76\x65\x72\x73\x69\x6f\x6e"+(void 0!==a.state?"\x2c\x20\x73\x74\x61\x74\x65\x20\x3d\x20\x43\x41\x53\x45\x20\x57\x48\x45\x4e\x20\x73\x74\x61\x74\x65\x20\x3d\x20\x30\x20\x54\x48\x45\x4e\x20\x73\x74\x61\x74\x65\x20\x45\x4c\x53\x45\x20\x24\x73\x74\x61\x74\x65\x20\x45\x4e\x44\x20":"")+"\x20\x57\x48\x45\x52\x45\x20\x69\x70\x20\x3d\x20\x24\x69\x70\x20\x61\x6e\x64\x20\x70\x6f\x72\x74\x20\x3d\x20\x24\x70\x6f\x72\x74\x3b",e,b)},function(b){c?n.addDapp({dappid:c,ip:a.ip,port:a.port},b):setImmediate(b)}],function(a){a&&m.logger.error("\x50\x65\x65\x72\x23\x75\x70\x64\x61\x74\x65",a),b&&b()})},q.prototype.sandboxApi=function(a,b,c){k.callMethod(p,a,b,c)},q.prototype.onBind=function(a){l=a},q.prototype.onBlockchainReady=function(){d.eachSeries(m.config.peers.list,function(a,b){m.dbLite.query("\x49\x4e\x53\x45\x52\x54\x20\x4f\x52\x20\x49\x47\x4e\x4f\x52\x45\x20\x49\x4e\x54\x4f\x20\x70\x65\x65\x72\x73\x28\x69\x70\x2c\x20\x70\x6f\x72\x74\x2c\x20\x73\x74\x61\x74\x65\x2c\x20\x73\x68\x61\x72\x65\x50\x6f\x72\x74\x29\x20\x56\x41\x4c\x55\x45\x53\x28\x24\x69\x70\x2c\x20\x24\x70\x6f\x72\x74\x2c\x20\x24\x73\x74\x61\x74\x65\x2c\x20\x24\x73\x68\x61\x72\x65\x50\x6f\x72\x74\x29",{ip:f.toLong(a.ip),port:a.port,state:2,sharePort:1},b)},function(a){a&&m.logger.error("\x6f\x6e\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x52\x65\x61\x64\x79",a),o.count(function(a,b){b?(o.updatePeerList(function(a){a&&m.logger.error("\x75\x70\x64\x61\x74\x65\x50\x65\x65\x72\x4c\x69\x73\x74",a),m.bus.message("\x70\x65\x65\x72\x52\x65\x61\x64\x79")}),m.logger.info("\x50\x65\x65\x72\x73\x20\x72\x65\x61\x64\x79\x2c\x20\x73\x74\x6f\x72\x65\x64\x20"+b)):m.logger.warn("\x50\x65\x65\x72\x73\x20\x6c\x69\x73\x74\x20\x69\x73\x20\x65\x6d\x70\x74\x79")})})},q.prototype.onPeerReady=function(){setImmediate(function a(){o.updatePeerList(function(b){b&&m.logger.error("\x75\x70\x64\x61\x74\x65\x50\x65\x65\x72\x4c\x69\x73\x74\x20\x74\x69\x6d\x65\x72",b),setTimeout(a,6e4)})}),setImmediate(function b(){o.banManager(function(a){a&&m.logger.error("\x62\x61\x6e\x4d\x61\x6e\x61\x67\x65\x72\x20\x74\x69\x6d\x65\x72",a),setTimeout(b,65e3)})})},p.getPeers=function(a,b){var c=a.body;m.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{state:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:3},os:{type:"\x73\x74\x72\x69\x6e\x67"},version:{type:"\x73\x74\x72\x69\x6e\x67"},limit:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:100},shared:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:1},orderBy:{type:"\x73\x74\x72\x69\x6e\x67"},offset:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0},port:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:1,maximum:65535}}},function(a){return a?b(a[0].message):c.limit<0||c.limit>100?b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x6c\x69\x6d\x69\x74\x2e\x20\x4d\x61\x78\x69\x6d\x75\x6d\x20\x69\x73\x20\x31\x30\x30"):void o.getByFilter(c,function(a,c){if(a)return b("\x50\x65\x65\x72\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64");for(var d=0;d<c.length;d++)c[d].ip=f.fromLong(c[d].ip);b(null,{peers:c})})})},p.getPeer=function(a,b){var c=a.body;m.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{ip_str:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1},port:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:65535}},required:["\x69\x70\x5f\x73\x74\x72","\x70\x6f\x72\x74"]},function(a){if(a)return b(a[0].message);try{var d=f.toLong(c.ip_str)}catch(e){return b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x65\x65\x72")}o.getByFilter({ip:d,port:port},function(a,c){if(a)return b("\x50\x65\x65\x72\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64");var d=c.length?c[0]:null;d&&(d.ip=f.fromLong(d.ip)),b(null,{peer:d||{}})})})},p.version=function(a,b){b(null,{version:m.config.version,build:m.build})},a.exports=q}),c.register("\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x72\x6f\x75\x6e\x64\x2e\x6a\x73",function(a,b,c){function n(a,b){j=b,k=this,k.__private=l,setImmediate(a,null,k)}function o(a){var b=parseInt(l.feesByRound[a])||0,c=l.rewardsByRound[a]||[];this.at=function(a){var d=Math.floor(b/f.delegates),e=b-d*f.delegates,g=parseInt(c[a])||0;return{fees:d,feesRemaining:e,rewards:g,balance:d+g}}}var i,j,k,d=c("\x61\x73\x79\x6e\x63"),f=(c("\x75\x74\x69\x6c"),c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x6c\x6f\x74\x73\x2e\x6a\x73")),g=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x61\x6e\x64\x62\x6f\x78\x2e\x6a\x73"),l=(c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x63\x6f\x6e\x73\x74\x61\x6e\x74\x73\x2e\x6a\x73"),{}),m={};l.loaded=!1,l.feesByRound={},l.rewardsByRound={},l.delegatesByRound={},l.unFeesByRound={},l.unRewardsByRound={},l.unDelegatesByRound={},n.prototype.loaded=function(){return l.loaded},n.prototype.calc=function(a){return Math.floor(a/f.delegates)+(a%f.delegates>0?1:0)},n.prototype.getVotes=function(a,b){j.dbLite.query("\x73\x65\x6c\x65\x63\x74\x20\x64\x65\x6c\x65\x67\x61\x74\x65\x2c\x20\x61\x6d\x6f\x75\x6e\x74\x20\x66\x72\x6f\x6d\x20\x28\x20\x73\x65\x6c\x65\x63\x74\x20\x6d\x2e\x64\x65\x6c\x65\x67\x61\x74\x65\x2c\x20\x73\x75\x6d\x28\x6d\x2e\x61\x6d\x6f\x75\x6e\x74\x29\x20\x61\x6d\x6f\x75\x6e\x74\x2c\x20\x6d\x2e\x72\x6f\x75\x6e\x64\x20\x66\x72\x6f\x6d\x20\x6d\x65\x6d\x5f\x72\x6f\x75\x6e\x64\x20\x6d\x20\x67\x72\x6f\x75\x70\x20\x62\x79\x20\x6d\x2e\x64\x65\x6c\x65\x67\x61\x74\x65\x2c\x20\x6d\x2e\x72\x6f\x75\x6e\x64\x20\x29\x20\x77\x68\x65\x72\x65\x20\x72\x6f\x75\x6e\x64\x20\x3d\x20\x24\x72\x6f\x75\x6e\x64",{round:a},{delegate:String,amount:Number},function(a,c){b(a,c)})},n.prototype.flush=function(a,b){j.dbLite.query("\x64\x65\x6c\x65\x74\x65\x20\x66\x72\x6f\x6d\x20\x6d\x65\x6d\x5f\x72\x6f\x75\x6e\x64\x20\x77\x68\x65\x72\x65\x20\x72\x6f\x75\x6e\x64\x20\x3d\x20\x24\x72\x6f\x75\x6e\x64",{round:a},b)},n.prototype.directionSwap=function(a,b,c){"\x62\x61\x63\x6b\x77\x61\x72\x64"==a?(l.feesByRound={},l.rewardsByRound={},l.delegatesByRound={},k.flush(k.calc(b.height),c)):(l.unFeesByRound={},l.unRewardsByRound={},l.unDelegatesByRound={},k.flush(k.calc(b.height),c))},n.prototype.backwardTick=function(a,b,c){function e(a){c&&c(a)}i.accounts.mergeAccountAndGet({publicKey:a.generatorPublicKey,producedblocks:-1,blockId:a.id,round:i.round.calc(a.height)},function(c){var g,h,m;return c?e(c):(g=k.calc(a.height),h=k.calc(b.height),l.unFeesByRound[g]=l.unFeesByRound[g]||0,l.unFeesByRound[g]+=a.totalFee,l.unRewardsByRound[g]=l.rewardsByRound[g]||[],l.unRewardsByRound[g].push(a.reward),l.unDelegatesByRound[g]=l.unDelegatesByRound[g]||[],l.unDelegatesByRound[g].push(a.generatorPublicKey),void(!(h===g&&1!=b.height||l.unDelegatesByRound[g].length!=f.delegates&&1!=b.height)?(m=[],d.series([function(b){1!=a.height?i.delegates.generateDelegateList(a.height,function(a,c){if(a)return b(a);for(var d=0;d<c.length;d++)-1==l.unDelegatesByRound[g].indexOf(c[d])&&m.push(i.accounts.generateAddressByPublicKey(c[d]));b()}):b()},function(a){if(!m.length)return a();var b=m.map(function(a){return"\x27"+a+"\x27"});j.dbLite.query("\x75\x70\x64\x61\x74\x65\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x20\x73\x65\x74\x20\x6d\x69\x73\x73\x65\x64\x62\x6c\x6f\x63\x6b\x73\x20\x3d\x20\x6d\x69\x73\x73\x65\x64\x62\x6c\x6f\x63\x6b\x73\x20\x2b\x20\x31\x20\x77\x68\x65\x72\x65\x20\x61\x64\x64\x72\x65\x73\x73\x20\x69\x6e\x20\x28"+b.join("\x2c")+"\x29",function(b){a(b)})},function(a){k.getVotes(g,function(b,c){return b?a(b):void d.eachSeries(c,function(a,b){j.dbLite.query("\x75\x70\x64\x61\x74\x65\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x20\x73\x65\x74\x20\x76\x6f\x74\x65\x20\x3d\x20\x76\x6f\x74\x65\x20\x2b\x20\x24\x61\x6d\x6f\x75\x6e\x74\x20\x77\x68\x65\x72\x65\x20\x61\x64\x64\x72\x65\x73\x73\x20\x3d\x20\x24\x61\x64\x64\x72\x65\x73\x73",{address:i.accounts.generateAddressByPublicKey(a.delegate),amount:a.amount},b)},function(b){k.flush(g,function(c){a(b||c)})})})},function(b){var c=new o(g);d.forEachOfSeries(l.unDelegatesByRound[g],function(b,d,e){var f=c.at(d);i.accounts.mergeAccountAndGet({publicKey:b,balance:-f.balance,u_balance:-f.balance,blockId:a.id,round:i.round.calc(a.height),fees:-f.fees,rewards:-f.rewards},function(c){return c?e(c):void(0===d?i.accounts.mergeAccountAndGet({publicKey:b,balance:-f.feesRemaining,u_balance:-f.feesRemaining,blockId:a.id,round:i.round.calc(a.height),fees:-f.feesRemaining},e):e())})},b)},function(a){k.getVotes(g,function(b,c){return b?a(b):void d.eachSeries(c,function(a,b){j.dbLite.query("\x75\x70\x64\x61\x74\x65\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x20\x73\x65\x74\x20\x76\x6f\x74\x65\x20\x3d\x20\x76\x6f\x74\x65\x20\x2b\x20\x24\x61\x6d\x6f\x75\x6e\x74\x20\x77\x68\x65\x72\x65\x20\x61\x64\x64\x72\x65\x73\x73\x20\x3d\x20\x24\x61\x64\x64\x72\x65\x73\x73",{address:i.accounts.generateAddressByPublicKey(a.delegate),amount:a.amount},b)},function(b){k.flush(g,function(c){a(b||c)})})})}],function(a){delete l.unFeesByRound[g],delete l.unRewardsByRound[g],delete l.unDelegatesByRound[g],e(a)})):e()))})},n.prototype.tick=function(a,b){function c(a){b&&setImmediate(b,a)}i.accounts.mergeAccountAndGet({publicKey:a.generatorPublicKey,producedblocks:1,blockId:a.id,round:i.round.calc(a.height)},function(b){var e,g,h;return b?c(b):(e=k.calc(a.height),l.feesByRound[e]=l.feesByRound[e]||0,l.feesByRound[e]+=a.totalFee,l.rewardsByRound[e]=l.rewardsByRound[e]||[],l.rewardsByRound[e].push(a.reward),l.delegatesByRound[e]=l.delegatesByRound[e]||[],l.delegatesByRound[e].push(a.generatorPublicKey),g=k.calc(a.height+1),void(!(e===g&&1!=a.height||l.delegatesByRound[e].length!=f.delegates&&1!=a.height&&101!=a.height)?(h=[],d.series([function(b){1!=a.height?i.delegates.generateDelegateList(a.height,function(a,c){if(a)return b(a);for(var d=0;d<c.length;d++)-1==l.delegatesByRound[e].indexOf(c[d])&&h.push(i.accounts.generateAddressByPublicKey(c[d]));b()}):b()},function(a){if(!h.length)return a();var b=h.map(function(a){return"\x27"+a+"\x27"});j.dbLite.query("\x75\x70\x64\x61\x74\x65\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x20\x73\x65\x74\x20\x6d\x69\x73\x73\x65\x64\x62\x6c\x6f\x63\x6b\x73\x20\x3d\x20\x6d\x69\x73\x73\x65\x64\x62\x6c\x6f\x63\x6b\x73\x20\x2b\x20\x31\x20\x77\x68\x65\x72\x65\x20\x61\x64\x64\x72\x65\x73\x73\x20\x69\x6e\x20\x28"+b.join("\x2c")+"\x29",function(b){
a(b)})},function(a){k.getVotes(e,function(b,c){return b?a(b):void d.eachSeries(c,function(a,b){j.dbLite.query("\x75\x70\x64\x61\x74\x65\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x20\x73\x65\x74\x20\x76\x6f\x74\x65\x20\x3d\x20\x76\x6f\x74\x65\x20\x2b\x20\x24\x61\x6d\x6f\x75\x6e\x74\x20\x77\x68\x65\x72\x65\x20\x61\x64\x64\x72\x65\x73\x73\x20\x3d\x20\x24\x61\x64\x64\x72\x65\x73\x73",{address:i.accounts.generateAddressByPublicKey(a.delegate),amount:a.amount},b)},function(b){k.flush(e,function(c){a(b||c)})})})},function(b){var c=new o(e);d.forEachOfSeries(l.delegatesByRound[e],function(b,d,f){var g=c.at(d);i.accounts.mergeAccountAndGet({publicKey:b,balance:g.balance,u_balance:g.balance,blockId:a.id,round:i.round.calc(a.height),fees:g.fees,rewards:g.rewards},function(c){return c?f(c):void(d===l.delegatesByRound[e].length-1?i.accounts.mergeAccountAndGet({publicKey:b,balance:g.feesRemaining,u_balance:g.feesRemaining,blockId:a.id,round:i.round.calc(a.height),fees:g.feesRemaining},f):f())})},b)},function(a){k.getVotes(e,function(b,c){return b?a(b):void d.eachSeries(c,function(a,b){j.dbLite.query("\x75\x70\x64\x61\x74\x65\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x20\x73\x65\x74\x20\x76\x6f\x74\x65\x20\x3d\x20\x76\x6f\x74\x65\x20\x2b\x20\x24\x61\x6d\x6f\x75\x6e\x74\x20\x77\x68\x65\x72\x65\x20\x61\x64\x64\x72\x65\x73\x73\x20\x3d\x20\x24\x61\x64\x64\x72\x65\x73\x73",{address:i.accounts.generateAddressByPublicKey(a.delegate),amount:a.amount},b)},function(b){j.bus.message("\x66\x69\x6e\x69\x73\x68\x52\x6f\x75\x6e\x64",e),k.flush(e,function(c){a(b||c)})})})}],function(a){delete l.feesByRound[e],delete l.rewardsByRound[e],delete l.delegatesByRound[e],c(a)})):c()))})},n.prototype.sandboxApi=function(a,b,c){g.callMethod(m,a,b,c)},n.prototype.onBind=function(a){i=a},n.prototype.onBlockchainReady=function(){var a=k.calc(i.blocks.getLastBlock().height);j.dbLite.query("\x73\x65\x6c\x65\x63\x74\x20\x73\x75\x6d\x28\x62\x2e\x74\x6f\x74\x61\x6c\x46\x65\x65\x29\x2c\x20\x47\x52\x4f\x55\x50\x5f\x43\x4f\x4e\x43\x41\x54\x28\x62\x2e\x72\x65\x77\x61\x72\x64\x29\x2c\x20\x47\x52\x4f\x55\x50\x5f\x43\x4f\x4e\x43\x41\x54\x28\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x62\x2e\x67\x65\x6e\x65\x72\x61\x74\x6f\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x29\x29\x20\x66\x72\x6f\x6d\x20\x62\x6c\x6f\x63\x6b\x73\x20\x62\x20\x77\x68\x65\x72\x65\x20\x28\x73\x65\x6c\x65\x63\x74\x20\x28\x63\x61\x73\x74\x28\x62\x2e\x68\x65\x69\x67\x68\x74\x20\x2f\x20\x31\x30\x31\x20\x61\x73\x20\x69\x6e\x74\x65\x67\x65\x72\x29\x20\x2b\x20\x28\x63\x61\x73\x65\x20\x77\x68\x65\x6e\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x20\x25\x20\x31\x30\x31\x20\x3e\x20\x30\x20\x74\x68\x65\x6e\x20\x31\x20\x65\x6c\x73\x65\x20\x30\x20\x65\x6e\x64\x29\x29\x29\x20\x3d\x20\x24\x72\x6f\x75\x6e\x64",{round:a},{fees:Number,rewards:Array,delegates:Array},function(b,c){l.feesByRound[a]=c[0].fees,l.rewardsByRound[a]=c[0].rewards,l.delegatesByRound[a]=c[0].delegates,l.loaded=!0})},n.prototype.onFinishRound=function(a){j.network.io.sockets.emit("\x72\x6f\x75\x6e\x64\x73\x2f\x63\x68\x61\x6e\x67\x65",{number:a})},n.prototype.cleanup=function(a){l.loaded=!1,a()},a.exports=n}),c.register("\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x73\x65\x72\x76\x65\x72\x2e\x6a\x73",function(a,b,c){function n(a,b){j=b,k=this,k.__private=l,l.attachApi(),setImmediate(a,null,k)}var i,j,k,g=(c("\x75\x74\x69\x6c"),c("\x61\x73\x79\x6e\x63"),c("\x70\x61\x74\x68"),c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x72\x6f\x75\x74\x65\x72\x2e\x6a\x73")),h=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x61\x6e\x64\x62\x6f\x78\x2e\x6a\x73"),l={},m={};l.loaded=!1,l.attachApi=function(){var a=new g;a.use(function(a,b,c){return i?c():void b.status(500).send({success:!1,error:"\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x69\x73\x20\x6c\x6f\x61\x64\x69\x6e\x67"})}),a.get("\x2f",function(a,b){l.loaded?b.render("\x77\x61\x6c\x6c\x65\x74\x2e\x68\x74\x6d\x6c",{layout:!1}):b.render("\x6c\x6f\x61\x64\x69\x6e\x67\x2e\x68\x74\x6d\x6c")}),a.use(function(a,b,c){return-1==a.url.indexOf("\x2f\x61\x70\x69\x2f")&&-1==a.url.indexOf("\x2f\x70\x65\x65\x72\x2f")?b.redirect("\x2f"):void c()}),j.network.app.use("\x2f",a)},n.prototype.sandboxApi=function(a,b,c){h.callMethod(m,a,b,c)},n.prototype.onBind=function(a){i=a},n.prototype.onBlockchainReady=function(){l.loaded=!0},n.prototype.cleanup=function(a){l.loaded=!1,a()},a.exports=n}),c.register("\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x73\x69\x61\x2e\x6a\x73",function(a,b,c){function o(a,b){k=b,l=this,l.__private=m,setImmediate(a,null,l)}var j,k,l,e=(c("\x75\x74\x69\x6c"),c("\x72\x65\x71\x75\x65\x73\x74")),h=(c("\x69\x70"),c("\x66\x73"),c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x61\x6e\x64\x62\x6f\x78\x2e\x6a\x73")),m=(c("\x61\x73\x79\x6e\x63"),{}),n={};o.prototype.uploadAscii=function(a,b){e.post({url:"\x68\x74\x74\x70\x3a\x2f\x2f"+k.config.sia.peer.ip+"\x3a"+k.config.sia.peer.port+"\x2f\x72\x65\x6e\x74\x65\x72\x2f\x66\x69\x6c\x65\x73\x2f\x6c\x6f\x61\x64\x61\x73\x63\x69\x69",form:{file:a},headers:{"User-Agent":"\x53\x69\x61\x2d\x41\x67\x65\x6e\x74"},json:!0},function(a,c,d){return a?b(a):"\x6f\x62\x6a\x65\x63\x74"!=typeof d?b(d):d.FilesAdded&&0!=d.FilesAdded.length?b(null,d.FilesAdded[0]):b("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x75\x70\x6c\x6f\x61\x64\x20\x61\x73\x63\x69\x69")})},o.prototype.download=function(a,b,c){e.post({url:"\x68\x74\x74\x70\x3a\x2f\x2f"+k.config.sia.peer.ip+"\x3a"+k.config.sia.peer.port+"\x2f\x72\x65\x6e\x74\x65\x72\x2f\x66\x69\x6c\x65\x73\x2f\x64\x6f\x77\x6e\x6c\x6f\x61\x64",form:{nickname:a,destination:b},headers:{"User-Agent":"\x53\x69\x61\x2d\x41\x67\x65\x6e\x74"},json:!0},function(a){return a?c(a):c()})},o.prototype.sandboxApi=function(a,b,c){h.callMethod(n,a,b,c)},o.prototype.onBind=function(a){j=a},a.exports=o}),c.register("\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x2e\x6a\x73",function(a,b,c){function s(){this.create=function(a,b){return b.recipientId=null,b.amount=0,b.asset.signature={publicKey:a.secondKeypair.publicKey.toString("\x68\x65\x78")},b},this.calculateFee=function(){return 5*g.fixedPoint},this.verify=function(a,b,c){if(!a.asset.signature)return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x61\x73\x73\x65\x74");if(0!=a.amount)return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x61\x6d\x6f\x75\x6e\x74");try{if(!a.asset.signature.publicKey||32!=new Buffer(a.asset.signature.publicKey,"\x68\x65\x78").length)return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x6c\x65\x6e\x67\x74\x68")}catch(d){return setImmediate(c,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x68\x65\x78")}setImmediate(c,null,a)},this.process=function(a,b,c){setImmediate(c,null,a)},this.getBytes=function(a){var b,c,d;try{for(b=new e(32,!0),c=new Buffer(a.asset.signature.publicKey,"\x68\x65\x78"),d=0;d<c.length;d++)b.writeByte(c[d]);b.flip()}catch(f){throw Error(""+f)}return b.toBuffer()},this.apply=function(a,b,c,d){n.accounts.setAccountAndGet({address:c.address,secondSignature:1,u_secondSignature:0,secondPublicKey:a.asset.signature.publicKey},d)},this.undo=function(a,b,c,d){n.accounts.setAccountAndGet({address:c.address,secondSignature:0,u_secondSignature:1,secondPublicKey:null},d)},this.applyUnconfirmed=function(a,b,c){return b.u_secondSignature||b.secondSignature?setImmediate(c,"\x46\x61\x69\x6c\x65\x64\x20\x73\x65\x63\x6f\x6e\x64\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x3a\x20"+a.id):void n.accounts.setAccountAndGet({address:b.address,u_secondSignature:1},c)},this.undoUnconfirmed=function(a,b,c){n.accounts.setAccountAndGet({address:b.address,u_secondSignature:0},c)},this.objectNormalize=function(a){var b=o.scheme.validate(a.asset.signature,{object:!0,properties:{publicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"}},required:["\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"]});if(!b)throw Error("\x43\x61\x6e\x27\x74\x20\x70\x61\x72\x73\x65\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x3a\x20"+o.scheme.getLastError());return a},this.dbRead=function(a){if(a.s_publicKey){var b={transactionId:a.t_id,publicKey:a.s_publicKey};return{signature:b}}return null},this.dbSave=function(a,b){try{var c=new Buffer(a.asset.signature.publicKey,"\x68\x65\x78")}catch(d){return b(""+d)}o.dbLite.query("\x49\x4e\x53\x45\x52\x54\x20\x49\x4e\x54\x4f\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x28\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x2c\x20\x70\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x20\x56\x41\x4c\x55\x45\x53\x28\x24\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64\x2c\x20\x24\x70\x75\x62\x6c\x69\x63\x4b\x65\x79\x29",{transactionId:a.id,publicKey:c},b)},this.ready=function(a,b){return b.multisignatures.length?a.signatures?a.signatures.length>=b.multimin-1:!1:!0}}function t(a,b){o=b,p=this,p.__private=q,q.attachApi(),o.logic.transaction.attachAssetType(k.SIGNATURE,new s),setImmediate(a,null,p)}var n,o,p,d=c("\x65\x64\x32\x35\x35\x31\x39"),e=c("\x62\x79\x74\x65\x62\x75\x66\x66\x65\x72"),f=c("\x63\x72\x79\x70\x74\x6f"),g=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x63\x6f\x6e\x73\x74\x61\x6e\x74\x73\x2e\x6a\x73"),i=(c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x6c\x6f\x74\x73\x2e\x6a\x73"),c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x72\x6f\x75\x74\x65\x72\x2e\x6a\x73")),k=(c("\x61\x73\x79\x6e\x63"),c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x2d\x74\x79\x70\x65\x73\x2e\x6a\x73")),m=(c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x6d\x69\x6c\x65\x73\x74\x6f\x6e\x65\x42\x6c\x6f\x63\x6b\x73\x2e\x6a\x73"),c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x61\x6e\x64\x62\x6f\x78\x2e\x6a\x73")),q={},r={};q.attachApi=function(){var a=new i;a.use(function(a,b,c){return n?c():void b.status(500).send({success:!1,error:"\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x69\x73\x20\x6c\x6f\x61\x64\x69\x6e\x67"})}),a.map(r,{"get /fee":"\x67\x65\x74\x46\x65\x65","put /":"\x61\x64\x64\x53\x69\x67\x6e\x61\x74\x75\x72\x65"}),a.use(function(a,b){b.status(500).send({success:!1,error:"\x41\x50\x49\x20\x65\x6e\x64\x70\x6f\x69\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64"})}),o.network.app.use("\x2f\x61\x70\x69\x2f\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73",a),o.network.app.use(function(a,b,c,d){return a?(o.logger.error(b.url,""+a),void c.status(500).send({success:!1,error:""+a})):d()})},t.prototype.sandboxApi=function(a,b,c){m.callMethod(r,a,b,c)},t.prototype.onBind=function(a){n=a},r.getFee=function(a,b){var c=null;c=5*g.fixedPoint,b(null,{fee:c})},r.addSignature=function(a,b){var c=a.body;o.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{secret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1},secondSecret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1},publicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"},multisigAccountPublicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"}},required:["\x73\x65\x63\x72\x65\x74","\x73\x65\x63\x6f\x6e\x64\x53\x65\x63\x72\x65\x74"]},function(a){var e,g;return a?b(a[0].message):(e=f.createHash("\x73\x68\x61\x32\x35\x36").update(c.secret,"\x75\x74\x66\x38").digest(),g=d.MakeKeypair(e),c.publicKey&&g.publicKey.toString("\x68\x65\x78")!=c.publicKey?b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65"):void o.balancesSequence.add(function(a){c.multisigAccountPublicKey&&c.multisigAccountPublicKey!=g.publicKey.toString("\x68\x65\x78")?n.accounts.getAccount({publicKey:c.multisigAccountPublicKey},function(b,e){return b?a(""+b):e&&e.publicKey?e.multisignatures&&e.multisignatures?e.multisignatures.indexOf(g.publicKey.toString("\x68\x65\x78"))<0?a("\x41\x63\x63\x6f\x75\x6e\x74\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x62\x65\x6c\x6f\x6e\x67\x20\x74\x6f\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x67\x72\x6f\x75\x70"):e.secondSignature||e.u_secondSignature?a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x63\x6f\x6e\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65"):void n.accounts.getAccount({publicKey:g.publicKey},function(b,h){var i,j,l;if(b)return a(""+b);if(!h||!h.publicKey)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x72\x65\x71\x75\x65\x73\x74\x65\x72");if(h.secondSignature&&!c.secondSecret)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x63\x6f\x6e\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65");if(h.publicKey==e.publicKey)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x72\x65\x71\x75\x65\x73\x74\x65\x72");i=f.createHash("\x73\x68\x61\x32\x35\x36").update(c.secondSecret,"\x75\x74\x66\x38").digest(),j=d.MakeKeypair(i);try{l=o.logic.transaction.create({type:k.SIGNATURE,sender:e,keypair:g,requester:g,secondKeypair:j})}catch(m){return a(""+m)}n.transactions.receiveTransactions([l],a)}):a("\x41\x63\x63\x6f\x75\x6e\x74\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x68\x61\x76\x65\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x65\x6e\x61\x62\x6c\x65\x64"):a("\x4d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x61\x63\x63\x6f\x75\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")}):n.accounts.getAccount({publicKey:g.publicKey.toString("\x68\x65\x78")},function(b,e){var h,i,j;if(b)return a(""+b);if(!e||!e.publicKey)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x61\x63\x63\x6f\x75\x6e\x74");if(e.secondSignature||e.u_secondSignature)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x63\x6f\x6e\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65");h=f.createHash("\x73\x68\x61\x32\x35\x36").update(c.secondSecret,"\x75\x74\x66\x38").digest(),i=d.MakeKeypair(h);try{j=o.logic.transaction.create({type:k.SIGNATURE,sender:e,keypair:g,secondKeypair:i})}catch(l){return a(""+l)}n.transactions.receiveTransactions([j],a)})},function(a,c){return a?b(""+a):void b(null,{transaction:c[0]})}))})},a.exports=t}),c.register("\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x73\x71\x6c\x2e\x6a\x73",function(a,b,c){function m(a,b){i=b,j=this,j.__private=k,setImmediate(a,null,j)}var f,g,h,i,j,k,l,d=c("\x61\x73\x79\x6e\x63"),e=c("\x6a\x73\x6f\x6e\x2d\x73\x71\x6c")();e.setDialect("\x73\x71\x6c\x69\x74\x65"),f=c("\x65\x78\x74\x65\x6e\x64"),g=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x61\x6e\x64\x62\x6f\x78\x2e\x6a\x73"),k={},l={},k.loaded=!1,k.DOUBLE_DOUBLE_QUOTES=/""/g,k.SINGLE_QUOTES=/'/g,k.SINGLE_QUOTES_DOUBLED="\x27\x27",k.escape=function(a){switch(typeof a){case"\x73\x74\x72\x69\x6e\x67":return"\x27"+a.replace(k.SINGLE_QUOTES,k.SINGLE_QUOTES_DOUBLED)+"\x27";case"\x6f\x62\x6a\x65\x63\x74":return null==a?"\x6e\x75\x6c\x6c":Buffer.isBuffer(a)?"\x58\x27"+a.toString("\x68\x65\x78")+"\x27":"\x27"+JSON.stringify(a).replace(k.SINGLE_QUOTES,k.SINGLE_QUOTES_DOUBLED)+"\x27";case"\x62\x6f\x6f\x6c\x65\x61\x6e":return a?"\x31":"\x30";case"\x6e\x75\x6d\x62\x65\x72":if(isFinite(a))return""+a}throw Error("\x75\x6e\x73\x75\x70\x70\x6f\x72\x74\x65\x64\x20\x64\x61\x74\x61",typeof a)},k.pass=function(a,b){var c,d,e,f,g,h,i;for(c in a){if("\x6f\x62\x6a\x65\x63\x74"==typeof a[c]&&k.pass(a[c],b),"\x74\x61\x62\x6c\x65"==c&&(a[c]="\x64\x61\x70\x70\x5f"+b+"\x5f"+a[c]),"\x6a\x6f\x69\x6e"==c&&void 0===a[c].length)for(d in a[c])e=a[c][d],delete a[c][d],a[c]["\x64\x61\x70\x70\x5f"+b+"\x5f"+d]=e;if("\x6f\x6e"==c&&!a.alias)for(f in a[c])g=a[c][f],delete a[c][f],h=f.split("\x2e"),f="\x64\x61\x70\x70\x5f"+b+"\x5f"+h[0],i=g.split("\x2e"),g="\x64\x61\x70\x70\x5f"+b+"\x5f"+i[0],a[c][f]=g}},k.query=function(a,b,c){function h(a,b){a&&(a=""+a),c(a,b)}var j,m,g=null;if("\x62\x61\x74\x63\x68"!=a){k.pass(b,b.dappid),j={type:a};try{g=e.build(f({},b,j))}catch(l){return h(""+l)}"\x73\x65\x6c\x65\x63\x74"==a?i.dbLite.query(g.query,g.values,null,h):i.dbLite.query(g.query,g.values,h)}else m=[],d.until(function(){return m=b.values.splice(0,10),0==m.length},function(a){var d,c=Object.keys(b.fields).map(function(a){return k.escape(b.fields[a])});g="\x49\x4e\x53\x45\x52\x54\x20\x49\x4e\x54\x4f\x20\x64\x61\x70\x70\x5f"+b.dappid+"\x5f"+b.table+"\x20\x28"+c.join("\x2c")+"\x29\x20",d=[],m.forEach(function(a,b){var f,c=m[b],e=[];for(f=0;f<c.length;f++)e.push(k.escape(c[f]));d.push("\x73\x65\x6c\x65\x63\x74\x20"+e.join("\x2c"))}),g=g+"\x20"+d.join("\x20\x55\x4e\x49\x4f\x4e\x20"),i.dbLite.query(g,{},a)},h)},m.prototype.createTables=function(a,b,c){var f,g,h,k;if(!b)return c("\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x61\x62\x6c\x65\x20\x66\x6f\x72\x6d\x61\x74");for(f=[],g=0;g<b.length;g++){if(b[g].table="\x64\x61\x70\x70\x5f"+a+"\x5f"+b[g].table,"\x74\x61\x62\x6c\x65"==b[g].type){if(b[g].type="\x63\x72\x65\x61\x74\x65",b[g].foreignKeys)for(h=0;h<b[g].foreignKeys.length;h++)b[g].foreignKeys[h].table="\x64\x61\x70\x70\x5f"+a+"\x5f"+b[g].foreignKeys[h].table}else{if("\x69\x6e\x64\x65\x78"!=b[g].type)return setImmediate(c,"\x55\x6e\x6b\x6e\x6f\x77\x6e\x20\x74\x61\x62\x6c\x65\x20\x74\x79\x70\x65\x3a\x20"+b[g].type);b[g].type="\x69\x6e\x64\x65\x78"}k=e.build(b[g]),f.push(k.query)}d.eachSeries(f,function(a,b){i.dbLite.query(a,function(a,c){b(a,c)})},function(a){setImmediate(c,a,j)})},m.prototype.dropTables=function(a,b,c){var f,e=[];for(f=0;f<b.length;f++)b[f].table="\x64\x61\x70\x70\x5f"+a+"\x5f"+b[f].table,e.push({name:b[f].table.replace(/[^\w_]/gi,""),type:b[f].type});d.eachSeries(e,function(a,b){"\x63\x72\x65\x61\x74\x65"==a.type?i.dbLite.query("\x44\x52\x4f\x50\x20\x54\x41\x42\x4c\x45\x20\x49\x46\x20\x45\x58\x49\x53\x54\x53\x20"+a.name,function(a){setImmediate(b,a)}):"\x69\x6e\x64\x65\x78"==a.type?i.dbLite.query("\x44\x52\x4f\x50\x20\x49\x4e\x44\x45\x58\x20\x49\x46\x20\x45\x58\x49\x53\x54\x53\x20"+a.name,function(a){setImmediate(b,a)}):setImmediate(b)},c)},m.prototype.sandboxApi=function(a,b,c){g.callMethod(l,a,b,c)},m.prototype.onBind=function(a){h=a},m.prototype.onBlockchainReady=function(){k.loaded=!0},l.select=function(a,b){var c=f({},a.body,{dappid:a.dappid});k.query.call(this,"\x73\x65\x6c\x65\x63\x74",c,b)},l.batch=function(a,b){var c=f({},a.body,{dappid:a.dappid});k.query.call(this,"\x62\x61\x74\x63\x68",c,b)},l.insert=function(a,b){var c=f({},a.body,{dappid:a.dappid});k.query.call(this,"\x69\x6e\x73\x65\x72\x74",c,b)},l.update=function(a,b){var c=f({},a.body,{dappid:a.dappid});k.query.call(this,"\x75\x70\x64\x61\x74\x65",c,b)},l.remove=function(a,b){var c=f({},a.body,{dappid:a.dappid});k.query.call(this,"\x72\x65\x6d\x6f\x76\x65",c,b)},a.exports=m}),c.register("\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x73\x79\x73\x74\x65\x6d\x2e\x6a\x73",function(a,b,c){function k(a,b){g=b,h=this,h.__private=i,i.version=g.config.version,i.port=g.config.port,i.sharePort=+!!g.config.sharePort,i.osName=d.platform()+d.release(),setImmediate(a,null,h)}var f,g,h,d=c("\x6f\x73"),e=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x61\x6e\x64\x62\x6f\x78\x2e\x6a\x73"),i={},j={};i.version,i.osName,i.port,i.sharePort,k.prototype.getOS=function(){return i.osName},k.prototype.getVersion=function(){return i.version},k.prototype.getPort=function(){return i.port},k.prototype.getSharePort=function(){return i.sharePort},k.prototype.sandboxApi=function(a,b,c){e.callMethod(j,a,b,c)},k.prototype.onBind=function(a){f=a},a.exports=k}),c.register("\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73\x2e\x6a\x73",function(a,b,c){function u(){this.create=function(a,b){return b.recipientId=a.recipientId,b.recipientUsername=a.recipientUsername,b.amount=a.amount,b},this.calculateFee=function(){return q.logic.block.calculateFee()},this.verify=function(a,b,c){var d=/^[0-9]+[L|l]$/g;return d.test(a.recipientId.toLowerCase())?a.amount<=0?c("\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x61\x6d\x6f\x75\x6e\x74"):void c(null,a):c("\x49\x6e\x76\x61\x6c\x69\x64\x20\x72\x65\x63\x69\x70\x69\x65\x6e\x74")},this.process=function(a,b,c){setImmediate(c,null,a)},this.getBytes=function(){return null},this.apply=function(a,b,c,d){p.accounts.setAccountAndGet({address:a.recipientId},function(c){return c?d(c):void p.accounts.mergeAccountAndGet({address:a.recipientId,balance:a.amount,u_balance:a.amount,blockId:b.id,round:p.round.calc(b.height)},function(a){d(a)})})},this.undo=function(a,b,c,d){p.accounts.setAccountAndGet({address:a.recipientId},function(c){return c?d(c):void p.accounts.mergeAccountAndGet({address:a.recipientId,balance:-a.amount,u_balance:-a.amount,blockId:b.id,round:p.round.calc(b.height)},function(a){d(a)})})},this.applyUnconfirmed=function(a,b,c){setImmediate(c)},this.undoUnconfirmed=function(a,b,c){setImmediate(c)},this.objectNormalize=function(a){return delete a.blockId,a},this.dbRead=function(){return null},this.dbSave=function(a,b){setImmediate(b)},this.ready=function(a,b){return b.multisignatures.length?a.signatures?a.signatures.length>=b.multimin-1:!1:!0}}function v(a,b){q=b,h=q.genesisblock,r=this,r.__private=s,s.attachApi(),q.logic.transaction.attachAssetType(n.SEND,new u),setImmediate(a,null,r)}var p,q,r,d=c("\x65\x64\x32\x35\x35\x31\x39"),g=(c("\x75\x74\x69\x6c"),c("\x62\x79\x74\x65\x62\x75\x66\x66\x65\x72"),c("\x63\x72\x79\x70\x74\x6f")),h=null,i=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x63\x6f\x6e\x73\x74\x61\x6e\x74\x73\x2e\x6a\x73"),l=(c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x6c\x6f\x74\x73\x2e\x6a\x73"),c("\x65\x78\x74\x65\x6e\x64"),c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x72\x6f\x75\x74\x65\x72\x2e\x6a\x73")),m=c("\x61\x73\x79\x6e\x63"),n=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x2d\x74\x79\x70\x65\x73\x2e\x6a\x73"),o=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x61\x6e\x64\x62\x6f\x78\x2e\x6a\x73"),s={},t={};s.hiddenTransactions=[],s.unconfirmedTransactions=[],s.unconfirmedTransactionsIdIndex={},s.doubleSpendingTransactions={},s.attachApi=function(){var a=new l;a.use(function(a,b,c){return p?c():void b.status(500).send({success:!1,error:"\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x69\x73\x20\x6c\x6f\x61\x64\x69\x6e\x67"})}),a.map(t,{"get /":"\x67\x65\x74\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73","get /get":"\x67\x65\x74\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e","get /unconfirmed/get":"\x67\x65\x74\x55\x6e\x63\x6f\x6e\x66\x69\x72\x6d\x65\x64\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e","get /unconfirmed":"\x67\x65\x74\x55\x6e\x63\x6f\x6e\x66\x69\x72\x6d\x65\x64\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73","put /":"\x61\x64\x64\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73"}),a.use(function(a,b){b.status(500).send({success:!1,error:"\x41\x50\x49\x20\x65\x6e\x64\x70\x6f\x69\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64"})}),q.network.app.use("\x2f\x61\x70\x69\x2f\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73",a),q.network.app.use(function(a,b,c,d){return a?(q.logger.error(b.url,""+a),void c.status(500).send({success:!1,error:""+a})):d()})},s.list=function(a,b){var g,h,i,c=["\x74\x2e\x69\x64","\x74\x2e\x62\x6c\x6f\x63\x6b\x49\x64","\x74\x2e\x61\x6d\x6f\x75\x6e\x74","\x74\x2e\x66\x65\x65","\x74\x2e\x74\x79\x70\x65","\x74\x2e\x74\x69\x6d\x65\x73\x74\x61\x6d\x70","\x74\x2e\x73\x65\x6e\x64\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79","\x74\x2e\x73\x65\x6e\x64\x65\x72\x49\x64","\x74\x2e\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x49\x64","\x74\x2e\x73\x65\x6e\x64\x65\x72\x55\x73\x65\x72\x6e\x61\x6d\x65","\x74\x2e\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x55\x73\x65\x72\x6e\x61\x6d\x65","\x74\x2e\x63\x6f\x6e\x66\x69\x72\x6d\x61\x74\x69\x6f\x6e\x73","\x62\x2e\x68\x65\x69\x67\x68\x74"],d={},e=[],f="";return a.blockId&&(e.push("\x62\x6c\x6f\x63\x6b\x49\x64\x20\x3d\x20\x24\x62\x6c\x6f\x63\x6b\x49\x64"),d.blockId=a.blockId),a.senderPublicKey&&(e.push("\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x73\x65\x6e\x64\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x29\x20\x3d\x20\x24\x73\x65\x6e\x64\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79"),d.senderPublicKey=a.senderPublicKey),a.senderId&&(e.push("\x73\x65\x6e\x64\x65\x72\x49\x64\x20\x3d\x20\x24\x73\x65\x6e\x64\x65\x72\x49\x64"),d.senderId=a.senderId),a.recipientId&&(e.push("\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x49\x64\x20\x3d\x20\x24\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x49\x64"),d.recipientId=a.recipientId),a.senderUsername&&(e.push("\x73\x65\x6e\x64\x65\x72\x55\x73\x65\x72\x6e\x61\x6d\x65\x20\x3d\x20\x24\x73\x65\x6e\x64\x65\x72\x55\x73\x65\x72\x6e\x61\x6d\x65"),d.senderUsername=a.senderUsername),a.recipientUsername&&(e.push("\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x55\x73\x65\x72\x6e\x61\x6d\x65\x20\x3d\x20\x24\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x55\x73\x65\x72\x6e\x61\x6d\x65"),d.recipientUsername=a.recipientUsername),a.ownerAddress&&a.ownerPublicKey&&(f="\x28\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x73\x65\x6e\x64\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x29\x20\x3d\x20\x24\x6f\x77\x6e\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x20\x6f\x72\x20\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x49\x64\x20\x3d\x20\x24\x6f\x77\x6e\x65\x72\x41\x64\x64\x72\x65\x73\x73\x29",d.ownerPublicKey=a.ownerPublicKey,d.ownerAddress=a.ownerAddress),a.type>=0&&(e.push("\x74\x79\x70\x65\x20\x3d\x20\x24\x74\x79\x70\x65"),d.type=a.type),a.limit>=0&&(d.limit=a.limit),a.offset>=0&&(d.offset=a.offset),a.orderBy&&(g=a.orderBy.split("\x3a"),h=g[0].replace(/[^\w_]/gi,"").replace("\x5f","\x2e"),i=2==g.length?"\x64\x65\x73\x63"==g[1]?"\x64\x65\x73\x63":"\x61\x73\x63":"\x64\x65\x73\x63"),h&&c.indexOf(h)<0?b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x6f\x72\x74\x20\x66\x69\x65\x6c\x64"):a.limit>100?b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x6c\x69\x6d\x69\x74\x2e\x20\x4d\x61\x78\x69\x6d\x75\x6d\x20\x69\x73\x20\x31\x30\x30"):void q.dbLite.query("\x73\x65\x6c\x65\x63\x74\x20\x63\x6f\x75\x6e\x74\x28\x74\x2e\x69\x64\x29\x20\x66\x72\x6f\x6d\x20\x74\x72\x73\x20\x74\x20\x69\x6e\x6e\x65\x72\x20\x6a\x6f\x69\x6e\x20\x62\x6c\x6f\x63\x6b\x73\x20\x62\x20\x6f\x6e\x20\x74\x2e\x62\x6c\x6f\x63\x6b\x49\x64\x20\x3d\x20\x62\x2e\x69\x64\x20"+(e.length||f?"\x77\x68\x65\x72\x65\x20":"")+"\x20"+(e.length?"\x28"+e.join("\x20\x6f\x72\x20")+"\x29\x20":"")+(e.length&&f?"\x20\x61\x6e\x64\x20"+f:f),d,{count:Number},function(c,g){if(c)return b(c);var j=g.length?g[0].count:0;q.dbLite.query("\x73\x65\x6c\x65\x63\x74\x20\x74\x2e\x69\x64\x2c\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x2c\x20\x74\x2e\x62\x6c\x6f\x63\x6b\x49\x64\x2c\x20\x74\x2e\x74\x79\x70\x65\x2c\x20\x74\x2e\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x74\x2e\x73\x65\x6e\x64\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x29\x2c\x20\x74\x2e\x73\x65\x6e\x64\x65\x72\x49\x64\x2c\x20\x74\x2e\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x49\x64\x2c\x20\x74\x2e\x73\x65\x6e\x64\x65\x72\x55\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x74\x2e\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x55\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x74\x2e\x61\x6d\x6f\x75\x6e\x74\x2c\x20\x74\x2e\x66\x65\x65\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x74\x2e\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x29\x29\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x74\x2e\x73\x69\x67\x6e\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x29\x29\x2c\x20\x74\x2e\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x2c\x20\x28\x73\x65\x6c\x65\x63\x74\x20\x6d\x61\x78\x28\x68\x65\x69\x67\x68\x74\x29\x20\x2b\x20\x31\x20\x66\x72\x6f\x6d\x20\x62\x6c\x6f\x63\x6b\x73\x29\x20\x2d\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x20\x66\x72\x6f\x6d\x20\x74\x72\x73\x20\x74\x20\x69\x6e\x6e\x65\x72\x20\x6a\x6f\x69\x6e\x20\x62\x6c\x6f\x63\x6b\x73\x20\x62\x20\x6f\x6e\x20\x74\x2e\x62\x6c\x6f\x63\x6b\x49\x64\x20\x3d\x20\x62\x2e\x69\x64\x20"+(e.length||f?"\x77\x68\x65\x72\x65\x20":"")+"\x20"+(e.length?"\x28"+e.join("\x20\x6f\x72\x20")+"\x29\x20":"")+(e.length&&f?"\x20\x61\x6e\x64\x20"+f:f)+"\x20"+(a.orderBy?"\x6f\x72\x64\x65\x72\x20\x62\x79\x20"+h+"\x20"+i:"")+"\x20"+(a.limit?"\x6c\x69\x6d\x69\x74\x20\x24\x6c\x69\x6d\x69\x74":"")+"\x20"+(a.offset?"\x6f\x66\x66\x73\x65\x74\x20\x24\x6f\x66\x66\x73\x65\x74":""),d,["\x74\x5f\x69\x64","\x62\x5f\x68\x65\x69\x67\x68\x74","\x74\x5f\x62\x6c\x6f\x63\x6b\x49\x64","\x74\x5f\x74\x79\x70\x65","\x74\x5f\x74\x69\x6d\x65\x73\x74\x61\x6d\x70","\x74\x5f\x73\x65\x6e\x64\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79","\x74\x5f\x73\x65\x6e\x64\x65\x72\x49\x64","\x74\x5f\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x49\x64","\x74\x5f\x73\x65\x6e\x64\x65\x72\x55\x73\x65\x72\x6e\x61\x6d\x65","\x74\x5f\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x55\x73\x65\x72\x6e\x61\x6d\x65","\x74\x5f\x61\x6d\x6f\x75\x6e\x74","\x74\x5f\x66\x65\x65","\x74\x5f\x73\x69\x67\x6e\x61\x74\x75\x72\x65","\x74\x5f\x73\x69\x67\x6e\x53\x69\x67\x6e\x61\x74\x75\x72\x65","\x74\x5f\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73","\x63\x6f\x6e\x66\x69\x72\x6d\x61\x74\x69\x6f\x6e\x73"],function(a,c){var d,e,f;if(a)return b(a);for(d=[],e=0;e<c.length;e++)d.push(q.logic.transaction.dbRead(c[e]));f={transactions:d,count:j},b(null,f)})})},s.getById=function(a,b){q.dbLite.query("\x73\x65\x6c\x65\x63\x74\x20\x74\x2e\x69\x64\x2c\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x2c\x20\x74\x2e\x62\x6c\x6f\x63\x6b\x49\x64\x2c\x20\x74\x2e\x74\x79\x70\x65\x2c\x20\x74\x2e\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x74\x2e\x73\x65\x6e\x64\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x29\x29\x2c\x20\x74\x2e\x73\x65\x6e\x64\x65\x72\x49\x64\x2c\x20\x74\x2e\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x49\x64\x2c\x20\x74\x2e\x73\x65\x6e\x64\x65\x72\x55\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x74\x2e\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x55\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x74\x2e\x61\x6d\x6f\x75\x6e\x74\x2c\x20\x74\x2e\x66\x65\x65\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x74\x2e\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x29\x29\x2c\x20\x6c\x6f\x77\x65\x72\x28\x68\x65\x78\x28\x74\x2e\x73\x69\x67\x6e\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x29\x29\x2c\x20\x28\x73\x65\x6c\x65\x63\x74\x20\x6d\x61\x78\x28\x68\x65\x69\x67\x68\x74\x29\x20\x2b\x20\x31\x20\x66\x72\x6f\x6d\x20\x62\x6c\x6f\x63\x6b\x73\x29\x20\x2d\x20\x62\x2e\x68\x65\x69\x67\x68\x74\x20\x66\x72\x6f\x6d\x20\x74\x72\x73\x20\x74\x20\x69\x6e\x6e\x65\x72\x20\x6a\x6f\x69\x6e\x20\x62\x6c\x6f\x63\x6b\x73\x20\x62\x20\x6f\x6e\x20\x74\x2e\x62\x6c\x6f\x63\x6b\x49\x64\x20\x3d\x20\x62\x2e\x69\x64\x20\x77\x68\x65\x72\x65\x20\x74\x2e\x69\x64\x20\x3d\x20\x24\x69\x64",{id:a},["\x74\x5f\x69\x64","\x62\x5f\x68\x65\x69\x67\x68\x74","\x74\x5f\x62\x6c\x6f\x63\x6b\x49\x64","\x74\x5f\x74\x79\x70\x65","\x74\x5f\x74\x69\x6d\x65\x73\x74\x61\x6d\x70","\x74\x5f\x73\x65\x6e\x64\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79","\x74\x5f\x73\x65\x6e\x64\x65\x72\x49\x64","\x74\x5f\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x49\x64","\x74\x5f\x73\x65\x6e\x64\x65\x72\x55\x73\x65\x72\x6e\x61\x6d\x65","\x74\x5f\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x55\x73\x65\x72\x6e\x61\x6d\x65","\x74\x5f\x61\x6d\x6f\x75\x6e\x74","\x74\x5f\x66\x65\x65","\x74\x5f\x73\x69\x67\x6e\x61\x74\x75\x72\x65","\x74\x5f\x73\x69\x67\x6e\x53\x69\x67\x6e\x61\x74\x75\x72\x65","\x63\x6f\x6e\x66\x69\x72\x6d\x61\x74\x69\x6f\x6e\x73"],function(c,d){if(c||!d.length)return b(c||"\x43\x61\x6e\x27\x74\x20\x66\x69\x6e\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x3a\x20"+a);var e=q.logic.transaction.dbRead(d[0]);b(null,e)})},s.addUnconfirmedTransaction=function(a,b,c){r.applyUnconfirmed(a,b,function(b){if(b)return r.addDoubleSpending(a),setImmediate(c,b);s.unconfirmedTransactions.push(a);var d=s.unconfirmedTransactions.length-1;s.unconfirmedTransactionsIdIndex[a.id]=d,setImmediate(c)})},v.prototype.getUnconfirmedTransaction=function(a){var b=s.unconfirmedTransactionsIdIndex[a];return s.unconfirmedTransactions[b]},v.prototype.addDoubleSpending=function(a){s.doubleSpendingTransactions[a.id]=a},v.prototype.pushHiddenTransaction=function(a){s.hiddenTransactions.push(a)},v.prototype.shiftHiddenTransaction=function(){return s.hiddenTransactions.shift()},v.prototype.deleteHiddenTransaction=function(){s.hiddenTransactions=[]},v.prototype.getUnconfirmedTransactionList=function(a){var c,b=[];for(c=0;c<s.unconfirmedTransactions.length;c++)s.unconfirmedTransactions[c]!==!1&&b.push(s.unconfirmedTransactions[c]);return a?b.reverse():b},v.prototype.removeUnconfirmedTransaction=function(a){var b=s.unconfirmedTransactionsIdIndex[a];delete s.unconfirmedTransactionsIdIndex[a],
s.unconfirmedTransactions[b]=!1},v.prototype.processUnconfirmedTransaction=function(a,b,c){p.accounts.setAccountAndGet({publicKey:a.senderPublicKey},function(d,e){function f(d){return d?c(d):void s.addUnconfirmedTransaction(a,e,function(d){return d?c(d):(q.bus.message("\x75\x6e\x63\x6f\x6e\x66\x69\x72\x6d\x65\x64\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e",a,b),void c())})}return d?f(d):void(a.requesterPublicKey&&e&&e.multisignatures&&e.multisignatures.length?p.accounts.getAccount({publicKey:a.requesterPublicKey},function(b,d){return b?f(b):d?void q.logic.transaction.process(a,e,d,function(a,b){return a?f(a):void 0!==s.unconfirmedTransactionsIdIndex[b.id]||s.doubleSpendingTransactions[b.id]?c("\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x65\x78\x69\x73\x74\x73"):void q.logic.transaction.verify(b,e,f)}):c("\x49\x6e\x76\x61\x6c\x69\x64\x20\x72\x65\x71\x75\x65\x73\x74\x65\x72")}):q.logic.transaction.process(a,e,function(a,b){return a?f(a):void 0!==s.unconfirmedTransactionsIdIndex[b.id]||s.doubleSpendingTransactions[b.id]?c("\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x65\x78\x69\x73\x74\x73"):void q.logic.transaction.verify(b,e,f)}))})},v.prototype.applyUnconfirmedList=function(a,b){m.eachSeries(a,function(a,b){var c=r.getUnconfirmedTransaction(a);p.accounts.setAccountAndGet({publicKey:c.senderPublicKey},function(d,e){return d?(r.removeUnconfirmedTransaction(a),r.addDoubleSpending(c),setImmediate(b)):void r.applyUnconfirmed(c,e,function(d){d&&(r.removeUnconfirmedTransaction(a),r.addDoubleSpending(c)),setImmediate(b)})})},b)},v.prototype.undoUnconfirmedList=function(a){var b=[];m.eachSeries(s.unconfirmedTransactions,function(a,c){a!==!1?(b.push(a.id),r.undoUnconfirmed(a,c)):setImmediate(c)},function(c){a(c,b)})},v.prototype.apply=function(a,b,c,d){q.logic.transaction.apply(a,b,c,d)},v.prototype.undo=function(a,b,c,d){q.logic.transaction.undo(a,b,c,d)},v.prototype.applyUnconfirmed=function(a,b,c){return b||a.blockId==h.block.id?void(a.requesterPublicKey?p.accounts.getAccount({publicKey:a.requesterPublicKey},function(d,e){return d?c(d):e?void q.logic.transaction.applyUnconfirmed(a,b,e,c):c("\x49\x6e\x76\x61\x6c\x69\x64\x20\x72\x65\x71\x75\x65\x73\x74\x65\x72")}):q.logic.transaction.applyUnconfirmed(a,b,c)):c("\x49\x6e\x76\x61\x6c\x69\x64\x20\x61\x63\x63\x6f\x75\x6e\x74")},v.prototype.undoUnconfirmed=function(a,b){p.accounts.getAccount({publicKey:a.senderPublicKey},function(c,d){return c?b(c):void q.logic.transaction.undoUnconfirmed(a,d,b)})},v.prototype.receiveTransactions=function(a,b){m.eachSeries(a,function(a,b){r.processUnconfirmedTransaction(a,!0,b)},function(c){b(c,a)})},v.prototype.sandboxApi=function(a,b,c){o.callMethod(t,a,b,c)},v.prototype.onBind=function(a){p=a},t.getTransactions=function(a,b){var c=a.body;q.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{blockId:{type:"\x73\x74\x72\x69\x6e\x67"},limit:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:100},type:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:10},orderBy:{type:"\x73\x74\x72\x69\x6e\x67"},offset:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0},senderPublicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"},ownerPublicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"},ownerAddress:{type:"\x73\x74\x72\x69\x6e\x67"},senderId:{type:"\x73\x74\x72\x69\x6e\x67"},recipientId:{type:"\x73\x74\x72\x69\x6e\x67"},senderUsername:{type:"\x73\x74\x72\x69\x6e\x67"},recipientUsername:{type:"\x73\x74\x72\x69\x6e\x67"},amount:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:i.fixedPoint},fee:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:i.fixedPoint}}},function(a){return a?b(a[0].message):void s.list(c,function(a,c){return a?b("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x67\x65\x74\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73"):void b(null,{transactions:c.transactions,count:c.count})})})},t.getTransaction=function(a,b){var c=a.body;q.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{id:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1}},required:["\x69\x64"]},function(a){return a?b(a[0].message):void s.getById(c.id,function(a,c){return!c||a?b("\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64"):void b(null,{transaction:c})})})},t.getUnconfirmedTransaction=function(a,b){var c=a.body;q.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{id:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1}},required:["\x69\x64"]},function(a){if(a)return b(a[0].message);var d=r.getUnconfirmedTransaction(c.id);return d?void b(null,{transaction:d}):b("\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")})},t.getUnconfirmedTransactions=function(a,b){var c=a.body;q.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{senderPublicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"},address:{type:"\x73\x74\x72\x69\x6e\x67"}}},function(a){var d,e,f;if(a)return b(a[0].message);if(d=r.getUnconfirmedTransactionList(!0),e=[],c.senderPublicKey||c.address)for(f=0;f<d.length;f++)(d[f].senderPublicKey==c.senderPublicKey||d[f].recipientId==c.address)&&e.push(d[f]);else for(f=0;f<d.length;f++)e.push(d[f]);b(null,{transactions:e})})},t.addTransactions=function(a,b){var c=a.body;q.scheme.validate(c,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{secret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:100},amount:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:1,maximum:i.totalAmount},recipientId:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1},publicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"},secondSecret:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:100},multisigAccountPublicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"}},required:["\x73\x65\x63\x72\x65\x74","\x61\x6d\x6f\x75\x6e\x74","\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x49\x64"]},function(a){var e,f,h,i;return a?b(a[0].message):(e=g.createHash("\x73\x68\x61\x32\x35\x36").update(c.secret,"\x75\x74\x66\x38").digest(),f=d.MakeKeypair(e),c.publicKey&&f.publicKey.toString("\x68\x65\x78")!=c.publicKey?b("\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65"):(h={},i=/^[0-9]+[L|l]$/g,i.test(c.recipientId)?h.address=c.recipientId:h.username=c.recipientId,void q.balancesSequence.add(function(a){p.accounts.getAccount(h,function(b,e){var i,j;return b?a(""+b):!e&&h.username?a("\x52\x65\x63\x69\x70\x69\x65\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64"):(i=e?e.address:c.recipientId,j=e?e.username:null,void(c.multisigAccountPublicKey&&c.multisigAccountPublicKey!=f.publicKey.toString("\x68\x65\x78")?p.accounts.getAccount({publicKey:c.multisigAccountPublicKey},function(b,e){return b?a(""+b):e&&e.publicKey?e.multisignatures&&e.multisignatures?e.multisignatures.indexOf(f.publicKey.toString("\x68\x65\x78"))<0?a("\x41\x63\x63\x6f\x75\x6e\x74\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x62\x65\x6c\x6f\x6e\x67\x20\x74\x6f\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x67\x72\x6f\x75\x70"):void p.accounts.getAccount({publicKey:f.publicKey},function(b,h){var k,l,m;if(b)return a(""+b);if(!h||!h.publicKey)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x72\x65\x71\x75\x65\x73\x74\x65\x72");if(h.secondSignature&&!c.secondSecret)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x63\x6f\x6e\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65");if(h.publicKey==e.publicKey)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x72\x65\x71\x75\x65\x73\x74\x65\x72");k=null,h.secondSignature&&(l=g.createHash("\x73\x68\x61\x32\x35\x36").update(c.secondSecret,"\x75\x74\x66\x38").digest(),k=d.MakeKeypair(l));try{m=q.logic.transaction.create({type:n.SEND,amount:c.amount,sender:e,recipientId:i,recipientUsername:j,keypair:f,requester:f,secondKeypair:k})}catch(o){return a(""+o)}p.transactions.receiveTransactions([m],a)}):a("\x41\x63\x63\x6f\x75\x6e\x74\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x68\x61\x76\x65\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x65\x6e\x61\x62\x6c\x65\x64"):a("\x4d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x61\x63\x63\x6f\x75\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64")}):p.accounts.getAccount({publicKey:f.publicKey.toString("\x68\x65\x78")},function(b,e){var h,k,l;if(b)return a(""+b);if(!e||!e.publicKey)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x61\x63\x63\x6f\x75\x6e\x74");if(e.secondSignature&&!c.secondSecret)return a("\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x63\x6f\x6e\x64\x20\x70\x61\x73\x73\x70\x68\x72\x61\x73\x65");h=null,e.secondSignature&&(k=g.createHash("\x73\x68\x61\x32\x35\x36").update(c.secondSecret,"\x75\x74\x66\x38").digest(),h=d.MakeKeypair(k));try{l=q.logic.transaction.create({type:n.SEND,amount:c.amount,sender:e,recipientId:i,recipientUsername:j,keypair:f,secondKeypair:h})}catch(m){return a(""+m)}p.transactions.receiveTransactions([l],a)})))})},function(a,c){return a?b(""+a):void b(null,{transactionId:c[0].id})})))})},a.exports=v}),c.register("\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x74\x72\x61\x6e\x73\x70\x6f\x72\x74\x2e\x6a\x73",function(a,b,c){function t(a,b){p=b,q=this,q.__private=r,r.attachApi(),setImmediate(a,null,q)}var o,p,q,d=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x72\x6f\x75\x74\x65\x72\x2e\x6a\x73"),e=c("\x61\x73\x79\x6e\x63"),f=c("\x72\x65\x71\x75\x65\x73\x74"),g=c("\x69\x70"),h=c("\x75\x74\x69\x6c"),i=c("\x75\x6e\x64\x65\x72\x73\x63\x6f\x72\x65"),k=(c("\x7a\x6c\x69\x62"),c("\x65\x78\x74\x65\x6e\x64")),l=c("\x63\x72\x79\x70\x74\x6f"),m=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x62\x69\x67\x6e\x75\x6d\x2e\x6a\x73"),n=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x61\x6e\x64\x62\x6f\x78\x2e\x6a\x73"),r={},s={};r.headers={},r.loaded=!1,r.messages={},r.attachApi=function(){var a=new d;a.use(function(a,b,c){return o&&r.loaded?c():void b.status(500).send({success:!1,error:"\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x69\x73\x20\x6c\x6f\x61\x64\x69\x6e\x67"})}),a.use(function(a,b,c){var d=a.headers["\x78\x2d\x66\x6f\x72\x77\x61\x72\x64\x65\x64\x2d\x66\x6f\x72"]||a.connection.remoteAddress;return"\x31\x32\x37\x2e\x30\x2e\x30\x2e\x31"==d?c():d?(a.headers.port=parseInt(a.headers.port),a.headers["\x73\x68\x61\x72\x65\x2d\x70\x6f\x72\x74"]=parseInt(a.headers["\x73\x68\x61\x72\x65\x2d\x70\x6f\x72\x74"]),void a.sanitize(a.headers,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{port:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:1,maximum:65535},os:{type:"\x73\x74\x72\x69\x6e\x67",maxLength:64},"share-port":{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:1},version:{type:"\x73\x74\x72\x69\x6e\x67",maxLength:11}},required:["\x70\x6f\x72\x74","\x73\x68\x61\x72\x65\x2d\x70\x6f\x72\x74","\x76\x65\x72\x73\x69\x6f\x6e"]},function(e,f,h){if(e)return c(e);if(!f.isValid)return b.status(500).send({status:!1,error:f.issues});var i={ip:g.toLong(d),port:h.port,state:2,os:h.os,sharePort:+h["\x73\x68\x61\x72\x65\x2d\x70\x6f\x72\x74"],version:h.version};a.body&&a.body.dappid&&(i.dappid=a.body.dappid),i.port>0&&i.port<=65535&&i.version==p.config.version&&o.peer.update(i),c()})):b.status(500).send({success:!1,error:"\x57\x72\x6f\x6e\x67\x20\x68\x65\x61\x64\x65\x72\x20\x64\x61\x74\x61"})}),a.get("\x2f\x6c\x69\x73\x74",function(a,b){b.set(r.headers),o.peer.list({limit:100},function(a,c){return b.status(200).json({peers:a?[]:c})})}),a.get("\x2f\x62\x6c\x6f\x63\x6b\x73\x2f\x63\x6f\x6d\x6d\x6f\x6e",function(a,b,c){b.set(r.headers),a.sanitize(a.query,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{max:{type:"\x69\x6e\x74\x65\x67\x65\x72"},min:{type:"\x69\x6e\x74\x65\x67\x65\x72"},ids:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x73\x70\x6c\x69\x74\x61\x72\x72\x61\x79"}},required:["\x6d\x61\x78","\x6d\x69\x6e","\x69\x64\x73"]},function(d,e,f){var h,i,j,k,l,m;return d?c(d):e.isValid?(h=f.max,i=f.min,j=f.ids.split("\x2c").filter(function(a){return/^\d+$/.test(a)}),k=j.map(function(a){return"\x27"+a+"\x27"}),k.length?void p.dbLite.query("\x73\x65\x6c\x65\x63\x74\x20\x6d\x61\x78\x28\x68\x65\x69\x67\x68\x74\x29\x2c\x20\x69\x64\x2c\x20\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b\x2c\x20\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x20\x66\x72\x6f\x6d\x20\x62\x6c\x6f\x63\x6b\x73\x20\x77\x68\x65\x72\x65\x20\x69\x64\x20\x69\x6e\x20\x28"+k.join("\x2c")+"\x29\x20\x61\x6e\x64\x20\x68\x65\x69\x67\x68\x74\x20\x3e\x3d\x20\x24\x6d\x69\x6e\x20\x61\x6e\x64\x20\x68\x65\x69\x67\x68\x74\x20\x3c\x3d\x20\x24\x6d\x61\x78",{max:h,min:i},{height:Number,id:String,previousBlock:String,timestamp:Number},function(a,c){if(a)return b.json({success:!1,error:"\x44\x61\x74\x61\x62\x61\x73\x65\x20\x65\x72\x72\x6f\x72"});var d=c.length?c[0]:null;return b.json({success:!0,common:d})}):(e=p.scheme.validate(a.headers,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{port:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:1,maximum:65535}},required:["\x70\x6f\x72\x74"]}),l=a.headers["\x78\x2d\x66\x6f\x72\x77\x61\x72\x64\x65\x64\x2d\x66\x6f\x72"]||a.connection.remoteAddress,m=l?l+"\x3a"+(isNaN(parseInt(a.headers.port))?"\x75\x6e\x6b\x77\x6e\x6f\x77\x6e":parseInt(a.headers.port)):"\x75\x6e\x6b\x6e\x6f\x77\x6e",p.logger.log("\x49\x6e\x76\x61\x6c\x69\x64\x20\x63\x6f\x6d\x6d\x6f\x6e\x20\x62\x6c\x6f\x63\x6b\x20\x72\x65\x71\x75\x65\x73\x74\x2c\x20\x62\x61\x6e\x20\x36\x30\x20\x6d\x69\x6e",m),e&&o.peer.state(g.toLong(l),RequestSanitizer["\x69\x6e\x74"](a.headers.port),0,3600),b.json({success:!1,error:"\x49\x6e\x76\x61\x6c\x69\x64\x20\x62\x6c\x6f\x63\x6b\x20\x69\x64\x20\x73\x65\x71\x75\x65\x6e\x63\x65"}))):b.json({success:!1,error:e.issue})})}),a.get("\x2f\x62\x6c\x6f\x63\x6b\x73",function(a,b){b.set(r.headers),a.sanitize(a.query,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{lastBlockId:{type:"\x73\x74\x72\x69\x6e\x67"}}},function(a,c,d){if(a)return next(a);if(!c.isValid)return b.json({success:!1,error:c.issues});var e=1440;o.blocks.loadBlocksData({limit:e,lastId:d.lastBlockId},{plain:!0},function(a,c){return b.status(200),a?b.json({blocks:""}):void b.json({blocks:c})})})}),a.post("\x2f\x62\x6c\x6f\x63\x6b\x73",function(a,b){var c,d,f,h;b.set(r.headers),c=p.scheme.validate(a.headers,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{port:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:1,maximum:65535}},required:["\x70\x6f\x72\x74"]});try{d=p.logic.block.objectNormalize(a.body.block)}catch(e){return f=a.headers["\x78\x2d\x66\x6f\x72\x77\x61\x72\x64\x65\x64\x2d\x66\x6f\x72"]||a.connection.remoteAddress,h=f?f+"\x3a"+(isNaN(parseInt(a.headers.port))?"\x75\x6e\x6b\x77\x6e\x6f\x77\x6e":parseInt(a.headers.port)):"\x75\x6e\x6b\x6e\x6f\x77\x6e",p.logger.log("\x42\x6c\x6f\x63\x6b\x20"+(d?d.id:"\x6e\x75\x6c\x6c")+"\x20\x69\x73\x20\x6e\x6f\x74\x20\x76\x61\x6c\x69\x64\x2c\x20\x62\x61\x6e\x20\x36\x30\x20\x6d\x69\x6e",h),f&&c&&o.peer.state(g.toLong(f),parseInt(a.headers.port),0,3600),b.sendStatus(200)}p.bus.message("\x72\x65\x63\x65\x69\x76\x65\x42\x6c\x6f\x63\x6b",d),b.sendStatus(200)}),a.post("\x2f\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73",function(a,b){b.set(r.headers),p.scheme.validate(a.body,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{signature:{type:"\x6f\x62\x6a\x65\x63\x74",properties:{transaction:{type:"\x73\x74\x72\x69\x6e\x67"},signature:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x73\x69\x67\x6e\x61\x74\x75\x72\x65"}},required:["\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e","\x73\x69\x67\x6e\x61\x74\x75\x72\x65"]}},required:["\x73\x69\x67\x6e\x61\x74\x75\x72\x65"]},function(c){return c?b.status(200).json({success:!1,error:"\x56\x61\x6c\x69\x64\x61\x74\x69\x6f\x6e\x20\x65\x72\x72\x6f\x72"}):void o.multisignatures.processSignature(a.body.signature,function(a){return a?b.status(200).json({success:!1,error:"\x50\x72\x6f\x63\x65\x73\x73\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x65\x72\x72\x6f\x72"}):b.status(200).json({success:!0})})})}),a.get("\x2f\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73",function(a,b){var c,d;b.set(r.headers),c=o.transactions.getUnconfirmedTransactionList(),d=[],e.eachSeries(c,function(a,b){a.signatures&&a.signatures.length&&d.push({transaction:a.id,signatures:a.signatures}),setImmediate(b)},function(){return b.status(200).json({success:!0,signatures:d})})}),a.get("\x2f\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73",function(a,b){b.set(r.headers),b.status(200).json({transactions:o.transactions.getUnconfirmedTransactionList()})}),a.post("\x2f\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73",function(a,b){var c,d,f,h;b.set(r.headers),c=p.scheme.validate(a.headers,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{port:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:1,maximum:65535}},required:["\x70\x6f\x72\x74"]});try{d=p.logic.transaction.objectNormalize(a.body.transaction)}catch(e){return f=a.headers["\x78\x2d\x66\x6f\x72\x77\x61\x72\x64\x65\x64\x2d\x66\x6f\x72"]||a.connection.remoteAddress,h=f?f+"\x3a"+(isNaN(a.headers.port)?"\x75\x6e\x6b\x6e\x6f\x77\x6e":a.headers.port):"\x75\x6e\x6b\x6e\x6f\x77\x6e",p.logger.log("\x52\x65\x63\x65\x69\x76\x65\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20"+(d?d.id:"\x6e\x75\x6c\x6c")+"\x20\x69\x73\x20\x6e\x6f\x74\x20\x76\x61\x6c\x69\x64\x2c\x20\x62\x61\x6e\x20\x36\x30\x20\x6d\x69\x6e",h),f&&c&&o.peer.state(g.toLong(f),a.headers.port,0,3600),b.status(200).json({success:!1,message:"\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x62\x6f\x64\x79"})}p.balancesSequence.add(function(a){o.transactions.receiveTransactions([d],a)},function(a){a?b.status(200).json({success:!1,message:a}):b.status(200).json({success:!0})})}),a.get("\x2f\x68\x65\x69\x67\x68\x74",function(a,b){b.set(r.headers),b.status(200).json({height:o.blocks.getLastBlock().height})}),a.post("\x2f\x64\x61\x70\x70\x2f\x6d\x65\x73\x73\x61\x67\x65",function(a,b){b.set(r.headers);try{if(!a.body.dappid)return b.status(200).json({success:!1,message:"\x6d\x69\x73\x73\x65\x64\x20\x64\x61\x70\x70\x69\x64"});if(!a.body.timestamp||!a.body.hash)return b.status(200).json({success:!1,message:"\x6d\x69\x73\x73\x65\x64\x20\x68\x61\x73\x68\x20\x73\x75\x6d"});var c=r.hashsum(a.body.body,a.body.timestamp);if(c!==a.body.hash)return b.status(200).json({success:!1,message:"\x77\x72\x6f\x6e\x67\x20\x68\x61\x73\x68\x20\x73\x75\x6d"})}catch(d){return b.status(200).json({success:!1,message:""+d})}return r.messages[a.body.hash]?b.status(200):(r.messages[a.body.hash]=!0,void o.dapps.message(a.body.dappid,a.body.body,function(c,d){return!c&&d.error&&(c=d.error),c?b.status(200).json({success:!1,message:c}):(p.bus.message("\x6d\x65\x73\x73\x61\x67\x65",a.body,!0),void b.status(200).json(k({},d,{success:!0})))}))}),a.post("\x2f\x64\x61\x70\x70\x2f\x72\x65\x71\x75\x65\x73\x74",function(a,b){b.set(r.headers);try{if(!a.body.dappid)return b.status(200).json({success:!1,message:"\x6d\x69\x73\x73\x65\x64\x20\x64\x61\x70\x70\x69\x64"});if(!a.body.timestamp||!a.body.hash)return b.status(200).json({success:!1,message:"\x6d\x69\x73\x73\x65\x64\x20\x68\x61\x73\x68\x20\x73\x75\x6d"});var c=r.hashsum(a.body.body,a.body.timestamp);if(c!==a.body.hash)return b.status(200).json({success:!1,message:"\x77\x72\x6f\x6e\x67\x20\x68\x61\x73\x68\x20\x73\x75\x6d"})}catch(d){return b.status(200).json({success:!1,message:""+d})}o.dapps.request(a.body.dappid,a.body.body.method,a.body.body.path,a.body.body.query,function(a,c){return!a&&c.error&&(a=c.error),a?b.status(200).json({success:!1,message:a}):void b.status(200).json(k({},c,{success:!0}))})}),a.use(function(a,b){b.status(500).send({success:!1,error:"\x41\x50\x49\x20\x65\x6e\x64\x70\x6f\x69\x6e\x74\x20\x6e\x6f\x74\x20\x66\x6f\x75\x6e\x64"})}),p.network.app.use("\x2f\x70\x65\x65\x72",a),p.network.app.use(function(a,b,c,d){return a?(p.logger.error(b.url,""+a),void c.status(500).send({success:!1,error:""+a})):d()})},r.hashsum=function(a){var e,b=new Buffer(JSON.stringify(a),"\x75\x74\x66\x38"),c=l.createHash("\x73\x68\x61\x32\x35\x36").update(b).digest(),d=new Buffer(8);for(e=0;8>e;e++)d[e]=c[7-e];return""+m.fromBuffer(d)},t.prototype.broadcast=function(a,b,c){a.limit=a.limit||1,o.peer.list(a,function(a,d){a?c&&setImmediate(c,a):e.eachLimit(d,3,function(a,c){q.getFromPeer(a,b),setImmediate(c)},function(){c&&c(null,{body:null,peer:d})})})},t.prototype.getFromRandomPeer=function(a,b,c){"\x66\x75\x6e\x63\x74\x69\x6f\x6e"==typeof b&&(c=b,b=a,a={}),a.limit=1,e.retry(20,function(c){o.peer.list(a,function(a,d){if(a||!d.length)return c(a||"\x4e\x6f\x20\x70\x65\x65\x72\x73\x20\x69\x6e\x20\x64\x62");var e=d[0];q.getFromPeer(e,b,c)})},function(a,b){c(a,b)})},t.prototype.getFromPeer=function(a,b,c){var d,e;return d=b.api?"\x2f\x70\x65\x65\x72"+b.api:b.url,e={url:"\x68\x74\x74\x70\x3a\x2f\x2f"+g.fromLong(a.ip)+"\x3a"+a.port+d,method:b.method,json:!0,headers:i.extend({},r.headers,b.headers),timeout:p.config.peers.options.timeout},"\x5b\x6f\x62\x6a\x65\x63\x74\x20\x4f\x62\x6a\x65\x63\x74\x5d"===Object.prototype.toString.call(b.data)||h.isArray(b.data)?e.json=b.data:e.body=b.data,f(e,function(d,f,g){var h,i;return d||200!=f.statusCode?(p.logger.debug("\x52\x65\x71\x75\x65\x73\x74",{url:e.url,statusCode:f?f.statusCode:"\x75\x6e\x6b\x6e\x6f\x77\x6e",err:d}),a&&(!d||"\x45\x54\x49\x4d\x45\x44\x4f\x55\x54"!=d.code&&"\x45\x53\x4f\x43\x4b\x45\x54\x54\x49\x4d\x45\x44\x4f\x55\x54"!=d.code&&"\x45\x43\x4f\x4e\x4e\x52\x45\x46\x55\x53\x45\x44"!=d.code?b.not_ban||o.peer.state(a.ip,a.port,0,600,function(a){a||p.logger.info("\x42\x61\x6e\x20\x31\x30\x20\x6d\x69\x6e\x20"+e.method+"\x20"+e.url)}):o.peer.remove(a.ip,a.port,function(a){a||p.logger.info("\x52\x65\x6d\x6f\x76\x69\x6e\x67\x20\x70\x65\x65\x72\x20"+e.method+"\x20"+e.url)})),void(c&&c(d||"\x72\x65\x71\x75\x65\x73\x74\x20\x73\x74\x61\x74\x75\x73\x20\x63\x6f\x64\x65"+f.statusCode))):(f.headers.port=parseInt(f.headers.port),f.headers["\x73\x68\x61\x72\x65\x2d\x70\x6f\x72\x74"]=parseInt(f.headers["\x73\x68\x61\x72\x65\x2d\x70\x6f\x72\x74"]),(h=p.scheme.validate(f.headers,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{os:{type:"\x73\x74\x72\x69\x6e\x67",maxLength:64},port:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:1,maximum:65535},"share-port":{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:1},version:{type:"\x73\x74\x72\x69\x6e\x67",maxLength:11}},required:["\x70\x6f\x72\x74","\x73\x68\x61\x72\x65\x2d\x70\x6f\x72\x74","\x76\x65\x72\x73\x69\x6f\x6e"]}))?(i=f.headers.port,i>0&&65535>=i&&f.headers.version==p.config.version&&o.peer.update({ip:a.ip,port:i,state:2,os:f.headers.os,sharePort:+!!f.headers["\x73\x68\x61\x72\x65\x2d\x70\x6f\x72\x74"],version:f.headers.version}),void(c&&c(null,{body:g,peer:a}))):c&&c(null,{body:g,peer:a}))})},t.prototype.sandboxApi=function(a,b,c){n.callMethod(s,a,b,c)},t.prototype.onBind=function(a){o=a,r.headers={os:o.system.getOS(),version:o.system.getVersion(),port:o.system.getPort(),"share-port":o.system.getSharePort()}},t.prototype.onBlockchainReady=function(){r.loaded=!0},t.prototype.onSignature=function(a,b){b&&(q.broadcast({limit:100},{api:"\x2f\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73",data:{signature:a},method:"\x50\x4f\x53\x54"}),p.network.io.sockets.emit("\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x2f\x63\x68\x61\x6e\x67\x65",{}))},t.prototype.onUnconfirmedTransaction=function(a,b){b&&(q.broadcast({limit:100},{api:"\x2f\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73",data:{transaction:a},method:"\x50\x4f\x53\x54"}),p.network.io.sockets.emit("\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73\x2f\x63\x68\x61\x6e\x67\x65",{}))},t.prototype.onNewBlock=function(a,b){b&&(q.broadcast({limit:100},{api:"\x2f\x62\x6c\x6f\x63\x6b\x73",data:{block:a},method:"\x50\x4f\x53\x54"}),p.network.io.sockets.emit("\x62\x6c\x6f\x63\x6b\x73\x2f\x63\x68\x61\x6e\x67\x65",{}))},t.prototype.onMessage=function(a,b){b&&q.broadcast({limit:100,dappid:a.dappid},{api:"\x2f\x64\x61\x70\x70\x2f\x6d\x65\x73\x73\x61\x67\x65",data:a,method:"\x50\x4f\x53\x54"})},t.prototype.cleanup=function(a){r.loaded=!1,a()},s.message=function(a,b){a.timestamp=(new Date).getTime(),a.hash=r.hashsum(a.body,a.timestamp),q.broadcast({limit:100,dappid:a.dappid},{api:"\x2f\x64\x61\x70\x70\x2f\x6d\x65\x73\x73\x61\x67\x65",data:a,method:"\x50\x4f\x53\x54"}),b(null,{})},s.request=function(a,b){a.timestamp=(new Date).getTime(),a.hash=r.hashsum(a.body,a.timestamp),a.body.peer?q.getFromPeer({ip:a.body.peer.ip,port:a.body.peer.port},{api:"\x2f\x64\x61\x70\x70\x2f\x72\x65\x71\x75\x65\x73\x74",data:a,method:"\x50\x4f\x53\x54"},b):q.getFromRandomPeer({dappid:a.dappid},{api:"\x2f\x64\x61\x70\x70\x2f\x72\x65\x71\x75\x65\x73\x74",data:a,method:"\x50\x4f\x53\x54"},b)},a.exports=t}),c.register("\x2e\x2f\x6c\x6f\x67\x69\x63\x2f\x61\x63\x63\x6f\x75\x6e\x74\x2e\x6a\x73",function(a,b,c){function j(a,b){this.scope=a,h=this.scope.genesisblock.block,this.table="\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73",this.model=[{name:"\x75\x73\x65\x72\x6e\x61\x6d\x65",type:"\x53\x74\x72\x69\x6e\x67",length:20,filter:{type:"\x73\x74\x72\x69\x6e\x67",maxLength:20,minLength:1},conv:String,constante:!0},{name:"\x69\x73\x44\x65\x6c\x65\x67\x61\x74\x65",type:"\x42\x69\x67\x49\x6e\x74",filter:{type:"\x62\x6f\x6f\x6c\x65\x61\x6e"},conv:Boolean,"default":0},{name:"\x75\x5f\x69\x73\x44\x65\x6c\x65\x67\x61\x74\x65",type:"\x42\x69\x67\x49\x6e\x74",filter:{type:"\x62\x6f\x6f\x6c\x65\x61\x6e"},conv:Boolean,"default":0},{name:"\x73\x65\x63\x6f\x6e\x64\x53\x69\x67\x6e\x61\x74\x75\x72\x65",type:"\x42\x69\x67\x49\x6e\x74",filter:{type:"\x62\x6f\x6f\x6c\x65\x61\x6e"},conv:Boolean,"default":0},{name:"\x75\x5f\x73\x65\x63\x6f\x6e\x64\x53\x69\x67\x6e\x61\x74\x75\x72\x65",type:"\x42\x69\x67\x49\x6e\x74",filter:{type:"\x62\x6f\x6f\x6c\x65\x61\x6e"},conv:Boolean,"default":0},{name:"\x75\x5f\x75\x73\x65\x72\x6e\x61\x6d\x65",type:"\x53\x74\x72\x69\x6e\x67",length:20,filter:{type:"\x73\x74\x72\x69\x6e\x67",maxLength:20},conv:String,constante:!0},{name:"\x61\x64\x64\x72\x65\x73\x73",type:"\x53\x74\x72\x69\x6e\x67",length:21,not_null:!0,unique:!0,primary_key:!0,filter:{required:!0,type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:21},conv:String,constante:!0},{name:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79",type:"\x42\x69\x6e\x61\x72\x79",length:32,filter:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"},conv:String,constante:!0},{name:"\x73\x65\x63\x6f\x6e\x64\x50\x75\x62\x6c\x69\x63\x4b\x65\x79",type:"\x42\x69\x6e\x61\x72\x79",length:32,filter:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"},conv:String,constante:!0},{name:"\x62\x61\x6c\x61\x6e\x63\x65",type:"\x42\x69\x67\x49\x6e\x74",filter:{required:!0,type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:f.totalAmount},conv:Number,"default":0},{name:"\x75\x5f\x62\x61\x6c\x61\x6e\x63\x65",type:"\x42\x69\x67\x49\x6e\x74",filter:{required:!0,type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:f.totalAMount},conv:Number,"default":0},{name:"\x76\x6f\x74\x65",type:"\x42\x69\x67\x49\x6e\x74",filter:{type:"\x69\x6e\x74\x65\x67\x65\x72"},conv:Number,"default":0},{name:"\x72\x61\x74\x65",type:"\x42\x69\x67\x49\x6e\x74",filter:{type:"\x69\x6e\x74\x65\x67\x65\x72"},conv:Number,"default":0},{name:"\x64\x65\x6c\x65\x67\x61\x74\x65\x73",type:"\x54\x65\x78\x74",filter:{type:"\x61\x72\x72\x61\x79",uniqueItems:!0},conv:Array,expression:"\x28\x73\x65\x6c\x65\x63\x74\x20\x47\x52\x4f\x55\x50\x5f\x43\x4f\x4e\x43\x41\x54\x28\x64\x65\x70\x65\x6e\x64\x65\x6e\x74\x49\x64\x29\x20\x66\x72\x6f\x6d\x20"+this.table+"\x32\x64\x65\x6c\x65\x67\x61\x74\x65\x73\x20\x77\x68\x65\x72\x65\x20\x61\x63\x63\x6f\x75\x6e\x74\x49\x64\x20\x3d\x20\x61\x2e\x61\x64\x64\x72\x65\x73\x73\x29"},{name:"\x63\x6f\x6e\x74\x61\x63\x74\x73",type:"\x54\x65\x78\x74",filter:{type:"\x61\x72\x72\x61\x79",uniqueItems:!0},conv:Array,expression:"\x28\x73\x65\x6c\x65\x63\x74\x20\x47\x52\x4f\x55\x50\x5f\x43\x4f\x4e\x43\x41\x54\x28\x64\x65\x70\x65\x6e\x64\x65\x6e\x74\x49\x64\x29\x20\x66\x72\x6f\x6d\x20"+this.table+"\x32\x63\x6f\x6e\x74\x61\x63\x74\x73\x20\x77\x68\x65\x72\x65\x20\x61\x63\x63\x6f\x75\x6e\x74\x49\x64\x20\x3d\x20\x61\x2e\x61\x64\x64\x72\x65\x73\x73\x29"},{name:"\x66\x6f\x6c\x6c\x6f\x77\x65\x72\x73",type:"\x54\x65\x78\x74",filter:{type:"\x61\x72\x72\x61\x79",uniqueItems:!0},conv:Array,expression:"\x28\x73\x65\x6c\x65\x63\x74\x20\x47\x52\x4f\x55\x50\x5f\x43\x4f\x4e\x43\x41\x54\x28\x61\x63\x63\x6f\x75\x6e\x74\x49\x64\x29\x20\x66\x72\x6f\x6d\x20"+this.table+"\x32\x63\x6f\x6e\x74\x61\x63\x74\x73\x20\x77\x68\x65\x72\x65\x20\x64\x65\x70\x65\x6e\x64\x65\x6e\x74\x49\x64\x20\x3d\x20\x61\x2e\x61\x64\x64\x72\x65\x73\x73\x29",readonly:!0},{name:"\x75\x5f\x64\x65\x6c\x65\x67\x61\x74\x65\x73",type:"\x54\x65\x78\x74",filter:{type:"\x61\x72\x72\x61\x79",uniqueItems:!0},conv:Array,expression:"\x28\x73\x65\x6c\x65\x63\x74\x20\x47\x52\x4f\x55\x50\x5f\x43\x4f\x4e\x43\x41\x54\x28\x64\x65\x70\x65\x6e\x64\x65\x6e\x74\x49\x64\x29\x20\x66\x72\x6f\x6d\x20"+this.table+"\x32\x75\x5f\x64\x65\x6c\x65\x67\x61\x74\x65\x73\x20\x77\x68\x65\x72\x65\x20\x61\x63\x63\x6f\x75\x6e\x74\x49\x64\x20\x3d\x20\x61\x2e\x61\x64\x64\x72\x65\x73\x73\x29"},{name:"\x75\x5f\x63\x6f\x6e\x74\x61\x63\x74\x73",type:"\x54\x65\x78\x74",filter:{type:"\x61\x72\x72\x61\x79",uniqueItems:!0},conv:Array,expression:"\x28\x73\x65\x6c\x65\x63\x74\x20\x47\x52\x4f\x55\x50\x5f\x43\x4f\x4e\x43\x41\x54\x28\x64\x65\x70\x65\x6e\x64\x65\x6e\x74\x49\x64\x29\x20\x66\x72\x6f\x6d\x20"+this.table+"\x32\x75\x5f\x63\x6f\x6e\x74\x61\x63\x74\x73\x20\x77\x68\x65\x72\x65\x20\x61\x63\x63\x6f\x75\x6e\x74\x49\x64\x20\x3d\x20\x61\x2e\x61\x64\x64\x72\x65\x73\x73\x29"},{name:"\x75\x5f\x66\x6f\x6c\x6c\x6f\x77\x65\x72\x73",type:"\x54\x65\x78\x74",filter:{type:"\x61\x72\x72\x61\x79",uniqueItems:!0},conv:Array,expression:"\x28\x73\x65\x6c\x65\x63\x74\x20\x47\x52\x4f\x55\x50\x5f\x43\x4f\x4e\x43\x41\x54\x28\x61\x63\x63\x6f\x75\x6e\x74\x49\x64\x29\x20\x66\x72\x6f\x6d\x20"+this.table+"\x32\x75\x5f\x63\x6f\x6e\x74\x61\x63\x74\x73\x20\x77\x68\x65\x72\x65\x20\x64\x65\x70\x65\x6e\x64\x65\x6e\x74\x49\x64\x20\x3d\x20\x61\x2e\x61\x64\x64\x72\x65\x73\x73\x29",readonly:!0},{name:"\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73",type:"\x54\x65\x78\x74",filter:{type:"\x61\x72\x72\x61\x79",uniqueItems:!0},conv:Array,expression:"\x28\x73\x65\x6c\x65\x63\x74\x20\x47\x52\x4f\x55\x50\x5f\x43\x4f\x4e\x43\x41\x54\x28\x64\x65\x70\x65\x6e\x64\x65\x6e\x74\x49\x64\x29\x20\x66\x72\x6f\x6d\x20"+this.table+"\x32\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x77\x68\x65\x72\x65\x20\x61\x63\x63\x6f\x75\x6e\x74\x49\x64\x20\x3d\x20\x61\x2e\x61\x64\x64\x72\x65\x73\x73\x29"},{name:"\x75\x5f\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73",type:"\x54\x65\x78\x74",filter:{type:"\x61\x72\x72\x61\x79",uniqueItems:!0},conv:Array,expression:"\x28\x73\x65\x6c\x65\x63\x74\x20\x47\x52\x4f\x55\x50\x5f\x43\x4f\x4e\x43\x41\x54\x28\x64\x65\x70\x65\x6e\x64\x65\x6e\x74\x49\x64\x29\x20\x66\x72\x6f\x6d\x20"+this.table+"\x32\x75\x5f\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x20\x77\x68\x65\x72\x65\x20\x61\x63\x63\x6f\x75\x6e\x74\x49\x64\x20\x3d\x20\x61\x2e\x61\x64\x64\x72\x65\x73\x73\x29"},{name:"\x6d\x75\x6c\x74\x69\x6d\x69\x6e",type:"\x42\x69\x67\x49\x6e\x74",filter:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:17},conv:Number,"default":0},{name:"\x75\x5f\x6d\x75\x6c\x74\x69\x6d\x69\x6e",type:"\x42\x69\x67\x49\x6e\x74",filter:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:17},conv:Number,"default":0},{name:"\x6d\x75\x6c\x74\x69\x6c\x69\x66\x65\x74\x69\x6d\x65",type:"\x42\x69\x67\x49\x6e\x74",filter:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:1,maximum:72},conv:Number,"default":0},{name:"\x75\x5f\x6d\x75\x6c\x74\x69\x6c\x69\x66\x65\x74\x69\x6d\x65",type:"\x42\x69\x67\x49\x6e\x74",filter:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:1,maximum:72},conv:Number,"default":0},{name:"\x62\x6c\x6f\x63\x6b\x49\x64",type:"\x53\x74\x72\x69\x6e\x67",length:20,filter:{type:"\x73\x74\x72\x69\x6e\x67",minLength:1,maxLength:20},conv:String,"default":h.id},{name:"\x6e\x61\x6d\x65\x65\x78\x69\x73\x74",type:"\x42\x6f\x6f\x6c\x65\x61\x6e",filter:{type:"\x62\x6f\x6f\x6c\x65\x61\x6e"},conv:Boolean,"default":0},{
name:"\x75\x5f\x6e\x61\x6d\x65\x65\x78\x69\x73\x74",type:"\x42\x6f\x6f\x6c\x65\x61\x6e",filter:{type:"\x62\x6f\x6f\x6c\x65\x61\x6e"},conv:Boolean,"default":0},{name:"\x70\x72\x6f\x64\x75\x63\x65\x64\x62\x6c\x6f\x63\x6b\x73",type:"\x42\x69\x67\x49\x6e\x74",filter:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:-1,maximum:1},conv:Number,"default":0},{name:"\x6d\x69\x73\x73\x65\x64\x62\x6c\x6f\x63\x6b\x73",type:"\x42\x69\x67\x49\x6e\x74",filter:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:-1,maximum:1},conv:Number,"default":0},{name:"\x76\x69\x72\x67\x69\x6e",type:"\x42\x6f\x6f\x6c\x65\x61\x6e",filter:{type:"\x62\x6f\x6f\x6c\x65\x61\x6e"},conv:Boolean,expression:"\x30"},{name:"\x66\x65\x65\x73",type:"\x42\x69\x67\x49\x6e\x74",filter:{type:"\x69\x6e\x74\x65\x67\x65\x72"},conv:Number,"default":0},{name:"\x72\x65\x77\x61\x72\x64\x73",type:"\x42\x69\x67\x49\x6e\x74",filter:{type:"\x69\x6e\x74\x65\x67\x65\x72"},conv:Number,"default":0}],this.fields=this.model.map(function(a){var b={};return"\x42\x69\x6e\x61\x72\x79"==a.type&&(b.expression=["\x6c\x6f\x77\x65\x72","\x68\x65\x78"]),a.expression?b.expression=a.expression:(a.mod&&(b.expression=a.mod),b.field=a.name),(b.expression||a.alias)&&(b.alias=a.alias||a.name),b}),this.binary=[],this.model.forEach(function(a){"\x42\x69\x6e\x61\x72\x79"==a.type&&this.binary.push(a.name)}.bind(this)),this.filter={},this.model.forEach(function(a){this.filter[a.name]=a.filter}.bind(this)),this.conv={},this.model.forEach(function(a){this.conv[a.name]=a.conv}.bind(this)),this.editable=[],this.model.forEach(function(a){a.constante||a.readonly||this.editable.push(a.name)}.bind(this)),setImmediate(b,null,this)}var f,g,h,i,d=c("\x61\x73\x79\x6e\x63"),e=c("\x6a\x73\x6f\x6e\x2d\x73\x71\x6c")();e.setDialect("\x73\x71\x6c\x69\x74\x65"),f=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x63\x6f\x6e\x73\x74\x61\x6e\x74\x73\x2e\x6a\x73"),g=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x6c\x6f\x74\x73\x2e\x6a\x73"),h=null,i={},j.prototype.createTables=function(a){var b=this.scope,c=[],f=e.build({type:"\x63\x72\x65\x61\x74\x65",table:this.table,tableFields:this.model});c.push(f.query),f=e.build({type:"\x63\x72\x65\x61\x74\x65",table:"\x6d\x65\x6d\x5f\x72\x6f\x75\x6e\x64",tableFields:[{name:"\x61\x64\x64\x72\x65\x73\x73",type:"\x53\x74\x72\x69\x6e\x67",length:21},{name:"\x61\x6d\x6f\x75\x6e\x74",type:"\x42\x69\x67\x49\x6e\x74"},{name:"\x64\x65\x6c\x65\x67\x61\x74\x65",type:"\x53\x74\x72\x69\x6e\x67",length:64},{name:"\x62\x6c\x6f\x63\x6b\x49\x64",type:"\x53\x74\x72\x69\x6e\x67",length:20},{name:"\x72\x6f\x75\x6e\x64",type:"\x42\x69\x67\x49\x6e\x74"}]}),c.push(f.query),f=e.build({type:"\x63\x72\x65\x61\x74\x65",table:this.table+"\x32\x64\x65\x6c\x65\x67\x61\x74\x65\x73",tableFields:[{name:"\x61\x63\x63\x6f\x75\x6e\x74\x49\x64",type:"\x53\x74\x72\x69\x6e\x67",length:21,not_null:!0},{name:"\x64\x65\x70\x65\x6e\x64\x65\x6e\x74\x49\x64",type:"\x53\x74\x72\x69\x6e\x67",length:21,not_null:!0}],foreignKeys:[{field:"\x61\x63\x63\x6f\x75\x6e\x74\x49\x64",table:this.table,table_field:"\x61\x64\x64\x72\x65\x73\x73",on_delete:"\x63\x61\x73\x63\x61\x64\x65"}]}),c.push(f.query),f=e.build({type:"\x63\x72\x65\x61\x74\x65",table:this.table+"\x32\x63\x6f\x6e\x74\x61\x63\x74\x73",tableFields:[{name:"\x61\x63\x63\x6f\x75\x6e\x74\x49\x64",type:"\x53\x74\x72\x69\x6e\x67",length:21,not_null:!0},{name:"\x64\x65\x70\x65\x6e\x64\x65\x6e\x74\x49\x64",type:"\x53\x74\x72\x69\x6e\x67",length:21,not_null:!0}],foreignKeys:[{field:"\x61\x63\x63\x6f\x75\x6e\x74\x49\x64",table:this.table,table_field:"\x61\x64\x64\x72\x65\x73\x73",on_delete:"\x63\x61\x73\x63\x61\x64\x65"}]}),c.push(f.query),f=e.build({type:"\x63\x72\x65\x61\x74\x65",table:this.table+"\x32\x75\x5f\x64\x65\x6c\x65\x67\x61\x74\x65\x73",tableFields:[{name:"\x61\x63\x63\x6f\x75\x6e\x74\x49\x64",type:"\x53\x74\x72\x69\x6e\x67",length:21,not_null:!0},{name:"\x64\x65\x70\x65\x6e\x64\x65\x6e\x74\x49\x64",type:"\x53\x74\x72\x69\x6e\x67",length:21,not_null:!0}],foreignKeys:[{field:"\x61\x63\x63\x6f\x75\x6e\x74\x49\x64",table:this.table,table_field:"\x61\x64\x64\x72\x65\x73\x73",on_delete:"\x63\x61\x73\x63\x61\x64\x65"}]}),c.push(f.query),f=e.build({type:"\x63\x72\x65\x61\x74\x65",table:this.table+"\x32\x75\x5f\x63\x6f\x6e\x74\x61\x63\x74\x73",tableFields:[{name:"\x61\x63\x63\x6f\x75\x6e\x74\x49\x64",type:"\x53\x74\x72\x69\x6e\x67",length:21,not_null:!0},{name:"\x64\x65\x70\x65\x6e\x64\x65\x6e\x74\x49\x64",type:"\x53\x74\x72\x69\x6e\x67",length:21,not_null:!0}],foreignKeys:[{field:"\x61\x63\x63\x6f\x75\x6e\x74\x49\x64",table:this.table,table_field:"\x61\x64\x64\x72\x65\x73\x73",on_delete:"\x63\x61\x73\x63\x61\x64\x65"}]}),c.push(f.query),f=e.build({type:"\x63\x72\x65\x61\x74\x65",table:this.table+"\x32\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73",tableFields:[{name:"\x61\x63\x63\x6f\x75\x6e\x74\x49\x64",type:"\x53\x74\x72\x69\x6e\x67",length:21,not_null:!0},{name:"\x64\x65\x70\x65\x6e\x64\x65\x6e\x74\x49\x64",type:"\x53\x74\x72\x69\x6e\x67",length:21,not_null:!0}],foreignKeys:[{field:"\x61\x63\x63\x6f\x75\x6e\x74\x49\x64",table:this.table,table_field:"\x61\x64\x64\x72\x65\x73\x73",on_delete:"\x63\x61\x73\x63\x61\x64\x65"}]}),c.push(f.query),f=e.build({type:"\x63\x72\x65\x61\x74\x65",table:this.table+"\x32\x75\x5f\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73",tableFields:[{name:"\x61\x63\x63\x6f\x75\x6e\x74\x49\x64",type:"\x53\x74\x72\x69\x6e\x67",length:21,not_null:!0},{name:"\x64\x65\x70\x65\x6e\x64\x65\x6e\x74\x49\x64",type:"\x53\x74\x72\x69\x6e\x67",length:21,not_null:!0}],foreignKeys:[{field:"\x61\x63\x63\x6f\x75\x6e\x74\x49\x64",table:this.table,table_field:"\x61\x64\x64\x72\x65\x73\x73",on_delete:"\x63\x61\x73\x63\x61\x64\x65"}]}),c.push(f.query),c.push("\x64\x65\x6c\x65\x74\x65\x20\x66\x72\x6f\x6d\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x32\x75\x5f\x63\x6f\x6e\x74\x61\x63\x74\x73\x3b"),c.push("\x64\x65\x6c\x65\x74\x65\x20\x66\x72\x6f\x6d\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x32\x75\x5f\x64\x65\x6c\x65\x67\x61\x74\x65\x73\x3b"),c.push("\x49\x4e\x53\x45\x52\x54\x20\x49\x4e\x54\x4f\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x32\x75\x5f\x63\x6f\x6e\x74\x61\x63\x74\x73\x20\x53\x45\x4c\x45\x43\x54\x20\x2a\x20\x46\x52\x4f\x4d\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x32\x63\x6f\x6e\x74\x61\x63\x74\x73\x3b"),c.push("\x49\x4e\x53\x45\x52\x54\x20\x49\x4e\x54\x4f\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x32\x75\x5f\x64\x65\x6c\x65\x67\x61\x74\x65\x73\x20\x53\x45\x4c\x45\x43\x54\x20\x2a\x20\x46\x52\x4f\x4d\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x32\x64\x65\x6c\x65\x67\x61\x74\x65\x73\x3b"),d.eachSeries(c,function(a,c){b.dbLite.query(a,function(a,b){c(a,b)})}.bind(this),function(b){setImmediate(a,b,this)}.bind(this))},j.prototype.removeTables=function(a){var b=this.scope,c=[],f=e.build({type:"\x72\x65\x6d\x6f\x76\x65",table:this.table});c.push(f.query),d.eachSeries(c,function(a,c){b.dbLite.query(a,function(a,b){c(a,b)})}.bind(this),function(b){setImmediate(a,b,this)}.bind(this))},j.prototype.objectNormalize=function(a){var b=this.scope.scheme.validate(a,{object:!0,properties:this.filter});if(!b)throw Error(this.scope.scheme.getLastError());return a},j.prototype.toDB=function(a){return this.binary.forEach(function(b){a[b]&&(a[b]=new Buffer(a[b],"\x68\x65\x78"))}),a},j.prototype.get=function(a,b,c){"\x66\x75\x6e\x63\x74\x69\x6f\x6e"==typeof b&&(c=b,b=this.fields.map(function(a){return a.alias||a.field})),this.getAll(a,b,function(a,b){c(a,b&&b.length?b[0]:null)})},j.prototype.getAll=function(a,b,c){var d,f,g,h,i,j;"\x66\x75\x6e\x63\x74\x69\x6f\x6e"==typeof b&&(c=b,b=this.fields.map(function(a){return a.alias||a.field})),d=this.fields.filter(function(a){return-1!=b.indexOf(a.alias||a.field)}),f={},Object.keys(this.conv).forEach(function(a){-1!=b.indexOf(a)&&(f[a]=this.conv[a])}.bind(this)),a.limit>0&&(g=a.limit),delete a.limit,a.offset>0&&(h=a.offset),delete a.offset,a.sort&&(i=a.sort),delete a.sort,j=e.build({type:"\x73\x65\x6c\x65\x63\x74",table:this.table,limit:g,offset:h,sort:i,alias:"\x61",condition:a,fields:d}),this.scope.dbLite.query(j.query,j.values,f,function(a,b){return a?c(a):void c(null,b||[])}.bind(this))},j.prototype.set=function(a,b,c){var g,h,i,f=this;void 0===b.publicKey||b.publicKey||console.log("\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21",a,diff),b.address=a,g=b,h=[],i=e.build({type:"\x69\x6e\x73\x65\x72\x74",or:"\x69\x67\x6e\x6f\x72\x65",table:this.table,values:this.toDB(g)}),h.push(i),i=e.build({type:"\x75\x70\x64\x61\x74\x65",table:this.table,modifier:this.toDB(g),condition:{address:a}}),h.push(i),d.eachSeries(h,function(a,b){f.scope.dbLite.query(a.query,a.values,function(a,c){b(a,c)})},c)},j.prototype.merge=function(a,b,c){function o(b){return 2!=c.length?c(b):b?c(b):void l.get({address:a},c)}var m,n,f={},g={},h={},i={},j={},k=[],l=this;void 0===b.publicKey||b.publicKey||console.log("\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21\x21",a,b),this.editable.forEach(function(c){var d,e,m,n;if(b[c])switch(d=b[c],l.conv[c]){case String:f[c]=d;break;case Number:Math.abs(d)===d&&0!==d?(f.$inc=f.$inc||{},f.$inc[c]=d,"\x62\x61\x6c\x61\x6e\x63\x65"==c&&k.push({query:"\x69\x6e\x73\x65\x72\x74\x20\x69\x6e\x74\x6f\x20\x6d\x65\x6d\x5f\x72\x6f\x75\x6e\x64\x20\x28\x61\x64\x64\x72\x65\x73\x73\x2c\x20\x61\x6d\x6f\x75\x6e\x74\x2c\x20\x64\x65\x6c\x65\x67\x61\x74\x65\x2c\x20\x62\x6c\x6f\x63\x6b\x49\x64\x2c\x20\x72\x6f\x75\x6e\x64\x29\x20\x73\x65\x6c\x65\x63\x74\x20\x24\x61\x64\x64\x72\x65\x73\x73\x2c\x20\x24\x61\x6d\x6f\x75\x6e\x74\x2c\x20\x64\x65\x70\x65\x6e\x64\x65\x6e\x74\x49\x64\x2c\x20\x24\x62\x6c\x6f\x63\x6b\x49\x64\x2c\x20\x24\x72\x6f\x75\x6e\x64\x20\x66\x72\x6f\x6d\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x32\x64\x65\x6c\x65\x67\x61\x74\x65\x73\x20\x77\x68\x65\x72\x65\x20\x61\x63\x63\x6f\x75\x6e\x74\x49\x64\x20\x3d\x20\x24\x61\x64\x64\x72\x65\x73\x73",values:{address:a,amount:d,blockId:b.blockId,round:b.round}})):0>d&&(f.$dec=f.$dec||{},f.$dec[c]=Math.abs(d),"\x62\x61\x6c\x61\x6e\x63\x65"==c&&k.push({query:"\x69\x6e\x73\x65\x72\x74\x20\x69\x6e\x74\x6f\x20\x6d\x65\x6d\x5f\x72\x6f\x75\x6e\x64\x20\x28\x61\x64\x64\x72\x65\x73\x73\x2c\x20\x61\x6d\x6f\x75\x6e\x74\x2c\x20\x64\x65\x6c\x65\x67\x61\x74\x65\x2c\x20\x62\x6c\x6f\x63\x6b\x49\x64\x2c\x20\x72\x6f\x75\x6e\x64\x29\x20\x73\x65\x6c\x65\x63\x74\x20\x24\x61\x64\x64\x72\x65\x73\x73\x2c\x20\x24\x61\x6d\x6f\x75\x6e\x74\x2c\x20\x64\x65\x70\x65\x6e\x64\x65\x6e\x74\x49\x64\x2c\x20\x24\x62\x6c\x6f\x63\x6b\x49\x64\x2c\x20\x24\x72\x6f\x75\x6e\x64\x20\x66\x72\x6f\x6d\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x32\x64\x65\x6c\x65\x67\x61\x74\x65\x73\x20\x77\x68\x65\x72\x65\x20\x61\x63\x63\x6f\x75\x6e\x74\x49\x64\x20\x3d\x20\x24\x61\x64\x64\x72\x65\x73\x73",values:{address:a,amount:d,blockId:b.blockId,round:b.round}}));break;case Array:if("\x5b\x6f\x62\x6a\x65\x63\x74\x20\x4f\x62\x6a\x65\x63\x74\x5d"==Object.prototype.toString.call(d[0]))for(e=0;e<d.length;e++)m=d[e],"\x2d"==m.action?(delete m.action,j[c]=j[c]||[],j[c].push(m)):"\x2b"==m.action?(delete m.action,i[c]=i[c]||[],i[c].push(m)):(delete m.action,i[c]=i[c]||[],i[c].push(m));else for(e=0;e<d.length;e++)n=d[e][0],m=null,"\x2d"==n?(m=d[e].slice(1),g[c]=g[c]||[],g[c].push(m),"\x64\x65\x6c\x65\x67\x61\x74\x65\x73"==c&&k.push({query:"\x69\x6e\x73\x65\x72\x74\x20\x69\x6e\x74\x6f\x20\x6d\x65\x6d\x5f\x72\x6f\x75\x6e\x64\x20\x28\x61\x64\x64\x72\x65\x73\x73\x2c\x20\x61\x6d\x6f\x75\x6e\x74\x2c\x20\x64\x65\x6c\x65\x67\x61\x74\x65\x2c\x20\x62\x6c\x6f\x63\x6b\x49\x64\x2c\x20\x72\x6f\x75\x6e\x64\x29\x20\x73\x65\x6c\x65\x63\x74\x20\x24\x61\x64\x64\x72\x65\x73\x73\x2c\x20\x2d\x62\x61\x6c\x61\x6e\x63\x65\x2c\x20\x24\x64\x65\x6c\x65\x67\x61\x74\x65\x2c\x20\x24\x62\x6c\x6f\x63\x6b\x49\x64\x2c\x20\x24\x72\x6f\x75\x6e\x64\x20\x66\x72\x6f\x6d\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x20\x77\x68\x65\x72\x65\x20\x61\x64\x64\x72\x65\x73\x73\x20\x3d\x20\x24\x61\x64\x64\x72\x65\x73\x73",values:{address:a,delegate:m,blockId:b.blockId,round:b.round}})):"\x2b"==n?(m=d[e].slice(1),h[c]=h[c]||[],h[c].push(m),"\x64\x65\x6c\x65\x67\x61\x74\x65\x73"==c&&k.push({query:"\x69\x6e\x73\x65\x72\x74\x20\x69\x6e\x74\x6f\x20\x6d\x65\x6d\x5f\x72\x6f\x75\x6e\x64\x20\x28\x61\x64\x64\x72\x65\x73\x73\x2c\x20\x61\x6d\x6f\x75\x6e\x74\x2c\x20\x64\x65\x6c\x65\x67\x61\x74\x65\x2c\x20\x62\x6c\x6f\x63\x6b\x49\x64\x2c\x20\x72\x6f\x75\x6e\x64\x29\x20\x73\x65\x6c\x65\x63\x74\x20\x24\x61\x64\x64\x72\x65\x73\x73\x2c\x20\x62\x61\x6c\x61\x6e\x63\x65\x2c\x20\x24\x64\x65\x6c\x65\x67\x61\x74\x65\x2c\x20\x24\x62\x6c\x6f\x63\x6b\x49\x64\x2c\x20\x24\x72\x6f\x75\x6e\x64\x20\x66\x72\x6f\x6d\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x20\x77\x68\x65\x72\x65\x20\x61\x64\x64\x72\x65\x73\x73\x20\x3d\x20\x24\x61\x64\x64\x72\x65\x73\x73",values:{address:a,delegate:m,blockId:b.blockId,round:b.round}})):(m=d[e],h[c]=h[c]||[],h[c].push(m),"\x64\x65\x6c\x65\x67\x61\x74\x65\x73"==c&&k.push({query:"\x69\x6e\x73\x65\x72\x74\x20\x69\x6e\x74\x6f\x20\x6d\x65\x6d\x5f\x72\x6f\x75\x6e\x64\x20\x28\x61\x64\x64\x72\x65\x73\x73\x2c\x20\x61\x6d\x6f\x75\x6e\x74\x2c\x20\x64\x65\x6c\x65\x67\x61\x74\x65\x2c\x20\x62\x6c\x6f\x63\x6b\x49\x64\x2c\x20\x72\x6f\x75\x6e\x64\x29\x20\x73\x65\x6c\x65\x63\x74\x20\x24\x61\x64\x64\x72\x65\x73\x73\x2c\x20\x62\x61\x6c\x61\x6e\x63\x65\x2c\x20\x24\x64\x65\x6c\x65\x67\x61\x74\x65\x2c\x20\x24\x62\x6c\x6f\x63\x6b\x49\x64\x2c\x20\x24\x72\x6f\x75\x6e\x64\x20\x66\x72\x6f\x6d\x20\x6d\x65\x6d\x5f\x61\x63\x63\x6f\x75\x6e\x74\x73\x20\x77\x68\x65\x72\x65\x20\x61\x64\x64\x72\x65\x73\x73\x20\x3d\x20\x24\x61\x64\x64\x72\x65\x73\x73",values:{address:a,delegate:m,blockId:b.blockId,round:b.round}}))}}),m=[],Object.keys(g).length&&Object.keys(g).forEach(function(b){var c=e.build({type:"\x72\x65\x6d\x6f\x76\x65",table:l.table+"\x32"+b,condition:{dependentId:{$in:g[b]},accountId:a}});m.push(c)}),Object.keys(h).length&&Object.keys(h).forEach(function(b){var c,d;for(c=0;c<h[b].length;c++)d=e.build({type:"\x69\x6e\x73\x65\x72\x74",table:l.table+"\x32"+b,values:{accountId:a,dependentId:h[b][c]}}),m.push(d)}),Object.keys(j).length&&Object.keys(j).forEach(function(b){j[b].accountId=a;var c=e.build({type:"\x72\x65\x6d\x6f\x76\x65",table:l.table+"\x32"+b,condition:j[b]});m.push(c)}),Object.keys(i).length&&Object.keys(i).forEach(function(b){var c,d;for(i[b].accountId=a,c=0;c<i[b].length;c++)d=e.build({type:"\x69\x6e\x73\x65\x72\x74",table:l.table+"\x32"+b,values:i[b]}),m.push(d)}),Object.keys(f).length&&(n=e.build({type:"\x75\x70\x64\x61\x74\x65",table:this.table,modifier:f,condition:{address:a}}),m.push(n)),d.series([function(a){m.length>1&&l.scope.dbLite.query("\x42\x45\x47\x49\x4e\x20\x54\x52\x41\x4e\x53\x41\x43\x54\x49\x4f\x4e\x3b"),d.eachSeries(m,function(a,b){l.scope.dbLite.query(a.query,a.values,function(a,c){b(a,c)})},function(b){return b?void(m.length>1?l.scope.dbLite.query("\x52\x4f\x4c\x4c\x42\x41\x43\x4b\x3b",function(c){a(c||b)}):a(b)):void(m.length>1?l.scope.dbLite.query("\x43\x4f\x4d\x4d\x49\x54\x3b",a):a())})},function(a){k.length>1&&l.scope.dbLite.query("\x42\x45\x47\x49\x4e\x20\x54\x52\x41\x4e\x53\x41\x43\x54\x49\x4f\x4e\x3b"),d.eachSeries(k,function(a,b){l.scope.dbLite.query(a.query,a.values,function(a,c){b(a,c)})},function(b){return b?void(k.length>1?l.scope.dbLite.query("\x52\x4f\x4c\x4c\x42\x41\x43\x4b\x3b",function(c){a(c||b)}):a(b)):void(k.length>1?l.scope.dbLite.query("\x43\x4f\x4d\x4d\x49\x54\x3b",a):a())})}],o)},j.prototype.remove=function(a,b){var c=e.build({type:"\x72\x65\x6d\x6f\x76\x65",table:this.table,condition:{address:a}});this.scope.dbLite.query(c.query,c.values,function(c){b(c,a)})},a.exports=j}),c.register("\x2e\x2f\x6c\x6f\x67\x69\x63\x2f\x62\x6c\x6f\x63\x6b\x2e\x6a\x73",function(a,b,c){function l(a,b){this.scope=a,g=this.scope.genesisblock,b&&setImmediate(b,null,this)}var e=(c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x6c\x6f\x74\x73\x2e\x6a\x73"),c("\x65\x64\x32\x35\x35\x31\x39")),f=c("\x63\x72\x79\x70\x74\x6f"),g=null,h=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x62\x69\x67\x6e\x75\x6d\x2e\x6a\x73"),i=c("\x62\x79\x74\x65\x62\x75\x66\x66\x65\x72"),j=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x62\x6c\x6f\x63\x6b\x53\x74\x61\x74\x75\x73\x2e\x6a\x73"),k=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x63\x6f\x6e\x73\x74\x61\x6e\x74\x73\x2e\x6a\x73"),m={};m.blockStatus=new j,m.getAddressByPublicKey=function(a){var d,e,b=f.createHash("\x73\x68\x61\x32\x35\x36").update(a,"\x68\x65\x78").digest(),c=new Buffer(8);for(d=0;8>d;d++)c[d]=b[7-d];return e=""+h.fromBuffer(c)+"\x43"},l.prototype.create=function(a){var l,n,o,p,b=a.transactions.sort(function(a,b){return a.type<b.type?-1:a.type>b.type?1:a.amount<b.amount?-1:a.amount>b.amount?1:0}),c=a.previousBlock?a.previousBlock.height+1:1,d=m.blockStatus.calcReward(c),e=0,g=0,h=0,i=[],j=f.createHash("\x73\x68\x61\x32\x35\x36");for(l=0;l<b.length&&(n=b[l],o=this.scope.transaction.getBytes(n),!(h+o.length>k.maxPayloadLength));l++)h+=o.length,e+=n.fee,g+=n.amount,i.push(n),j.update(o);p={version:0,totalAmount:g,totalFee:e,reward:d,payloadHash:j.digest().toString("\x68\x65\x78"),timestamp:a.timestamp,numberOfTransactions:i.length,payloadLength:h,previousBlock:a.previousBlock.id,generatorPublicKey:a.keypair.publicKey.toString("\x68\x65\x78"),transactions:i};try{p.blockSignature=this.sign(p,a.keypair),p=this.objectNormalize(p)}catch(q){throw Error(""+q)}return p},l.prototype.sign=function(a,b){var c=this.getHash(a);return e.Sign(c,b).toString("\x68\x65\x78")},l.prototype.getBytes=function(a){var c,d,e,f,g,j,k,b=180;try{if(c=new i(b,!0),c.writeInt(a.version),c.writeInt(a.timestamp),a.previousBlock)for(d=h(a.previousBlock).toBuffer({size:"\x38"}),e=0;8>e;e++)c.writeByte(d[e]);else for(e=0;8>e;e++)c.writeByte(0);for(c.writeInt(a.numberOfTransactions),c.writeLong(a.totalAmount),c.writeLong(a.totalFee),c.writeLong(a.reward),c.writeInt(a.payloadLength),f=new Buffer(a.payloadHash,"\x68\x65\x78"),e=0;e<f.length;e++)c.writeByte(f[e]);for(g=new Buffer(a.generatorPublicKey,"\x68\x65\x78"),e=0;e<g.length;e++)c.writeByte(g[e]);if(a.blockSignature)for(j=new Buffer(a.blockSignature,"\x68\x65\x78"),e=0;e<j.length;e++)c.writeByte(j[e]);c.flip(),k=c.toBuffer()}catch(l){throw Error(""+l)}return k},l.prototype.verifySignature=function(a){var c,d,g,h,i,j,k,b=64;try{for(c=this.getBytes(a),d=new Buffer(c.length-b),g=0;g<d.length;g++)d[g]=c[g];h=f.createHash("\x73\x68\x61\x32\x35\x36").update(d).digest(),i=new Buffer(a.blockSignature,"\x68\x65\x78"),j=new Buffer(a.generatorPublicKey,"\x68\x65\x78"),k=e.Verify(h,i||"\x20",j||"\x20")}catch(l){throw Error(""+l)}return k},l.prototype.dbSave=function(a,b){var c,d,e;try{c=new Buffer(a.payloadHash,"\x68\x65\x78"),d=new Buffer(a.generatorPublicKey,"\x68\x65\x78"),e=new Buffer(a.blockSignature,"\x68\x65\x78")}catch(f){return b(""+f)}this.scope.dbLite.query("\x49\x4e\x53\x45\x52\x54\x20\x49\x4e\x54\x4f\x20\x62\x6c\x6f\x63\x6b\x73\x28\x69\x64\x2c\x20\x76\x65\x72\x73\x69\x6f\x6e\x2c\x20\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x2c\x20\x68\x65\x69\x67\x68\x74\x2c\x20\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b\x2c\x20\x20\x6e\x75\x6d\x62\x65\x72\x4f\x66\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73\x2c\x20\x74\x6f\x74\x61\x6c\x41\x6d\x6f\x75\x6e\x74\x2c\x20\x74\x6f\x74\x61\x6c\x46\x65\x65\x2c\x20\x72\x65\x77\x61\x72\x64\x2c\x20\x70\x61\x79\x6c\x6f\x61\x64\x4c\x65\x6e\x67\x74\x68\x2c\x20\x70\x61\x79\x6c\x6f\x61\x64\x48\x61\x73\x68\x2c\x20\x67\x65\x6e\x65\x72\x61\x74\x6f\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x2c\x20\x62\x6c\x6f\x63\x6b\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x29\x20\x56\x41\x4c\x55\x45\x53\x28\x24\x69\x64\x2c\x20\x24\x76\x65\x72\x73\x69\x6f\x6e\x2c\x20\x24\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x2c\x20\x24\x68\x65\x69\x67\x68\x74\x2c\x20\x24\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b\x2c\x20\x24\x6e\x75\x6d\x62\x65\x72\x4f\x66\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73\x2c\x20\x24\x74\x6f\x74\x61\x6c\x41\x6d\x6f\x75\x6e\x74\x2c\x20\x24\x74\x6f\x74\x61\x6c\x46\x65\x65\x2c\x20\x24\x72\x65\x77\x61\x72\x64\x2c\x20\x24\x70\x61\x79\x6c\x6f\x61\x64\x4c\x65\x6e\x67\x74\x68\x2c\x20\x20\x24\x70\x61\x79\x6c\x6f\x61\x64\x48\x61\x73\x68\x2c\x20\x24\x67\x65\x6e\x65\x72\x61\x74\x6f\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x2c\x20\x24\x62\x6c\x6f\x63\x6b\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x29",{id:a.id,version:a.version,timestamp:a.timestamp,height:a.height,previousBlock:a.previousBlock||null,numberOfTransactions:a.numberOfTransactions,totalAmount:a.totalAmount,totalFee:a.totalFee,reward:a.reward||0,payloadLength:a.payloadLength,payloadHash:c,generatorPublicKey:d,blockSignature:e},b)},l.prototype.objectNormalize=function(a){var b,c;for(b in a)(null==a[b]||void 0===a[b])&&delete a[b];if(c=this.scope.scheme.validate(a,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{id:{type:"\x73\x74\x72\x69\x6e\x67"},height:{type:"\x69\x6e\x74\x65\x67\x65\x72"},blockSignature:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x73\x69\x67\x6e\x61\x74\x75\x72\x65"},generatorPublicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"},numberOfTransactions:{type:"\x69\x6e\x74\x65\x67\x65\x72"},payloadHash:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x68\x65\x78"},payloadLength:{type:"\x69\x6e\x74\x65\x67\x65\x72"},previousBlock:{type:"\x73\x74\x72\x69\x6e\x67"},timestamp:{type:"\x69\x6e\x74\x65\x67\x65\x72"},totalAmount:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0},totalFee:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0},reward:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0},transactions:{type:"\x61\x72\x72\x61\x79",uniqueItems:!0},version:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0}},required:["\x62\x6c\x6f\x63\x6b\x53\x69\x67\x6e\x61\x74\x75\x72\x65","\x67\x65\x6e\x65\x72\x61\x74\x6f\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79","\x6e\x75\x6d\x62\x65\x72\x4f\x66\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73","\x70\x61\x79\x6c\x6f\x61\x64\x48\x61\x73\x68","\x70\x61\x79\x6c\x6f\x61\x64\x4c\x65\x6e\x67\x74\x68","\x74\x69\x6d\x65\x73\x74\x61\x6d\x70","\x74\x6f\x74\x61\x6c\x41\x6d\x6f\x75\x6e\x74","\x74\x6f\x74\x61\x6c\x46\x65\x65","\x72\x65\x77\x61\x72\x64","\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73","\x76\x65\x72\x73\x69\x6f\x6e"]}),!c)throw Error(this.scope.scheme.getLastError());try{for(b=0;b<a.transactions.length;b++)a.transactions[b]=this.scope.transaction.objectNormalize(a.transactions[b])}catch(d){throw Error(""+d)}return a},l.prototype.getId=function(a){var d,e,b=f.createHash("\x73\x68\x61\x32\x35\x36").update(this.getBytes(a)).digest(),c=new Buffer(8);for(d=0;8>d;d++)c[d]=b[7-d];return e=""+h.fromBuffer(c)},l.prototype.getHash=function(a){return f.createHash("\x73\x68\x61\x32\x35\x36").update(this.getBytes(a)).digest()},l.prototype.calculateFee=function(){return 1e7},l.prototype.dbRead=function(a){if(a.b_id){var b={id:a.b_id,version:parseInt(a.b_version),timestamp:parseInt(a.b_timestamp),height:parseInt(a.b_height),previousBlock:a.b_previousBlock,numberOfTransactions:parseInt(a.b_numberOfTransactions),totalAmount:parseInt(a.b_totalAmount),totalFee:parseInt(a.b_totalFee),reward:parseInt(a.b_reward),payloadLength:parseInt(a.b_payloadLength),payloadHash:a.b_payloadHash,generatorPublicKey:a.b_generatorPublicKey,generatorId:m.getAddressByPublicKey(a.b_generatorPublicKey),blockSignature:a.b_blockSignature,confirmations:a.b_confirmations};return b.totalForged=b.totalFee+b.reward,b}return null},a.exports=l}),c.register("\x2e\x2f\x6c\x6f\x67\x69\x63\x2f\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x2e\x6a\x73",function(a,b,c){function l(a,b){this.scope=a,g=this.scope.genesisblock,b&&setImmediate(b,null,this)}function n(a){return Math.floor(a/d.delegates)+(a%d.delegates>0?1:0)}var d=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x6c\x6f\x74\x73\x2e\x6a\x73"),e=c("\x65\x64\x32\x35\x35\x31\x39"),f=c("\x63\x72\x79\x70\x74\x6f"),g=null,h=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x63\x6f\x6e\x73\x74\x61\x6e\x74\x73\x2e\x6a\x73"),i=c("\x62\x79\x74\x65\x62\x75\x66\x66\x65\x72"),j=c("\x2e\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x62\x69\x67\x6e\x75\x6d\x2e\x6a\x73"),k=c("\x75\x74\x69\x6c\x2d\x65\x78\x74\x65\x6e\x64"),m={};m.types={},l.prototype.create=function(a){if(!m.types[a.type])throw Error("\x55\x6e\x6b\x6e\x6f\x77\x6e\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x74\x79\x70\x65\x20"+a.type);if(!a.sender)throw Error("\x43\x61\x6e\x27\x74\x20\x66\x69\x6e\x64\x20\x73\x65\x6e\x64\x65\x72");if(!a.keypair)throw Error("\x43\x61\x6e\x27\x74\x20\x66\x69\x6e\x64\x20\x6b\x65\x79\x70\x61\x69\x72");var b={type:a.type,amount:0,senderPublicKey:a.sender.publicKey,requesterPublicKey:a.requester?a.requester.publicKey.toString("\x68\x65\x78"):null,timestamp:d.getTime(),asset:{}};return b=m.types[b.type].create.call(this,a,b),b.signature=this.sign(a.keypair,b),a.sender.secondSignature&&a.secondKeypair&&(b.signSignature=this.sign(a.secondKeypair,b)),b.id=this.getId(b),b.fee=m.types[b.type].calculateFee.call(this,b,a.sender)||!1,b},l.prototype.attachAssetType=function(a,b){if(!b||"\x66\x75\x6e\x63\x74\x69\x6f\x6e"!=typeof b.create||"\x66\x75\x6e\x63\x74\x69\x6f\x6e"!=typeof b.getBytes||"\x66\x75\x6e\x63\x74\x69\x6f\x6e"!=typeof b.calculateFee||"\x66\x75\x6e\x63\x74\x69\x6f\x6e"!=typeof b.verify||"\x66\x75\x6e\x63\x74\x69\x6f\x6e"!=typeof b.objectNormalize||"\x66\x75\x6e\x63\x74\x69\x6f\x6e"!=typeof b.dbRead||"\x66\x75\x6e\x63\x74\x69\x6f\x6e"!=typeof b.apply||"\x66\x75\x6e\x63\x74\x69\x6f\x6e"!=typeof b.undo||"\x66\x75\x6e\x63\x74\x69\x6f\x6e"!=typeof b.applyUnconfirmed||"\x66\x75\x6e\x63\x74\x69\x6f\x6e"!=typeof b.undoUnconfirmed||"\x66\x75\x6e\x63\x74\x69\x6f\x6e"!=typeof b.ready||"\x66\x75\x6e\x63\x74\x69\x6f\x6e"!=typeof b.process)throw Error("\x49\x6e\x76\x61\x6c\x69\x64\x20\x69\x6e\x73\x74\x61\x6e\x63\x65\x20\x69\x6e\x74\x65\x72\x66\x61\x63\x65");m.types[a]=b},l.prototype.sign=function(a,b){var c=this.getHash(b);return e.Sign(c,a).toString("\x68\x65\x78")},l.prototype.multisign=function(a,b){var c=this.getBytes(b,!0,!0),d=f.createHash("\x73\x68\x61\x32\x35\x36").update(c).digest();return e.Sign(d,a).toString("\x68\x65\x78")},l.prototype.getId=function(a){var d,e,b=this.getHash(a),c=new Buffer(8);for(d=0;8>d;d++)c[d]=b[7-d];return e=""+j.fromBuffer(c)},l.prototype.getHash=function(a){return f.createHash("\x73\x68\x61\x32\x35\x36").update(this.getBytes(a)).digest()},l.prototype.getBytes=function(a,b,c){var d,e,f,g,h,k,l,n,o;if(!m.types[a.type])throw Error("\x55\x6e\x6b\x6e\x6f\x77\x6e\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x74\x79\x70\x65\x20"+a.type);try{for(d=m.types[a.type].getBytes.call(this,a,b,c),e=d?d.length:0,f=new i(213+e,!0),f.writeByte(a.type),f.writeInt(a.timestamp),g=new Buffer(a.senderPublicKey,"\x68\x65\x78"),h=0;h<g.length;h++)f.writeByte(g[h]);if(a.requesterPublicKey)for(k=new Buffer(a.requesterPublicKey,"\x68\x65\x78"),h=0;h<k.length;h++)f.writeByte(k[h]);if(a.recipientId)for(l=a.recipientId.slice(0,-1),l=j(l).toBuffer({size:8}),h=0;8>h;h++)f.writeByte(l[h]||0);else for(h=0;8>h;h++)f.writeByte(0);if(f.writeLong(a.amount),e>0)for(h=0;e>h;h++)f.writeByte(d[h]);if(!b&&a.signature)for(n=new Buffer(a.signature,"\x68\x65\x78"),h=0;h<n.length;h++)f.writeByte(n[h]);if(!c&&a.signSignature)for(o=new Buffer(a.signSignature,"\x68\x65\x78"),h=0;h<o.length;h++)f.writeByte(o[h]);f.flip()}catch(p){throw Error(""+p)}return f.toBuffer()},l.prototype.ready=function(a,b){if(!m.types[a.type])throw Error("\x55\x6e\x6b\x6e\x6f\x77\x6e\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x74\x79\x70\x65\x20"+a.type);return b?m.types[a.type].ready.call(this,a,b):!1},l.prototype.process=function(a,b,c,d){if("\x66\x75\x6e\x63\x74\x69\x6f\x6e"==typeof c&&(d=c),!m.types[a.type])return setImmediate(d,"\x55\x6e\x6b\x6e\x6f\x77\x6e\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x74\x79\x70\x65\x20"+a.type);try{var e=this.getId(a)}catch(f){return setImmediate(d,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x69\x64")}if(a.id&&a.id!=e)return setImmediate(d,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x69\x64");if(a.id=e,!b)return setImmediate(d,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x6e\x64\x65\x72");if(a.senderId=b.address,a.requesterPublicKey&&b.multisignatures.indexOf(a.requesterPublicKey)<0)return setImmediate(d,"\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x76\x65\x72\x69\x66\x79\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65");if(a.requesterPublicKey){if(!this.verifySignature(a,a.requesterPublicKey,a.signature))return setImmediate(d,"\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x76\x65\x72\x69\x66\x79\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65")}else if(!this.verifySignature(a,a.senderPublicKey,a.signature))return setImmediate(d,"\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x76\x65\x72\x69\x66\x79\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65");m.types[a.type].process.call(this,a,b,function(a,b){return a?setImmediate(d,a):void this.scope.dbLite.query("\x53\x45\x4c\x45\x43\x54\x20\x63\x6f\x75\x6e\x74\x28\x69\x64\x29\x20\x46\x52\x4f\x4d\x20\x74\x72\x73\x20\x57\x48\x45\x52\x45\x20\x69\x64\x3d\x24\x69\x64",{id:b.id},{count:Number},function(a,c){if(a)return d("\x44\x61\x74\x61\x62\x61\x73\x65\x20\x65\x72\x72\x6f\x72");var e=c.length&&c[0];return e.count?d("\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x70\x72\x6f\x63\x65\x73\x73\x20\x61\x6c\x72\x65\x61\x64\x79\x20\x63\x6f\x6e\x66\x69\x72\x6d\x65\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e"):void d(null,b)})}.bind(this))},l.prototype.verify=function(a,b,c,e){var f,i,j,k,l,n;if("\x66\x75\x6e\x63\x74\x69\x6f\x6e"==typeof c&&(e=c),!m.types[a.type])return setImmediate(e,"\x55\x6e\x6b\x6e\x6f\x77\x6e\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x74\x79\x70\x65\x20"+a.type);if(!b)return setImmediate(e,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x6e\x64\x65\x72");if(a.requesterPublicKey){if(b.multisignatures.indexOf(a.requesterPublicKey)<0)return setImmediate(e,"\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x76\x65\x72\x69\x66\x79\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65");if(b.publicKey!=a.senderPublicKey)return setImmediate(e,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x70\x75\x62\x6c\x69\x63\x20\x6b\x65\x79")}try{f=!1,f=a.requesterPublicKey?this.verifySignature(a,a.requesterPublicKey,a.signature):this.verifySignature(a,a.senderPublicKey,a.signature)}catch(g){return setImmediate(e,""+g)}if(!f)return setImmediate(e,"\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x76\x65\x72\x69\x66\x79\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65");if(!a.requesterPublicKey&&b.secondSignature){try{f=this.verifySecondSignature(a,b.secondPublicKey,a.signSignature)}catch(g){return setImmediate(e,""+g)}if(!f)return setImmediate(e,"\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x76\x65\x72\x69\x66\x79\x20\x73\x65\x63\x6f\x6e\x64\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x3a\x20"+a.id)}else if(a.requesterPublicKey&&c.secondSignature){try{f=this.verifySecondSignature(a,c.secondPublicKey,a.signSignature)}catch(g){return setImmediate(e,""+g)}if(!f)return setImmediate(e,"\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x76\x65\x72\x69\x66\x79\x20\x73\x65\x63\x6f\x6e\x64\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x3a\x20"+a.id)}if(a.signatures&&a.signatures.length&&(i=a.signatures.reduce(function(a,b){return a.indexOf(b)<0&&a.push(b),a},[]),i.length!=a.signatures.length))return setImmediate(e,"\x45\x6e\x63\x6f\x75\x6e\x74\x65\x72\x65\x64\x20\x64\x75\x70\x6c\x69\x63\x61\x74\x65\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73");if(j=b.multisignatures||b.u_multisignatures,0==j.length&&a.asset&&a.asset.multisignature&&a.asset.multisignature.keysgroup&&(j=a.asset.multisignature.keysgroup.map(function(a){return a.slice(1)})),a.requesterPublicKey&&j.push(a.senderPublicKey),a.signatures)for(k=0;k<a.signatures.length;k++){for(verify=!1,l=0;l<j.length;l++)a.requesterPublicKey&&j[l]==a.requesterPublicKey||this.verifySignature(a,j[l],a.signatures[k])&&(verify=!0);if(!verify)return setImmediate(e,"\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x76\x65\x72\x69\x66\x79\x20\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x3a\x20"+a.id);
}return a.senderId!=b.address?setImmediate(e,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x73\x65\x6e\x64\x65\x72\x20\x69\x64\x3a\x20"+a.id):(n=m.types[a.type].calculateFee.call(this,a,b)||!1,n&&a.fee==n?a.amount<0||a.amount>1e8*h.fixedPoint||(a.amount+"").indexOf("\x2e")>=0||(""+a.amount).indexOf("\x65")>=0?setImmediate(e,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x61\x6d\x6f\x75\x6e\x74\x3a\x20"+a.id):d.getSlotNumber(a.timestamp)>d.getSlotNumber()?setImmediate(e,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x74\x69\x6d\x65\x73\x74\x61\x6d\x70"):void m.types[a.type].verify.call(this,a,b,function(a){e(a)}):setImmediate(e,"\x49\x6e\x76\x61\x6c\x69\x64\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x74\x79\x70\x65\x2f\x66\x65\x65\x3a\x20"+a.id))},l.prototype.verifySignature=function(a,b,c){var d,e;if(!m.types[a.type])throw Error("\x55\x6e\x6b\x6e\x6f\x77\x6e\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x74\x79\x70\x65\x20"+a.type);if(!c)return!1;try{d=this.getBytes(a,!0,!0),e=this.verifyBytes(d,b,c)}catch(f){throw Error(""+f)}return e},l.prototype.verifySecondSignature=function(a,b,c){var d,e;if(!m.types[a.type])throw Error("\x55\x6e\x6b\x6e\x6f\x77\x6e\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x74\x79\x70\x65\x20"+a.type);if(!c)return!1;try{d=this.getBytes(a,!1,!0),e=this.verifyBytes(d,b,c)}catch(f){throw Error(""+f)}return e},l.prototype.verifyBytes=function(a,b,c){var d,g,h,i,j,k;try{for(d=new Buffer(a.length),g=0;g<d.length;g++)d[g]=a[g];h=f.createHash("\x73\x68\x61\x32\x35\x36").update(d).digest(),i=new Buffer(c,"\x68\x65\x78"),j=new Buffer(b,"\x68\x65\x78"),k=e.Verify(h,i||"\x20",j||"\x20")}catch(l){throw Error(""+l)}return k},l.prototype.apply=function(a,b,c,d){if(!m.types[a.type])return setImmediate(d,"\x55\x6e\x6b\x6e\x6f\x77\x6e\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x74\x79\x70\x65\x20"+a.type);if(!this.ready(a,c))return setImmediate(d,"\x54\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x69\x73\x20\x6e\x6f\x74\x20\x72\x65\x61\x64\x79\x3a\x20"+a.id);var e=a.amount+a.fee;return a.blockId!=g.block.id&&c.balance<e?setImmediate(d,"\x41\x63\x63\x6f\x75\x6e\x74\x20\x68\x61\x73\x20\x6e\x6f\x20\x4c\x49\x53\x4b\x3a\x20"+a.id):void this.scope.account.merge(c.address,{balance:-e,blockId:b.id,round:n(b.height)},function(c,f){return c?d(c):void m.types[a.type].apply.call(this,a,b,f,function(a){a?this.scope.account.merge(f.address,{balance:e,blockId:b.id,round:n(b.height)},function(a){d(a)}):setImmediate(d)}.bind(this))}.bind(this))},l.prototype.undo=function(a,b,c,d){if(!m.types[a.type])return setImmediate(d,"\x55\x6e\x6b\x6e\x6f\x77\x6e\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x74\x79\x70\x65\x20"+a.type);var e=a.amount+a.fee;this.scope.account.merge(c.address,{balance:e,blockId:b.id,round:n(b.height)},function(c,f){return c?d(c):void m.types[a.type].undo.call(this,a,b,f,function(a){a?this.scope.account.merge(f.address,{balance:e,blockId:b.id,round:n(b.height)},function(a){d(a)}):setImmediate(d)}.bind(this))}.bind(this))},l.prototype.applyUnconfirmed=function(a,b,c,d){if("\x66\x75\x6e\x63\x74\x69\x6f\x6e"==typeof c&&(d=c),!m.types[a.type])return setImmediate(d,"\x55\x6e\x6b\x6e\x6f\x77\x6e\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x74\x79\x70\x65\x20"+a.type);if(!a.requesterPublicKey&&b.secondSignature&&!a.signSignature&&a.blockId!=g.block.id)return setImmediate(d,"\x46\x61\x69\x6c\x65\x64\x20\x73\x65\x63\x6f\x6e\x64\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x3a\x20"+a.id);if(!a.requesterPublicKey&&!b.secondSignature&&a.signSignature&&a.signSignature.length>0)return setImmediate(d,"\x41\x63\x63\x6f\x75\x6e\x74\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x68\x61\x76\x65\x20\x61\x20\x73\x65\x63\x6f\x6e\x64\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65");if(a.requesterPublicKey&&c.secondSignature&&!a.signSignature)return setImmediate(d,"\x46\x61\x69\x6c\x65\x64\x20\x73\x65\x63\x6f\x6e\x64\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x3a\x20"+a.id);if(a.requesterPublicKey&&!c.secondSignature&&a.signSignature&&a.signSignature.length>0)return setImmediate(d,"\x41\x63\x63\x6f\x75\x6e\x74\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x68\x61\x76\x65\x20\x61\x20\x73\x65\x63\x6f\x6e\x64\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65");var e=a.amount+a.fee;return b.u_balance<e&&a.blockId!=g.block.id?setImmediate(d,"\x41\x63\x63\x6f\x75\x6e\x74\x20\x68\x61\x73\x20\x6e\x6f\x20\x4c\x49\x53\x4b\x3a\x20"+a.id):void this.scope.account.merge(b.address,{u_balance:-e},function(b,c){return b?d(b):void m.types[a.type].applyUnconfirmed.call(this,a,c,function(a){a?this.scope.account.merge(c.address,{u_balance:e},function(){d(a)}):setImmediate(d,a)}.bind(this))}.bind(this))},l.prototype.undoUnconfirmed=function(a,b,c){if(!m.types[a.type])return setImmediate(c,"\x55\x6e\x6b\x6e\x6f\x77\x6e\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x74\x79\x70\x65\x20"+a.type);var d=a.amount+a.fee;this.scope.account.merge(b.address,{u_balance:d},function(b,e){return b?c(b):void m.types[a.type].undoUnconfirmed.call(this,a,e,function(a){a?this.scope.account.merge(e.address,{u_balance:-d},function(a){c(a)}):setImmediate(c,a)}.bind(this))}.bind(this))},l.prototype.dbSave=function(a,b){var c,d,e,f;if(!m.types[a.type])return b("\x55\x6e\x6b\x6e\x6f\x77\x6e\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x74\x79\x70\x65\x3a\x20"+a.type);try{c=new Buffer(a.senderPublicKey,"\x68\x65\x78"),d=new Buffer(a.signature,"\x68\x65\x78"),e=a.signSignature?new Buffer(a.signSignature,"\x68\x65\x78"):null,f=a.requesterPublicKey?new Buffer(a.requesterPublicKey,"\x68\x65\x78"):null}catch(g){return b(""+g)}this.scope.dbLite.query("\x49\x4e\x53\x45\x52\x54\x20\x49\x4e\x54\x4f\x20\x74\x72\x73\x28\x69\x64\x2c\x20\x62\x6c\x6f\x63\x6b\x49\x64\x2c\x20\x74\x79\x70\x65\x2c\x20\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x2c\x20\x73\x65\x6e\x64\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x2c\x20\x72\x65\x71\x75\x65\x73\x74\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x2c\x20\x73\x65\x6e\x64\x65\x72\x49\x64\x2c\x20\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x49\x64\x2c\x20\x73\x65\x6e\x64\x65\x72\x55\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x55\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x61\x6d\x6f\x75\x6e\x74\x2c\x20\x66\x65\x65\x2c\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x2c\x20\x73\x69\x67\x6e\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x2c\x20\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x29\x20\x56\x41\x4c\x55\x45\x53\x28\x24\x69\x64\x2c\x20\x24\x62\x6c\x6f\x63\x6b\x49\x64\x2c\x20\x24\x74\x79\x70\x65\x2c\x20\x24\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x2c\x20\x24\x73\x65\x6e\x64\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x2c\x20\x24\x72\x65\x71\x75\x65\x73\x74\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79\x2c\x20\x24\x73\x65\x6e\x64\x65\x72\x49\x64\x2c\x20\x24\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x49\x64\x2c\x20\x24\x73\x65\x6e\x64\x65\x72\x55\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x24\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x55\x73\x65\x72\x6e\x61\x6d\x65\x2c\x20\x24\x61\x6d\x6f\x75\x6e\x74\x2c\x20\x24\x66\x65\x65\x2c\x20\x24\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x2c\x20\x24\x73\x69\x67\x6e\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x2c\x20\x24\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x29",{id:a.id,blockId:a.blockId,type:a.type,timestamp:a.timestamp,senderPublicKey:c,requesterPublicKey:f,senderId:a.senderId,recipientId:a.recipientId||null,senderUsername:a.senderUsername||null,recipientUsername:a.recipientUsername||null,amount:a.amount,fee:a.fee,signature:d,signSignature:e,signatures:a.signatures?a.signatures.join("\x2c"):null},function(c){return c?b(c):void m.types[a.type].dbSave.call(this,a,b)}.bind(this))},l.prototype.objectNormalize=function(a){var b,c;if(!m.types[a.type])throw Error("\x55\x6e\x6b\x6e\x6f\x77\x6e\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x74\x79\x70\x65\x20"+a.type);for(b in a)(null===a[b]||void 0===a[b])&&delete a[b];if(c=this.scope.scheme.validate(a,{type:"\x6f\x62\x6a\x65\x63\x74",properties:{id:{type:"\x73\x74\x72\x69\x6e\x67"},height:{type:"\x69\x6e\x74\x65\x67\x65\x72"},blockId:{type:"\x73\x74\x72\x69\x6e\x67"},type:{type:"\x69\x6e\x74\x65\x67\x65\x72"},timestamp:{type:"\x69\x6e\x74\x65\x67\x65\x72"},senderPublicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"},requesterPublicKey:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x70\x75\x62\x6c\x69\x63\x4b\x65\x79"},senderId:{type:"\x73\x74\x72\x69\x6e\x67"},recipientId:{type:"\x73\x74\x72\x69\x6e\x67"},senderUsername:{type:"\x73\x74\x72\x69\x6e\x67"},recipientUsername:{type:"\x73\x74\x72\x69\x6e\x67"},amount:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:h.totalAmount},fee:{type:"\x69\x6e\x74\x65\x67\x65\x72",minimum:0,maximum:h.totalAmount},signature:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x73\x69\x67\x6e\x61\x74\x75\x72\x65"},signSignature:{type:"\x73\x74\x72\x69\x6e\x67",format:"\x73\x69\x67\x6e\x61\x74\x75\x72\x65"},asset:{type:"\x6f\x62\x6a\x65\x63\x74"}},required:["\x74\x79\x70\x65","\x74\x69\x6d\x65\x73\x74\x61\x6d\x70","\x73\x65\x6e\x64\x65\x72\x50\x75\x62\x6c\x69\x63\x4b\x65\x79","\x73\x69\x67\x6e\x61\x74\x75\x72\x65"]}),!c)throw Error(this.scope.scheme.getLastError());try{a=m.types[a.type].objectNormalize.call(this,a)}catch(d){throw Error(""+d)}return a},l.prototype.dbRead=function(a){var b,c;if(a.t_id){if(b={id:a.t_id,height:a.b_height,blockId:a.b_id||a.t_blockId,type:parseInt(a.t_type),timestamp:parseInt(a.t_timestamp),senderPublicKey:a.t_senderPublicKey,requesterPublicKey:a.t_requesterPublicKey,senderId:a.t_senderId,recipientId:a.t_recipientId,senderUsername:a.t_senderUsername,recipientUsername:a.t_recipientUsername,amount:parseInt(a.t_amount),fee:parseInt(a.t_fee),signature:a.t_signature,signSignature:a.t_signSignature,signatures:a.t_signatures?a.t_signatures.split("\x2c"):null,confirmations:a.confirmations,asset:{}},!m.types[b.type])throw Error("\x55\x6e\x6b\x6e\x6f\x77\x6e\x20\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x20\x74\x79\x70\x65\x20"+b.type);return c=m.types[b.type].dbRead.call(this,a),c&&(b.asset=k(b.asset,c)),b}return null},a.exports=l}),c.register("\x2e\x2f\x61\x70\x70\x2e\x6a\x73",function(a,b,c){var q,r,s,t,d=c("\x63\x6f\x6d\x6d\x61\x6e\x64\x65\x72"),e=c("\x2e\x2f\x70\x61\x63\x6b\x61\x67\x65\x2e\x6a\x73\x6f\x6e"),f=c("\x2e\x2f\x6c\x6f\x67\x67\x65\x72\x2e\x6a\x73"),g=c("\x2e\x2f\x63\x6f\x6e\x66\x69\x67\x2e\x6a\x73\x6f\x6e"),h=c("\x2e\x2f\x67\x65\x6e\x65\x73\x69\x73\x42\x6c\x6f\x63\x6b\x2e\x6a\x73\x6f\x6e"),i=c("\x61\x73\x79\x6e\x63"),k=(c("\x65\x78\x74\x65\x6e\x64"),c("\x70\x61\x74\x68")),m=(c("\x68\x74\x74\x70\x73"),c("\x66\x73")),n=c("\x7a\x2d\x73\x63\x68\x65\x6d\x61"),p=(c("\x75\x74\x69\x6c"),c("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x73\x65\x71\x75\x65\x6e\x63\x65\x2e\x6a\x73"));process.stdin.resume(),q=m.readFileSync(k.join(__dirname,"\x62\x75\x69\x6c\x64"),"\x75\x74\x66\x38"),d.version(e.version).option("\x2d\x63\x2c\x20\x2d\x2d\x63\x6f\x6e\x66\x69\x67\x20\x3c\x70\x61\x74\x68\x3e","\x43\x6f\x6e\x66\x69\x67\x20\x66\x69\x6c\x65\x20\x70\x61\x74\x68").option("\x2d\x70\x2c\x20\x2d\x2d\x70\x6f\x72\x74\x20\x3c\x70\x6f\x72\x74\x3e","\x4c\x69\x73\x74\x65\x6e\x69\x6e\x67\x20\x70\x6f\x72\x74\x20\x6e\x75\x6d\x62\x65\x72").option("\x2d\x61\x2c\x20\x2d\x2d\x61\x64\x64\x72\x65\x73\x73\x20\x3c\x69\x70\x3e","\x4c\x69\x73\x74\x65\x6e\x69\x6e\x67\x20\x68\x6f\x73\x74\x20\x6e\x61\x6d\x65\x20\x6f\x72\x20\x69\x70").option("\x2d\x62\x2c\x20\x2d\x2d\x62\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x3c\x70\x61\x74\x68\x3e","\x42\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x20\x64\x62\x20\x70\x61\x74\x68").option("\x2d\x78\x2c\x20\x2d\x2d\x70\x65\x65\x72\x73\x20\x5b\x70\x65\x65\x72\x73\x2e\x2e\x2e\x5d","\x50\x65\x65\x72\x73\x20\x6c\x69\x73\x74").option("\x2d\x6c\x2c\x20\x2d\x2d\x6c\x6f\x67\x20\x3c\x6c\x65\x76\x65\x6c\x3e","\x4c\x6f\x67\x20\x6c\x65\x76\x65\x6c").parse(process.argv),"\x75\x6e\x64\x65\x66\x69\x6e\x65\x64"!=typeof gc&&setInterval(function(){gc()},6e4),d.config&&(g=c(k.resolve(process.cwd(),d.config))),d.port&&(g.port=d.port),d.address&&(g.address=d.address),d.peers&&("\x73\x74\x72\x69\x6e\x67"==typeof d.peers?g.peers.list=d.peers.split("\x2c").map(function(a){return a=a.split("\x3a"),{ip:a.shift(),port:a.shift()||g.port}}):g.peers.list=[]),d.log&&(g.consoleLogLevel=d.log),process.on("\x75\x6e\x63\x61\x75\x67\x68\x74\x45\x78\x63\x65\x70\x74\x69\x6f\x6e",function(a){s.fatal("\x53\x79\x73\x74\x65\x6d\x20\x65\x72\x72\x6f\x72",{message:a.message,stack:a.stack}),process.emit("\x63\x6c\x65\x61\x6e\x75\x70")}),r={db:d.blockchain||"\x2e\x2f\x62\x6c\x6f\x63\x6b\x63\x68\x61\x69\x6e\x2e\x64\x62",modules:{server:"\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x73\x65\x72\x76\x65\x72\x2e\x6a\x73",accounts:"\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x61\x63\x63\x6f\x75\x6e\x74\x73\x2e\x6a\x73",transactions:"\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x73\x2e\x6a\x73",blocks:"\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x62\x6c\x6f\x63\x6b\x73\x2e\x6a\x73",signatures:"\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x2e\x6a\x73",transport:"\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x74\x72\x61\x6e\x73\x70\x6f\x72\x74\x2e\x6a\x73",loader:"\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x6c\x6f\x61\x64\x65\x72\x2e\x6a\x73",system:"\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x73\x79\x73\x74\x65\x6d\x2e\x6a\x73",peer:"\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x70\x65\x65\x72\x2e\x6a\x73",delegates:"\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x64\x65\x6c\x65\x67\x61\x74\x65\x73\x2e\x6a\x73",round:"\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x72\x6f\x75\x6e\x64\x2e\x6a\x73",contacts:"\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x63\x6f\x6e\x74\x61\x63\x74\x73\x2e\x6a\x73",multisignatures:"\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x6d\x75\x6c\x74\x69\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x73\x2e\x6a\x73",dapps:"\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x64\x61\x70\x70\x73\x2e\x6a\x73",sia:"\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x73\x69\x61\x2e\x6a\x73",crypto:"\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x63\x72\x79\x70\x74\x6f\x2e\x6a\x73",sql:"\x2e\x2f\x6d\x6f\x64\x75\x6c\x65\x73\x2f\x73\x71\x6c\x2e\x6a\x73"}},s=new f({echo:g.consoleLogLevel,errorLevel:g.fileLogLevel}),t=c("\x64\x6f\x6d\x61\x69\x6e").create(),t.on("\x65\x72\x72\x6f\x72",function(a){s.fatal("\x44\x6f\x6d\x61\x69\x6e\x20\x6d\x61\x73\x74\x65\x72",{message:a.message,stack:a.stack}),process.exit(0)}),t.run(function(){var a=[];i.auto({config:function(a){if(g.dapp.masterrequired&&!g.dapp.masterpassword){var b=c("\x72\x61\x6e\x64\x6f\x6d\x73\x74\x72\x69\x6e\x67");g.dapp.masterpassword=b.generate({length:12,readable:!0,charset:"\x61\x6c\x70\x68\x61\x6e\x75\x6d\x65\x72\x69\x63"}),m.writeFile("\x2e\x2f\x63\x6f\x6e\x66\x69\x67\x2e\x6a\x73\x6f\x6e",JSON.stringify(g,null,4),"\x75\x74\x66\x38",function(b){a(b,g)})}else a(null,g)},logger:function(a){a(null,s)},build:function(a){a(null,q)},genesisblock:function(a){a(null,{block:h})},"public":function(a){a(null,k.join(__dirname,"\x70\x75\x62\x6c\x69\x63"))},scheme:function(a){n.registerFormat("\x68\x65\x78",function(a){try{new Buffer(a,"\x68\x65\x78")}catch(b){return!1}return!0}),n.registerFormat("\x70\x75\x62\x6c\x69\x63\x4b\x65\x79",function(a){if(0==a.length)return!0;try{var b=new Buffer(a,"\x68\x65\x78");return 32==b.length}catch(c){return!1}}),n.registerFormat("\x73\x70\x6c\x69\x74\x61\x72\x72\x61\x79",function(a){try{var b=a.split("\x2c");return b.length>0&&b.length<=1e3?!0:!1}catch(c){return!1}}),n.registerFormat("\x73\x69\x67\x6e\x61\x74\x75\x72\x65",function(a){if(0==a.length)return!0;try{var b=new Buffer(a,"\x68\x65\x78");return 64==b.length}catch(c){return!1}}),n.registerFormat("\x6c\x69\x73\x74\x51\x75\x65\x72\x79",function(a){return a.limit=100,!0}),n.registerFormat("\x6c\x69\x73\x74\x44\x65\x6c\x65\x67\x61\x74\x65\x73",function(a){return a.limit=101,!0}),n.registerFormat("\x63\x68\x65\x63\x6b\x49\x6e\x74",function(a){return isNaN(a)||parseInt(a)!=a||isNaN(parseInt(a,10))?!1:(a=parseInt(a),!0)}),n.registerFormat("\x69\x70",function(){}),a(null,new n)},network:["\x63\x6f\x6e\x66\x69\x67",function(a,b){var h,i,j,k,d=c("\x65\x78\x70\x72\x65\x73\x73"),e=d(),f=c("\x68\x74\x74\x70").createServer(e),g=c("\x73\x6f\x63\x6b\x65\x74\x2e\x69\x6f")(f);b.config.ssl.enabled&&(h=m.readFileSync(b.config.ssl.options.key),i=m.readFileSync(b.config.ssl.options.cert),j=c("\x68\x74\x74\x70\x73").createServer({key:h,cert:i},e),k=c("\x73\x6f\x63\x6b\x65\x74\x2e\x69\x6f")(j)),a(null,{express:d,app:e,server:f,io:g,https:j,https_io:k})}],dbSequence:["\x6c\x6f\x67\x67\x65\x72",function(a,b){var c=new p({onWarning:function(a){b.logger.warn("\x44\x42\x20\x71\x75\x65\x75\x65",a)}});a(null,c)}],sequence:["\x6c\x6f\x67\x67\x65\x72",function(a,b){var c=new p({onWarning:function(a){b.logger.warn("\x4d\x61\x69\x6e\x20\x71\x75\x65\x75\x65",a)}});a(null,c)}],balancesSequence:["\x6c\x6f\x67\x67\x65\x72",function(a,b){var c=new p({onWarning:function(a){b.logger.warn("\x42\x61\x6c\x61\x6e\x63\x65\x20\x71\x75\x65\x75\x65",a)}});a(null,c)}],connect:["\x63\x6f\x6e\x66\x69\x67","\x70\x75\x62\x6c\x69\x63","\x67\x65\x6e\x65\x73\x69\x73\x62\x6c\x6f\x63\x6b","\x6c\x6f\x67\x67\x65\x72","\x62\x75\x69\x6c\x64","\x6e\x65\x74\x77\x6f\x72\x6b",function(a,b){var i,d=c("\x70\x61\x74\x68"),e=c("\x62\x6f\x64\x79\x2d\x70\x61\x72\x73\x65\x72"),f=c("\x6d\x65\x74\x68\x6f\x64\x2d\x6f\x76\x65\x72\x72\x69\x64\x65"),h=(c("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x72\x65\x71\x75\x65\x73\x74\x2d\x73\x61\x6e\x69\x74\x69\x7a\x65\x72"),c("\x65\x78\x70\x72\x65\x73\x73\x2d\x71\x75\x65\x72\x79\x2d\x69\x6e\x74"));b.network.app.engine("\x68\x74\x6d\x6c",c("\x65\x6a\x73").renderFile),b.network.app.use(c("\x65\x78\x70\x72\x65\x73\x73\x2d\x64\x6f\x6d\x61\x69\x6e\x2d\x6d\x69\x64\x64\x6c\x65\x77\x61\x72\x65")),b.network.app.set("\x76\x69\x65\x77\x20\x65\x6e\x67\x69\x6e\x65","\x65\x6a\x73"),b.network.app.set("\x76\x69\x65\x77\x73",d.join(__dirname,"\x70\x75\x62\x6c\x69\x63")),b.network.app.use(b.network.express["\x73\x74\x61\x74\x69\x63"](d.join(__dirname,"\x70\x75\x62\x6c\x69\x63"))),b.network.app.use(e.urlencoded({extended:!0,parameterLimit:5e3})),b.network.app.use(e.json()),b.network.app.use(f()),i=["\x69\x64","\x6e\x61\x6d\x65","\x6c\x61\x73\x74\x42\x6c\x6f\x63\x6b\x49\x64","\x62\x6c\x6f\x63\x6b\x49\x64","\x75\x73\x65\x72\x6e\x61\x6d\x65","\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x49\x64","\x61\x64\x64\x72\x65\x73\x73","\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x49\x64","\x73\x65\x6e\x64\x65\x72\x49\x64","\x73\x65\x6e\x64\x65\x72\x55\x73\x65\x72\x6e\x61\x6d\x65","\x72\x65\x63\x69\x70\x69\x65\x6e\x74\x55\x73\x65\x72\x6e\x61\x6d\x65","\x70\x72\x65\x76\x69\x6f\x75\x73\x42\x6c\x6f\x63\x6b"],b.network.app.use(h({parser:function(a,b,c){return i.indexOf(c)>=0?a:isNaN(a)||parseInt(a)!=a||isNaN(parseInt(a,b))?a:parseInt(a)}})),b.network.app.use(c("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x7a\x73\x63\x68\x65\x6d\x65\x2d\x65\x78\x70\x72\x65\x73\x73\x2e\x6a\x73")(b.scheme)),b.network.app.use(function(a,c,d){var e=a.url.split("\x2f"),f=a.headers["\x78\x2d\x66\x6f\x72\x77\x61\x72\x64\x65\x64\x2d\x66\x6f\x72"]||a.connection.remoteAddress;e.length>1?"\x61\x70\x69"==e[1]?b.config.api.access.whiteList.length>0&&b.config.api.access.whiteList.indexOf(f)<0?c.sendStatus(403):d():"\x70\x65\x65\x72"==e[1]&&b.config.peers.blackList.length>0&&b.config.peers.blackList.indexOf(f)>=0?c.sendStatus(403):d():d()}),b.network.server.listen(b.config.port,b.config.address,function(c){b.logger.log("\x4c\x69\x73\x6b\x20\x73\x74\x61\x72\x74\x65\x64\x3a\x20"+b.config.address+"\x3a"+b.config.port),c?a(c,b.network):b.config.ssl.enabled?b.network.https.listen(b.config.ssl.options.port,b.config.ssl.options.address,function(c){b.logger.log("\x4c\x69\x73\x6b\x20\x68\x74\x74\x70\x73\x20\x73\x74\x61\x72\x74\x65\x64\x3a\x20"+b.config.ssl.options.address+"\x3a"+b.config.ssl.options.port),a(c,b.network)}):a(null,b.network)})}],bus:function(b){var d=c("\x63\x68\x61\x6e\x67\x65\x2d\x63\x61\x73\x65"),e=function(){this.message=function(){var c,b=[];Array.prototype.push.apply(b,arguments),c=b.shift(),a.forEach(function(a){var e="\x6f\x6e"+d.pascalCase(c);"\x66\x75\x6e\x63\x74\x69\x6f\x6e"==typeof a[e]&&a[e].apply(a[e],b)})}};b(null,new e)},dbLite:function(a){var b=c("\x2e\x2f\x68\x65\x6c\x70\x65\x72\x73\x2f\x64\x62\x4c\x69\x74\x65\x2e\x6a\x73");b.connect(r.db,a)},logic:["\x64\x62\x4c\x69\x74\x65","\x62\x75\x73","\x73\x63\x68\x65\x6d\x65","\x67\x65\x6e\x65\x73\x69\x73\x62\x6c\x6f\x63\x6b",function(a,b){var d=c("\x2e\x2f\x6c\x6f\x67\x69\x63\x2f\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e\x2e\x6a\x73"),e=c("\x2e\x2f\x6c\x6f\x67\x69\x63\x2f\x62\x6c\x6f\x63\x6b\x2e\x6a\x73"),f=c("\x2e\x2f\x6c\x6f\x67\x69\x63\x2f\x61\x63\x63\x6f\x75\x6e\x74\x2e\x6a\x73");i.auto({bus:function(a){a(null,b.bus)},dbLite:function(a){a(null,b.dbLite)},scheme:function(a){a(null,b.scheme)},genesisblock:function(a){a(null,{block:h})},account:["\x64\x62\x4c\x69\x74\x65","\x62\x75\x73","\x73\x63\x68\x65\x6d\x65","\x67\x65\x6e\x65\x73\x69\x73\x62\x6c\x6f\x63\x6b",function(a,b){new f(b,a)}],transaction:["\x64\x62\x4c\x69\x74\x65","\x62\x75\x73","\x73\x63\x68\x65\x6d\x65","\x67\x65\x6e\x65\x73\x69\x73\x62\x6c\x6f\x63\x6b","\x61\x63\x63\x6f\x75\x6e\x74",function(a,b){new d(b,a)}],block:["\x64\x62\x4c\x69\x74\x65","\x62\x75\x73","\x73\x63\x68\x65\x6d\x65","\x67\x65\x6e\x65\x73\x69\x73\x62\x6c\x6f\x63\x6b","\x61\x63\x63\x6f\x75\x6e\x74","\x74\x72\x61\x6e\x73\x61\x63\x74\x69\x6f\x6e",function(a,b){new e(b,a)}]},a)}],modules:["\x6e\x65\x74\x77\x6f\x72\x6b","\x63\x6f\x6e\x6e\x65\x63\x74","\x63\x6f\x6e\x66\x69\x67","\x6c\x6f\x67\x67\x65\x72","\x62\x75\x73","\x73\x65\x71\x75\x65\x6e\x63\x65","\x64\x62\x53\x65\x71\x75\x65\x6e\x63\x65","\x62\x61\x6c\x61\x6e\x63\x65\x73\x53\x65\x71\x75\x65\x6e\x63\x65","\x64\x62\x4c\x69\x74\x65","\x6c\x6f\x67\x69\x63",function(b,d){var e={};Object.keys(r.modules).forEach(function(b){e[b]=function(e){var f=c("\x64\x6f\x6d\x61\x69\x6e").create();f.on("\x65\x72\x72\x6f\x72",function(a){d.logger.fatal("\x44\x6f\x6d\x61\x69\x6e\x20"+b,{message:a.message,stack:a.stack})}),f.run(function(){var f,g;s.debug("\x4c\x6f\x61\x64\x69\x6e\x67\x20\x6d\x6f\x64\x75\x6c\x65",b),f=c(r.modules[b]),g=new f(e,d),a.push(g)})}}),i.parallel(e,function(a,c){b(a,c)})}],ready:["\x6d\x6f\x64\x75\x6c\x65\x73","\x62\x75\x73",function(a,b){b.bus.message("\x62\x69\x6e\x64",b.modules),a()}]},function(b,c){b?s.fatal(b):(c.logger.info("\x4d\x6f\x64\x75\x6c\x65\x73\x20\x72\x65\x61\x64\x79\x20\x61\x6e\x64\x20\x6c\x61\x75\x6e\x63\x68\x65\x64"),process.once("\x63\x6c\x65\x61\x6e\x75\x70",function(){c.logger.info("\x43\x6c\x65\x61\x6e\x69\x6e\x67\x20\x75\x70\x2e\x2e\x2e"),i.eachSeries(a,function(a,b){"\x66\x75\x6e\x63\x74\x69\x6f\x6e"==typeof a.cleanup?a.cleanup(b):setImmediate(b)},function(a){a?c.logger.error(a):c.logger.info("\x43\x6c\x65\x61\x6e\x65\x64\x20\x75\x70\x20\x73\x75\x63\x63\x65\x73\x73\x66\x75\x6c\x6c\x79"),process.exit(1)})}),process.once("\x53\x49\x47\x54\x45\x52\x4d",function(){process.emit("\x63\x6c\x65\x61\x6e\x75\x70")}),process.once("\x65\x78\x69\x74",function(){process.emit("\x63\x6c\x65\x61\x6e\x75\x70")}),process.once("\x53\x49\x47\x49\x4e\x54",function(){process.emit("\x63\x6c\x65\x61\x6e\x75\x70")}))})})}),b.exports=c("\x2e\x2f\x61\x70\x70\x2e\x6a\x73")}(require,module);